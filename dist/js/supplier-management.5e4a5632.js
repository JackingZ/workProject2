(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["supplier-management"],{"1a7b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{staticClass:"app-container"},[a("head-info-with-back",{attrs:{info:"",title:"供应商管理","show-back":e.isMoreInfoShow},on:{goback:e.goBack}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isMoreInfoShow,expression:"!isMoreInfoShow"}],staticClass:"app-panel"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["suppersAdd"],expression:"['suppersAdd']"}],staticStyle:{"margin-left":"10px"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addAgent}},[e._v("\n              新增供应商\n            ")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"服务大类",clearable:"",filterable:"",size:"small"},model:{value:e.searchForm.types,callback:function(t){e.$set(e.searchForm,"types",t)},expression:"searchForm.types"}},e._l(e.typeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"业务类型",clearable:"",filterable:"",size:"small"},model:{value:e.searchForm.subTypes,callback:function(t){e.$set(e.searchForm,"subTypes",t)},expression:"searchForm.subTypes"}},e._l(e.subtypeList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"所在国家",clearable:"",filterable:"",size:"small"},on:{focus:e.getCountryList,change:function(t){return e.onCountryChange(1)}},model:{value:e.searchForm.countryId,callback:function(t){e.$set(e.searchForm,"countryId",t)},expression:"searchForm.countryId"}},e._l(e.countryList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,disabled:!e.searchForm.countryId,placeholder:"州/省",clearable:"",filterable:"",size:"small"},on:{focus:function(t){return e.getStateList(1)},change:function(t){return e.onStateChange(1)}},model:{value:e.searchForm.stateId,callback:function(t){e.$set(e.searchForm,"stateId",t)},expression:"searchForm.stateId"}},e._l(e.stateList1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,disabled:!e.searchForm.stateId,placeholder:"城市",clearable:"",size:"small",filterable:""},on:{focus:function(t){return e.getCityList(1)},change:function(t){return e.onCityChange(1)}},model:{value:e.searchForm.cityId,callback:function(t){e.$set(e.searchForm,"cityId",t)},expression:"searchForm.cityId"}},e._l(e.cityList1,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"启用状态",clearable:"",size:"small"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),a("el-input",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{size:"small",clearable:"",placeholder:"请输入企业名称"},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}}),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["querySupplyOrder"],expression:"['querySupplyOrder']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.queryAll(1)}}},[e._v("\n              查询\n            ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.list,height:"calc(100vh - 313px)",border:""}},[a("el-table-column",{attrs:{label:"公司名称",prop:"name","min-width":"200"}}),a("el-table-column",{attrs:{label:"国家/地区",width:"180",prop:"countryName","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"州省市区",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{directives:[{name:"show",rawName:"v-show",value:!!t.row.stateName,expression:"!!scope.row.stateName"}]},[e._v("\n                "+e._s(t.row.stateName)+"\n              ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!!t.row.cityName,expression:"!!scope.row.cityName"}]},[e._v("\n                > "+e._s(t.row.cityName)+"\n              ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:!!t.row.countyName,expression:"!!scope.row.countyName"}]},[e._v("\n                > "+e._s(t.row.countyName)+"\n              ")])]}}])}),a("el-table-column",{attrs:{label:"所属上级",prop:"parentName",width:"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"添加时间",width:"180",prop:"createTime"}}),a("el-table-column",{attrs:{label:"关联人员",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",disabled:!e.$checkPermission(["associatedPersonSupply"]),size:"medium"},on:{click:function(a){return e.AssociatedPeson(t.row)}}},[e._v("\n                关联人员\n              ")])]}}])}),"0"===e.custId||0===e.custId?a("el-table-column",{attrs:{label:"开通服务",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["subscribeSupplyService"]),type:"text",size:"medium"},on:{click:function(a){return e.handleServiceSet(t.row)}}},[e._v("\n                开通服务\n              ")])]}}],null,!1,2657464979)}):e._e(),a("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{staticClass:"switchStyle",attrs:{disabled:!e.$checkPermission(["supplyEnableDisable"]),value:t.row.status,"active-text":"启用","inactive-text":"禁用","active-value":"1","inactive-value":"0"},on:{input:function(a){return e.onStatus(t.row,a)}}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["updateSupply"],expression:"['updateSupply']"}],attrs:{type:"text",size:"medium"},on:{click:function(a){return e.edit(t.row)}}},[e._v("\n                编辑\n              ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["deleteSupply"],expression:"['deleteSupply']"}],attrs:{type:"text",size:"medium"},on:{click:function(a){return e.deleteSupplier(t.row.id)}}},[e._v("\n                删除\n              ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["moreSupplyPermissionst"],expression:"['moreSupplyPermissionst']"}],attrs:{type:"text",size:"medium"},on:{click:function(a){return e.handleMore(t.row)}}},[e._v("\n                更多\n              ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{layout:"total, prev, pager, next","current-page":e.page,"page-size":e.size,total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{staticClass:"editSupplier",attrs:{title:e.isEdit?"编辑供应商":"新增供应商",width:"1200px",visible:e.dialogShow,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogShow=t},close:e.closeAddForm}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-form",{ref:"theForm",attrs:{rules:e.formRules,model:e.form,"label-width":"110px","label-position":"center",size:"small"}},[a("el-form-item",{attrs:{prop:"abbr",label:"公司简称"}},[a("el-input",{ref:"abbrDom",staticStyle:{width:"100%"},attrs:{placeholder:"请输入",clearable:"",maxlength:10,"show-word-limit":"",size:"small"},model:{value:e.form.abbr,callback:function(t){e.$set(e.form,"abbr",t)},expression:"form.abbr"}})],1),a("el-form-item",{staticClass:"is-required",attrs:{label:"上级公司"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请输入",size:"small"},model:{value:e.inputName,callback:function(t){e.inputName=t},expression:"inputName"}})],1),a("el-form-item",{attrs:{prop:"alias",label:"英文名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",maxlength:50,clearable:"",size:"small"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),a("el-form-item",{attrs:{prop:"branch",label:"总分标识"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"总分标识",size:"small",filterable:"",clearable:""},model:{value:e.form.branch,callback:function(t){e.$set(e.form,"branch",t)},expression:"form.branch"}},e._l(e.branchTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{prop:"datarange",label:"合作期限"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"unlink-panels":"",type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.form.datarange,callback:function(t){e.$set(e.form,"datarange",t)},expression:"form.datarange"}})],1),"0"===e.custId?a("el-form-item",{attrs:{label:"是否请款",prop:"request"}},[a("el-radio-group",{model:{value:e.form.request,callback:function(t){e.$set(e.form,"request",t)},expression:"form.request"}},[a("el-radio",{attrs:{label:!1}},[e._v("\n                    否\n                  ")]),a("el-radio",{attrs:{label:!0}},[e._v("\n                    是\n                  ")])],1)],1):e._e(),a("div",{staticClass:"form-line"}),a("el-form-item",{attrs:{prop:"name",label:"公司名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",clearable:"",maxlength:50,size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{prop:"licenseCode",label:"营业执照"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",clearable:"",maxlength:20,size:"small"},model:{value:e.form.licenseCode,callback:function(t){e.$set(e.form,"licenseCode",t)},expression:"form.licenseCode"}})],1),a("el-form-item",{attrs:{prop:"setupDate",label:"成立日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"picker-options":e.pickerOptions,type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",size:"small"},model:{value:e.form.setupDate,callback:function(t){e.$set(e.form,"setupDate",t)},expression:"form.setupDate"}})],1),a("el-form-item",{attrs:{prop:"countryId",label:"国家/地区"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:"",size:"small"},on:{change:function(t){return e.onCountryChange(2)}},model:{value:e.form.countryId,callback:function(t){e.$set(e.form,"countryId",t)},expression:"form.countryId"}},e._l(e.countryList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"州/省",prop:"stateId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,placeholder:"请选择",clearable:"",disabled:!e.form.countryId,filterable:""},on:{focus:function(t){return e.getStateList(2)},change:function(t){return e.onStateChange(2)}},model:{value:e.form.stateId,callback:function(t){e.$set(e.form,"stateId",t)},expression:"form.stateId"}},e._l(e.stateList2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"城市",prop:"cityId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,placeholder:"请选择",clearable:"",disabled:!e.form.stateId,filterable:""},on:{focus:function(t){return e.getCityList(2)},change:function(t){return e.onCityChange(2)}},model:{value:e.form.cityId,callback:function(t){e.$set(e.form,"cityId",t)},expression:"form.cityId"}},e._l(e.cityList2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"区/县",prop:"countyId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,placeholder:"区/县",clearable:"",disabled:!e.form.cityId,filterable:""},on:{focus:function(t){return e.getCountyList(2)}},model:{value:e.form.countyId,callback:function(t){e.$set(e.form,"countyId",t)},expression:"form.countyId"}},e._l(e.countyList2,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1)],1),a("el-form-item",{attrs:{prop:"legal",label:"公司法人"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",maxlength:50,clearable:"",size:"small"},model:{value:e.form.legal,callback:function(t){e.$set(e.form,"legal",t)},expression:"form.legal"}})],1),a("el-form-item",{attrs:{prop:"certType",label:"证件类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:"",size:"small"},model:{value:e.form.certType,callback:function(t){e.$set(e.form,"certType",t)},expression:"form.certType"}},e._l(e.certTypeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{prop:"certNumber",label:"证件号码"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",maxlength:20,clearable:"",size:"small"},model:{value:e.form.certNumber,callback:function(t){e.$set(e.form,"certNumber",t)},expression:"form.certNumber"}})],1),a("el-form-item",{attrs:{prop:"licenseAddress",label:"证照地址"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",maxlength:100,clearable:"",size:"small"},model:{value:e.form.licenseAddress,callback:function(t){e.$set(e.form,"licenseAddress",t)},expression:"form.licenseAddress"}})],1),a("el-form-item",{attrs:{prop:"domain",label:"域名前缀"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",maxlength:8,"show-word-limit":""},model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}})],1),a("el-form-item",{attrs:{prop:"",label:"客户编码"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{disabled:e.isEdit&&e.ifCode,size:"small",clearable:"",maxlength:30},model:{value:e.form.custCode,callback:function(t){e.$set(e.form,"custCode",t)},expression:"form.custCode"}})],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("el-button",{on:{click:e.closeAddForm}},[e._v("\n                取 消\n              ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n                确 定\n              ")])],1)],1)]),a("el-dialog",{attrs:{title:"关联人员",visible:e.isRelatePersonShow,"close-on-click-modal":!1,width:"550px","before-close":e.close},on:{"update:visible":function(t){e.isRelatePersonShow=t}}},[a("div",{staticClass:"add-edit-truck",staticStyle:{height:"200px",overflow:"auto"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.isRelatePersonLoading,expression:"isRelatePersonLoading"}],ref:"relateForm",staticStyle:{width:"100%"},attrs:{model:e.relateForm,rules:e.formRules,"label-width":"100px","label-position":"right",size:"small"}},[a("el-form-item",{attrs:{prop:"containerIdArr",label:"关联财务人员"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"已选择("+e.relateForm.financialPerson.length+")",disabled:""},model:{value:e.s,callback:function(t){e.s=t},expression:"s"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleStates(1)}},slot:"append"})],1)],1),a("el-form-item",{attrs:{prop:"containerIdArr",label:"关联运营客服"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"已选择("+e.relateForm.customerPerson.length+")",disabled:""},model:{value:e.s,callback:function(t){e.s=t},expression:"s"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.handleStates(2)}},slot:"append"})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveRelateConfirm}},[e._v("\n              确 定\n            ")])],1)]),a("el-dialog",{attrs:{title:"关联财务人员",visible:e.isFinanceDialogShow,"close-on-click-modal":!1,width:"960px"},on:{"update:visible":function(t){e.isFinanceDialogShow=t},close:e.financeDialogClose}},[a("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.isFinanceLoading,expression:"isFinanceLoading"}],ref:"transferItem",staticStyle:{height:"500px"},attrs:{filterable:"","filter-method":e.filterMethod,titles:["人员列表","已选择"],props:{key:"id",label:"label"},"filter-placeholder":"输入搜索",data:e.userList},model:{value:e.relateForm.financialPerson,callback:function(t){e.$set(e.relateForm,"financialPerson",t)},expression:"relateForm.financialPerson"}}),a("div",{staticStyle:{"text-align":"right",margin:"0 40px 0"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.financeDialogClose}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.financeDialogClose}},[e._v("\n              确 定\n            ")])],1)],1),a("el-dialog",{attrs:{title:"关联运营客服",visible:e.isCustomerDialogShow,"close-on-click-modal":!1,width:"960px"},on:{"update:visible":function(t){e.isCustomerDialogShow=t},close:e.customerDialogClose}},[a("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.isCustomerLoading,expression:"isCustomerLoading"}],ref:"transferItem1",staticStyle:{height:"500px"},attrs:{filterable:"","filter-method":e.filterMethod,titles:["人员列表","已选择"],props:{key:"id",label:"label"},"filter-placeholder":"输入搜索",data:e.userList},model:{value:e.relateForm.customerPerson,callback:function(t){e.$set(e.relateForm,"customerPerson",t)},expression:"relateForm.customerPerson"}}),a("div",{staticStyle:{"text-align":"right",margin:"0 40px 0"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.customerDialogClose}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.customerDialogClose}},[e._v("\n              确 定\n            ")])],1)],1),a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.cancel}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.subLoading,expression:"subLoading"}]},[a("div",{staticStyle:{"text-align":"right"}},["0"===e.status?a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"公司类型"},on:{change:function(t){return e.getTypeTemplateList(e.cas)}},model:{value:e.cas,callback:function(t){e.cas=t},expression:"cas"}},e._l(e.csList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):e._e()],1),a("el-table",{ref:"serviceSelectTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.subTableData,height:"500px",border:""},on:{"selection-change":e.handleServiceSelection}},[a("el-table-column",{attrs:{prop:"typeName",label:"服务大类"}}),a("el-table-column",{attrs:{prop:"subtypeName",label:"服务类型"}}),a("el-table-column",{attrs:{label:"国家/地区"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"已选择("+(t.row.countries||[]).length+")",disabled:""},model:{value:e.cxr,callback:function(t){e.cxr=t},expression:"cxr"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(a){return e.handleCountry(t.row,t.$index)}},slot:"append"})],1)]}}])}),"0"!==e.status?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary",size:"small",loading:e.subLoading},on:{click:e.saveConfirm}},[e._v("\n              确 定\n            ")])],1)]),a("el-dialog",{attrs:{title:"国家/地区",visible:e.countryShow,"close-on-click-modal":!1,width:"960px","append-to-body":""},on:{"update:visible":function(t){e.countryShow=t},close:e.closeCountry}},[a("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.countryLoading,expression:"countryLoading"}],ref:"transferItem",staticStyle:{height:"500px"},attrs:{filterable:"","filter-method":e.filterMethod1,titles:["国家/地区","已选择"],props:{key:"id",label:"label"},"filter-placeholder":"输入搜索",data:e.countryList},model:{value:e.countryIds,callback:function(t){e.countryIds=t},expression:"countryIds"}}),a("div",{staticStyle:{"text-align":"right",margin:"0 40px 0"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.closeCountry}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.countryConfirm}},[e._v("\n              确 定\n            ")])],1)],1)],1),a("attach-info",{directives:[{name:"show",rawName:"v-show",value:e.isMoreInfoShow,expression:"isMoreInfoShow"}],ref:"attachInfo",attrs:{"current-cust-id":e.currentCustId,"current-cust-type":e.currentCustType}})],1)])])},i=[],n=(a("8e6e"),a("456d"),a("c5f6"),a("5df3"),a("75fc")),s=(a("28a5"),a("a8db")),o=a("768b"),l=(a("96cf"),a("3b8d")),c=(a("7f7f"),a("bd86")),u=(a("ac6a"),a("7514"),a("d225")),d=a("b0b4"),m=a("308d"),h=a("6bb5"),f=a("4e2b"),p=a("9ab4"),g=a("60a3"),y=a("9dba"),b=a("01d2"),v=a("f248"),w=a("254e"),k=a("7b1a");function x(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?x(a,!0).forEach(function(t){Object(c["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):x(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function S(){return{abbr:void 0,countryId:void 0,stateId:void 0,cityId:void 0,countyId:void 0,branch:void 0,alias:void 0,request:!1,datarange:[],name:void 0,licenseCode:void 0,licenseAddress:void 0,legal:void 0,domain:void 0,setupDate:void 0,certType:void 0,certNumber:void 0,id:void 0,custCode:void 0}}var I=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(m["a"])(this,Object(h["a"])(t).apply(this,arguments)),e.title="",e.cas="S",e.status="",e.cxr="",e.tableData=[],e.serviceData=[],e.csList=[],e.custData=[],e.subTableData=[],e.selectValue={cas:"S"},e.countryShow=!1,e.countryLoading=!1,e.countryIdx=0,e.countryIds=[],e.subLoading=!1,e.dialogVisible=!1,e.selectLoading=!1,e.loading=!1,e.dialogLoading=!1,e.isMoreInfoShow=!1,e.isAssociatedPersonsShow=!1,e.isRelatePersonLoading=!1,e.isCustomerLoading=!1,e.isFinanceLoading=!1,e.isRelatePersonShow=!1,e.isFinanceDialogShow=!1,e.isCustomerDialogShow=!1,e.currentRow={},e.relateTitle="",e.s="",e.isEdit=!1,e.ifCode=!1,e.list=[],e.userList=[],e.currentCustId="",e.currentCustType="supplier",e.parentId="",e.inputName=e.custName,e.relateForm={financialPerson:[],customerPerson:[]},e.searchForm={countryId:void 0,stateId:void 0,cityId:void 0,countyId:void 0,status:void 0,name:void 0,types:void 0,subTypes:void 0},e.form=S(),e.props={value:"id",label:"name"},e.companyType=[],e.statusList=[{label:"启用",value:"1"},{label:"禁用",value:"0"}],e.certTypeList=[{label:"身份证",value:"0"},{label:"其他",value:"1"}],e.branchTypeList=[{label:"总部",value:"0"},{label:"分公司",value:"1"}],e.formRules={abbr:[{required:!0,message:"公司简称不能为空",trigger:"blur"}],parentName:[{required:!0,message:"上级公司不能为空",trigger:"blur"}],alias:[{required:!0,message:"英文名称不能为空",trigger:"blur"},{validator:function(e,t,a){var r=/[\u4e00-\u9fa5]/;r.test(t)?a(new Error("英文名称不能有中文")):a()},trigger:"blur"}],branch:[{required:!0,message:"请选择总分标识",trigger:"change"}],datarange:[{required:!0,message:"请选择合作期限",trigger:"change"}],request:[{required:!0,message:"请选择是否请款",trigger:"change"}],name:[{required:!0,message:"公司名称不能为空",trigger:"blur"}],licenseCode:[{required:!0,message:"营业执照不能为空",trigger:"blur"}],setupDate:[{required:!0,message:"请选择成立日期",trigger:"change"}],countryId:[{required:!0,message:"请选择国家",trigger:"change"}],countyId:[{required:!1,message:"请选择区/县",trigger:"change"}],stateId:[{required:!0,message:"请选择州/省",trigger:"change"}],cityId:[{required:!0,message:"请选择城市",trigger:"change"}],licenseAddress:[{required:!0,message:"请输入证照地址",trigger:"blur"}],legal:[{required:!0,message:"公司法人不能为空",trigger:"blur"}],certType:[{required:!0,message:"请选择证件类型",trigger:"change"}],certNumber:[{required:!0,message:"请输入证件号码",trigger:"blur"},{validator:function(e,t,a){var r=/[\u4e00-\u9fa5]/;t&&r.test(t)?a(new Error("证件号码不能有中文")):a()},trigger:"blur"}],domain:[{required:!0,message:"请输入域名前缀",trigger:"blur"},{validator:function(e,t,a){var r=/^[a-z0-9]*$/;r.test(t)?t.length<2||t.length>8?a(new Error("域名前缀长度必须是大于2位小于8位")):a():a(new Error("域名前缀只能包含数字、小写字母"))},trigger:"blur"}]},e.countryList=[],e.stateList1=[],e.cityList1=[],e.countyList1=[],e.stateList2=[],e.cityList2=[],e.countyList2=[],e.typeList=[],e.dialogShow=!1,e.page=1,e.size=10,e.total=0,e}return Object(f["a"])(t,e),Object(d["a"])(t,[{key:"getTypeList",value:function(){var e=this;Object(v["c"])().then(function(t){var a=t.data||[];e.typeList=a.reduce(function(e,t){var a=e.find(function(e){return e.id===t.typeId});return a?a.subtypeList.push({id:t.subtypeId,name:t.subtypeName}):e.push({id:t.typeId,name:t.typeName,subtypeList:[{id:t.subtypeId,name:t.subtypeName}]}),e},[])}).catch(function(){e.typeList=[]})}},{key:"countryConfirm",value:function(){var e=this;this.closeCountry();var t=this.countryIds.map(function(t){return e.countryList.find(function(e){return t===e.id})});this.subTableData[this.countryIdx].countries=t}},{key:"closeCountry",value:function(){this.countryShow=!1;var e=this.$refs.transferItem;e.clearQuery("left"),e.clearQuery("right")}},{key:"getTypeTemplateList",value:function(e){var t=this;this.subLoading=!0;var a={cas:e};Object(v["c"])(a).then(function(e){t.subLoading=!1,t.subTableData=e.data||[]}).catch(function(e){return t.subLoading=!1,e})}},{key:"handleServiceSelection",value:function(e){this.serviceData=e}},{key:"handleCountry",value:function(e,t){var a=this;this.countryShow=!0,this.countryIdx=t;var r=e.countries||[];this.countryIds=[],r.forEach(function(e){a.countryIds.push(e.id)})}},{key:"getCustTypeList",value:function(e){var t=this;this.loading=!0,e&&(this.page=e);var a=L({},this.selectValue,{page:this.page,size:this.size});Object(v["b"])(a).then(function(e){t.loading=!1;var a=e.data||{};t.tableData=a.result||[],t.total=a.total}).catch(function(e){return t.loading=!1,e})}},{key:"saveConfirm",value:function(){var e=this;if("0"===this.status){this.subLoading=!0;var t={cas:this.cas,entities:this.subTableData};Object(v["e"])(t).then(function(t){e.$message({type:"success",message:"操作成功"}),e.dialogVisible=!1,e.subLoading=!1,e.getCustTypeList()}).catch(function(t){return e.subLoading=!1,t})}else if("1"===this.status||"2"===this.status){if(this.serviceData.length<=0)return void this.$message.error("请先勾选需要设置的服务");var a=this.serviceData.some(function(e){return e.countries.length<=0});if(a)return void this.$message.error("勾选的服务中必须选择国家/地区");"2"===this.status&&this.serviceData.map(function(e){Array.isArray(e.countries)&&e.countries.length>0&&(e.setted=!0)}),this.subLoading=!0;var r={custs:this.custData,entities:this.serviceData};Object(v["d"])(r).then(function(t){e.$message({type:"success",message:"操作成功"}),e.dialogVisible=!1,e.subLoading=!1,e.custData=[],e.serviceData=[],e.getCustTypeList()}).catch(function(t){return e.subLoading=!1,t})}}},{key:"cancel",value:function(){this.dialogVisible=!1,this.custData=[],this.serviceData=[]}},{key:"getCustTypeDtlList",value:function(e){var t=this;this.subLoading=!0;var a={custId:e,cas:this.selectValue.cas};Object(v["a"])(a).then(function(e){t.subLoading=!1,t.subTableData=e.data||[],"2"===t.status&&t.subTableData.map(function(e){e.setted&&t.$nextTick(function(){var a=t.$refs.serviceSelectTable;a.toggleRowSelection(e,!0)})})}).catch(function(e){return t.subLoading=!1,e})}},{key:"handleServiceSet",value:function(e){this.title="设置服务",this.status="2",this.custData=[{custId:e.id,custName:e.name,cas:this.selectValue.cas}],this.getCustTypeDtlList(e.id),this.dialogVisible=!0}},{key:"addAgent",value:function(){var e=this;this.isEdit=!1,this.dialogShow=!0,this.getCountryList().catch(function(e){return e}),this.$nextTick(function(){var t=e.$refs.abbrDom;t.focus()})}},{key:"close",value:function(){this.isRelatePersonShow=!1,this.resetRelatForm()}},{key:"resetRelatForm",value:function(){this.relateForm.financialPerson=[],this.relateForm.customerPerson=[],this.clearValidate()}},{key:"closeAddForm",value:function(){this.dialogShow=!1,this.isEdit=!1,this.ifCode=!1,this.stateList2=[],this.cityList2=[],this.countyList2=[],this.form=S(),this.clearAddValidate()}},{key:"clearAddValidate",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.theForm;t.clearValidate()})}},{key:"clearValidate",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.relateForm;t.clearValidate()})}},{key:"getServiceTypeList",value:function(){var e=this;Object(w["x"])().then(function(t){var a=t.data||[];e.companyType=a}).catch(function(e){return e})}},{key:"onStatus",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,a){var r,i,n,s,l=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.status&&t.status!==a&&"X"!==t.status){e.next=2;break}return e.abrupt("return");case 2:return r="0"===a?"禁用":"开启",e.next=5,this.$confirm("此操作将".concat(r,"供应商，是否继续？"),"提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 5:if(i=e.sent,n=Object(o["a"])(i,2),s=n[0],n[1],!s){e.next=11;break}return e.abrupt("return");case 11:Object(w["b"])({id:t.id,status:a}).then(function(e){l.$message.success("修改成功"),l.queryAll()}).catch(function(e){return e});case 12:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"edit",value:function(e){var t=this;this.isEdit=!0,this.dialogShow=!0,this.dialogLoading=!0,this.getCountryList().catch(function(e){return e}),Object(w["A"])(e.id).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(a){var r,i,n,o,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=a.data||{},i=r.result||{},t.ifCode=!!i.custCode,i.cooperate,n=Object(s["a"])(i,["cooperate"]),o=i.cooperate.split(","),l=L({},n,{datarange:o}),t.form=l,e.prev=7,!t.form.countryId){e.next=11;break}return e.next=11,t.getStateList(2);case 11:if(!t.form.stateId){e.next=14;break}return e.next=14,t.getCityList(2);case 14:if(!t.form.cityId){e.next=17;break}return e.next=17,t.getCountyList(2);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](7),t.dialogLoading=!1;case 22:t.dialogLoading=!1;case 23:case"end":return e.stop()}},e,null,[[7,19]])}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return t.dialogLoading=!1,e})}},{key:"saveRelateConfirm",value:function(){var e=this,t=this.relateForm.customerPerson.map(function(t){var a=e.userList.find(function(e){return e.id===t})||{};return{name:a.username,realName:a.realName,userId:t,type:"1"}}),a=this.relateForm.financialPerson.map(function(t){var a=e.userList.find(function(e){return e.id===t})||{};return{name:a.username,realName:a.realName,userId:t,type:"0"}}),r={custId:this.parentId,staffs:[].concat(Object(n["a"])(t),Object(n["a"])(a))};Object(w["a"])(r).then(function(t){e.$message.success("保存成功"),e.resetRelatForm(),e.isRelatePersonShow=!1}).catch(function(t){return e.isRelatePersonShow=!1,t})}},{key:"AssociatedPeson",value:function(e){var t=this;this.parentId=e.id,this.isRelatePersonShow=!0,this.isRelatePersonLoading=!0,Promise.all([this.getRelatedPersonList()]).then(function(e){t.isRelatePersonLoading=!1}).catch(function(e){return t.isRelatePersonLoading=!1,e})}},{key:"getCountryList",value:function(){var e=this;return Object(w["p"])().then(function(t){var a=t.data||{},r=a.result||[];e.countryList=r.map(function(e){return e.label=e.name+"-"+e.alias,e})}).catch(function(e){return e})}},{key:"getStateList",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=1===t?this.searchForm.countryId:this.form.countryId,this.selectLoading=!0,e.next=4,Object(w["z"])(a).then(function(e){r.selectLoading=!1;var a=e.data||{},i=a.result||[];1===t?r.stateList1=i:r.stateList2=i}).catch(function(){r.dialogLoading=!1,r.selectLoading=!1});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCityList",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=1===t?this.searchForm.stateId:this.form.stateId,this.selectLoading=!0,e.next=4,Object(w["m"])(a).then(function(e){r.selectLoading=!1;var a=e.data||{},i=a.result||[];1===t?r.cityList1=i:r.cityList2=i}).catch(function(){r.dialogLoading=!1,r.selectLoading=!1});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCountyList",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.selectLoading=!0,a=1===t?this.searchForm.cityId:this.form.cityId,e.next=4,Object(w["q"])(a).then(function(e){var a=e.data||{},i=a.result||[];1===t?r.countyList1=i:r.countyList2=i,r.selectLoading=!1}).catch(function(){r.dialogLoading=!1,r.selectLoading=!1});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"onCountryChange",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:1===t?(this.searchForm.stateId=void 0,this.searchForm.cityId=void 0,this.searchForm.countyId=void 0):2===t&&(this.form.stateId=void 0,this.form.cityId=void 0,this.form.countyId=void 0);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"onStateChange",value:function(e){1===e?(this.searchForm.cityId=void 0,this.searchForm.countyId=void 0):2===e&&(this.form.cityId=void 0,this.form.countyId=void 0)}},{key:"onCityChange",value:function(e){1===e?this.searchForm.countyId=void 0:2===e&&(this.form.countyId=void 0)}},{key:"customerDialogClose",value:function(){this.isCustomerDialogShow=!1;var e=this.$refs.transferItem1;e.clearQuery("left"),e.clearQuery("right")}},{key:"financeDialogClose",value:function(){this.isFinanceDialogShow=!1;var e=this.$refs.transferItem;e.clearQuery("left"),e.clearQuery("right")}},{key:"deleteSupplier",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,r,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将删除供应商，是否继续？","提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 2:if(a=e.sent,r=Object(o["a"])(a,2),i=r[0],r[1],!i){e.next=8;break}return e.abrupt("return");case 8:Object(w["i"])(t).then(function(e){n.$message.success("删除成功"),n.queryAll()}).catch(function(e){return e});case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"getUserData",value:function(e){var t=this,a={custId:this.custId,postType:e};return Object(w["C"])(a).then(function(e){var a=e.data,r=a||[];t.userList=r.map(function(e){return e.label=e.realName+" - "+e.deptName,e})}).catch(function(e){return e})}},{key:"handleSubmit",value:function(){var e=this,t=this.$refs.theForm;t.validate(function(t){if(t){var a=e.form,r=a.datarange,i=a.countryId,n=a.stateId,o=a.cityId,l=a.countyId,c=Object(s["a"])(a,["datarange","countryId","stateId","cityId","countyId"]);c.cooperate=r.join(",");var u=(e.countryList.find(function(e){return e.id===i})||{}).name,d=(e.stateList2.find(function(e){return e.id===n})||{}).name,m=(e.cityList2.find(function(e){return e.id===o})||{}).name,h=(e.countyList2.find(function(e){return e.id===l})||{}).name,f=L({},c,{countryId:i,countyId:l,stateId:n,cityId:o,countryName:u,stateName:d,cityName:m,countyName:h,type:3,parentId:e.custId,parentName:e.custName});e.dialogLoading=!0,Object(w["K"])(f).then(function(t){e.$message.success("保存成功"),e.dialogLoading=!1,e.closeAddForm(),e.queryAll()}).catch(function(t){return e.dialogLoading=!1,t})}})}},{key:"goBack",value:function(){var e=this;this.isMoreInfoShow=!1,this.$nextTick(function(){var t=e.$refs.attachInfo;t.resetInitData()})}},{key:"filterMethod",value:function(e,t){var a=t.username||"";return a.indexOf(e)>-1}},{key:"filterMethod1",value:function(e,t){var a=t.name||"";return a.indexOf(e)>-1}},{key:"handleStates",value:function(e){var t=this;this.isRelatePersonShow=!0,this.relateTitle=1===e?"关联财务人员":"关联运营客服",1===e?(this.isFinanceDialogShow=!0,this.isFinanceLoading=!0):2===e&&(this.isCustomerDialogShow=!0,this.isCustomerLoading=!0);var a=1===e?1:2;Promise.all([this.getUserData(a)]).then(function(e){t.isFinanceLoading=!1,t.isCustomerLoading=!1}).catch(function(e){return e})}},{key:"getRelatedPersonList",value:function(){var e=this,t={custId:this.parentId};return this.relateForm.financialPerson=[],this.relateForm.customerPerson=[],Object(w["w"])(t).then(function(t){var a=t.data||[],r=a.filter(function(e){return"0"===e.type});e.relateForm.financialPerson=r.map(function(e){return e.userId});var i=a.filter(function(e){return"1"===e.type});e.relateForm.customerPerson=i.map(function(e){return e.userId})}).catch(function(e){return e})}},{key:"handleMore",value:function(e){var t=this;this.isMoreInfoShow=!0,this.currentCustId=e.id,this.$nextTick(function(){var e=t.$refs.attachInfo;e.init()})}},{key:"queryAll",value:function(e){var t=this;e&&(this.page=e);var a=this.page,r=this.size,i=L({},this.searchForm,{page:a,size:r});this.loading=!0,Object(w["B"])(i).then(function(e){var a=e.data||{},r=a.result||[];t.list=r,t.total=a.total,t.loading=!1}).catch(function(e){return t.loading=!1,e})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.queryAll()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.queryAll()}},{key:"created",value:function(){this.getTypeList(),this.queryAll(),this.getCountryList().then(function(e){return e}).catch(function(e){return e})}},{key:"custId",get:function(){var e=y["a"].info||{},t=e.custId;return t}},{key:"custName",get:function(){var e=y["a"].info||{},t=e.custName;return t}},{key:"pickerOptions",get:function(){return{disabledDate:function(e){return e.getTime()>Date.now()}}}},{key:"subtypeList",get:function(){var e=this,t=this.typeList.find(function(t){return t.id===e.searchForm.types});return t?t.subtypeList:[]}}]),t}(g["e"]);I=p["a"]([Object(g["a"])({name:"SupplierManagement",components:{AttachInfo:b["a"],HeadInfoWithBack:k["a"]},props:{}})],I);var C=I,F=C,O=(a("8b70"),a("2877")),N=Object(O["a"])(F,r,i,!1,null,"26218258",null);t["default"]=N.exports},"2c7a":function(e,t,a){},"8b70":function(e,t,a){"use strict";var r=a("2c7a"),i=a.n(r);i.a},f248:function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return n}),a.d(t,"c",function(){return s}),a.d(t,"e",function(){return o}),a.d(t,"d",function(){return l});var r=a("b32d");function i(e){var t={url:"/auth/custtype/getCustTypeList",method:"get",params:e};return Object(r["a"])(t)}function n(e){var t={url:"/auth/custtype/getCustTypeDtlList",method:"get",params:e};return Object(r["a"])(t)}function s(e){var t={url:"/auth/custtype/getTypeTemplateList",method:"get",params:e};return Object(r["a"])(t)}function o(e){var t={url:"/auth/custtype/saveTypeTemplateList",method:"post",data:e};return Object(r["a"])(t)}function l(e){var t={url:"/auth/custtype/saveCustType",method:"post",data:e};return Object(r["a"])(t)}}}]);