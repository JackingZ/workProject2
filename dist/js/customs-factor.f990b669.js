(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["customs-factor"],{"36f5":function(e,t,a){},"79df":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{staticClass:"app-container"},[a("head-info",{attrs:{info:"",title:"报关要素"}}),a("div",{staticClass:"app-panel"},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["customsFactorAdd"],expression:"['customsFactorAdd']"}],staticStyle:{"margin-left":"10px"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addRow}},[e._v("\n              新增\n            ")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,placeholder:"国家",size:"small",clearable:"",filterable:""},on:{focus:e.getCountryData},model:{value:e.selectValue.countryId,callback:function(t){e.$set(e.selectValue,"countryId",t)},expression:"selectValue.countryId"}},e._l(e.countryList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"状态",size:"small",clearable:"",filterable:""},model:{value:e.selectValue.enabled,callback:function(t){e.$set(e.selectValue,"enabled",t)},expression:"selectValue.enabled"}},[a("el-option",{attrs:{label:"启用",value:"0"}}),a("el-option",{attrs:{label:"禁用",value:"1"}})],1),a("el-input",{staticStyle:{width:"250px","margin-right":"10px"},attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.selectValue.keyword,callback:function(t){e.$set(e.selectValue,"keyword",t)},expression:"selectValue.keyword"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",size:"small",placeholder:"请选择"},slot:"prepend",model:{value:e.keyType,callback:function(t){e.keyType=t},expression:"keyType"}},[a("el-option",{attrs:{label:"中文名称",value:"1"}}),a("el-option",{attrs:{label:"英文名称",value:"2"}}),a("el-option",{attrs:{label:"海关编码",value:"3"}})],1)],1),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["customsFactorSearch"],expression:"['customsFactorSearch']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.queryAll(1)}}},[e._v("\n              查询\n            ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 300px)",border:""}},[a("el-table-column",{attrs:{"min-width":"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.cnName?t.row.cnName:"--")+"\n              ")]),a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.enName?t.row.enName:"--")+"\n              ")])]}}])},[a("template",{slot:"header"},[a("span",[e._v("商品名称(中文)")]),a("br"),a("span",[e._v("商品名称(英文)")])])],2),a("el-table-column",{attrs:{prop:"",label:"海关编码",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){return e.editCode(t.row)}}},[e._v("\n                海关编码\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"brand",label:"品牌","min-width":"120"}}),a("el-table-column",{attrs:{prop:"model",label:"型号","min-width":"120"}}),a("el-table-column",{attrs:{"min-width":"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.cnMeterial?t.row.cnMeterial:"--")+"\n              ")]),a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.enMeterial?t.row.enMeterial:"--")+"\n              ")])]}}])},[a("template",{slot:"header"},[a("span",[e._v("材质(中文)")]),a("br"),a("span",[e._v("材质(英文)")])])],2),a("el-table-column",{attrs:{"min-width":"180","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.cnUsage?t.row.cnUsage:"--")+"\n              ")]),a("div",{staticClass:"item-word"},[e._v("\n                "+e._s(t.row.enUsage?t.row.enUsage:"--")+"\n              ")])]}}])},[a("template",{slot:"header"},[a("span",[e._v("用途(中文)")]),a("br"),a("span",[e._v("用途(英文)")])])],2),a("el-table-column",{attrs:{prop:"remarks",label:"备注","min-width":"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"启用状态",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{staticClass:"switchStyle",attrs:{value:t.row.deleted,disabled:!e.$checkPermission(["customsFactorStatus"]),"active-text":"启用","inactive-text":"禁用","active-value":0,"inactive-value":1},on:{input:function(a){return e.switchChange(t.row,a)}}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"130",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["customsFactorEdit"],expression:"['customsFactorEdit']"}],attrs:{type:"text",size:"medium"},on:{click:function(a){return e.editRow(t.row)}}},[e._v("\n                编辑\n              ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["customsFactorCopy"],expression:"['customsFactorCopy']"}],attrs:{type:"text",size:"medium"},on:{click:function(a){return e.copyRow(t.row)}}},[e._v("\n                复制\n              ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:"add"===e.isEdit?"新增报关要素":"edit"===e.isEdit?"编辑报关要素":"复制报关要素",visible:e.isDialogFormShow,"close-on-click-modal":!1,width:"960px"},on:{"update:visible":function(t){e.isDialogFormShow=t},closed:e.cancel}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-form",{ref:"editForm",staticClass:"edit-form",staticStyle:{"padding-right":"20px"},attrs:{model:e.form,rules:e.formRules,"label-width":"100px","label-position":"right",size:"small"}},[a("el-form-item",{attrs:{prop:"cnName",label:"中文名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:20},model:{value:e.form.cnName,callback:function(t){e.$set(e.form,"cnName",t)},expression:"form.cnName"}})],1),a("el-form-item",{attrs:{prop:"enName",label:"英文名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:50},model:{value:e.form.enName,callback:function(t){e.$set(e.form,"enName",t)},expression:"form.enName"}})],1),a("el-form-item",{attrs:{prop:"",label:"品牌"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:50},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("el-form-item",{attrs:{prop:"",label:"型号"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:50},model:{value:e.form.model,callback:function(t){e.$set(e.form,"model",t)},expression:"form.model"}})],1),a("el-form-item",{attrs:{prop:"",label:"材质中文"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:50},model:{value:e.form.cnMeterial,callback:function(t){e.$set(e.form,"cnMeterial",t)},expression:"form.cnMeterial"}})],1),a("el-form-item",{attrs:{prop:"",label:"材质英文"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:100},model:{value:e.form.enMeterial,callback:function(t){e.$set(e.form,"enMeterial",t)},expression:"form.enMeterial"}})],1),a("el-form-item",{attrs:{prop:"",label:"用途中文"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:50},model:{value:e.form.cnUsage,callback:function(t){e.$set(e.form,"cnUsage",t)},expression:"form.cnUsage"}})],1),a("el-form-item",{attrs:{prop:"",label:"用途英文"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:100},model:{value:e.form.enUsage,callback:function(t){e.$set(e.form,"enUsage",t)},expression:"form.enUsage"}})],1),a("el-form-item",{staticStyle:{width:"100%"},attrs:{prop:"",label:"备注"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",maxlength:100,placeholder:"请输入"},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1)],1),a("div",{staticStyle:{"text-align":"right",padding:"10px 0 20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("\n                取 消\n              ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("\n                确 定\n              ")])],1)],1)]),a("el-dialog",{attrs:{title:"海关编码",visible:e.isCodeVisible,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(t){e.isCodeVisible=t},close:e.cancelCode}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-form",{ref:"selectForm",staticClass:"code-form",attrs:{model:e.selectForm,"label-position":"right",size:"small"}},[a("div",{staticStyle:{"max-height":"400px","overflow-y":"auto"}},e._l(e.selectForm.sections,function(t,o){return a("div",{key:o,staticClass:"item-after-icon"},[a("el-form-item",{attrs:{label:"国家:",prop:"countryId","label-width":"50px"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,placeholder:"请选择",size:"small",clearable:"",filterable:""},on:{focus:e.getCountryData},model:{value:e.selectForm.sections[o].countryId,callback:function(t){e.$set(e.selectForm.sections[o],"countryId",t)},expression:"selectForm.sections[index].countryId"}},e._l(e.countryList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name+"-"+e.alias,value:e.id}})}),1)],1),a("span",{staticStyle:{"padding-left":"10px"}},[e._v("海关编码:")]),a("el-form-item",{attrs:{prop:"code",label:"不包税","label-width":"60px"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:20},model:{value:e.selectForm.sections[o].customCode,callback:function(t){e.$set(e.selectForm.sections[o],"customCode",t)},expression:"selectForm.sections[index].customCode"}})],1),a("el-form-item",{attrs:{prop:"code",label:"包税","label-width":"50px"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{autocomplete:"off",maxlength:20},model:{value:e.selectForm.sections[o].customCodeN,callback:function(t){e.$set(e.selectForm.sections[o],"customCodeN",t)},expression:"selectForm.sections[index].customCodeN"}})],1),a("span",[a("i",0===o?{staticClass:"el-icon-circle-plus-outline item-icon-plus",on:{click:e.addRangeData}}:{staticClass:"el-icon-remove-outline item-icon-reduce",on:{click:function(t){return e.deleteRangeData(o)}}})])],1)}),0)]),a("div",{staticStyle:{padding:"10px 10px 20px","text-align":"right"}},[a("el-button",{on:{click:e.cancelCode}},[e._v("\n                取 消\n              ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveConfirm}},[e._v("\n                确 定\n              ")])],1)],1)])],1)],1)])])},i=[],n=(a("8e6e"),a("456d"),a("768b")),l=(a("6b54"),a("96cf"),a("3b8d")),s=(a("7f7f"),a("7514"),a("ac6a"),a("5df3"),a("4f7f"),a("75fc")),r=a("bd86"),c=a("a8db"),u=(a("c5f6"),a("d225")),d=a("b0b4"),m=a("308d"),p=a("6bb5"),f=a("4e2b"),v=a("9ab4"),h=a("60a3"),g=a("ac1a"),y=a("b32d");function b(){var e={url:"/setting/area/getCountryList",method:"get"};return Object(y["a"])(e)}function w(e){var t={url:"/setting/essential/page",method:"post",data:e};return Object(y["a"])(t)}function k(e){var t={url:"/setting/essential/save",method:"post",data:e};return Object(y["a"])(t)}function x(e){var t={url:"/setting/essential/copy_custom",method:"post",data:e};return Object(y["a"])(t)}function C(e){var t={url:"/setting/essential/get_custom",method:"get",params:e};return Object(y["a"])(t)}function S(e){var t={url:"/setting/essential/save_custom",method:"post",data:e};return Object(y["a"])(t)}function N(e){var t={url:"/setting/essential/enable",method:"post",params:e};return Object(y["a"])(t)}function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,o)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(a,!0).forEach(function(t){Object(r["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var O=function(e){function t(){var e;return Object(u["a"])(this,t),e=Object(m["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.loading=!1,e.dialogLoading=!1,e.isDialogFormShow=!1,e.isCodeVisible=!1,e.selectLoading=!1,e.isEdit="",e.tableData=[],e.keyType="1",e.selectValue={countryId:void 0,keyword:void 0,enabled:void 0},e.form={cnName:void 0,enName:void 0,brand:void 0,model:void 0,cnMeterial:void 0,enMeterial:void 0,cnUsage:void 0,enUsage:void 0,remarks:void 0},e.formRules={cnName:[{required:!0,message:"商品中文名称不能为空",trigger:"blur"}],enName:[{required:!0,message:"商品英文名称不能为空",trigger:"blur"},{validator:function(e,t,a){var o=/[\u4e00-\u9fa5]/;t?o.test(t)?a(new Error("商品英文名称不能有中文")):a():a(new Error("商品英文名称不能为空"))},trigger:"blur"}]},e.selectForm={sections:[{countryId:void 0,customCode:void 0,customCodeN:void 0}]},e.currentId="",e.countryList=[],e.page=1,e.size=10,e.total=0,e}return Object(f["a"])(t,e),Object(d["a"])(t,[{key:"getCountryData",value:function(){var e=this;this.selectLoading=!0,b().then(function(t){var a=t.data||{};e.countryList=a.result||[],e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"queryAll",value:function(e){var t=this;this.loading=!0,e&&(this.page=e);var a={model:{countryId:this.selectValue.countryId||void 0,enabled:this.selectValue.enabled||void 0,cnName:"1"===this.keyType?this.selectValue.keyword:void 0,enName:"2"===this.keyType?this.selectValue.keyword:void 0,customCode:"3"===this.keyType?this.selectValue.keyword:void 0},page:this.page,size:this.size};w(a).then(function(e){t.loading=!1;var a=e.data||{};t.tableData=a.result||[],t.total=a.total}).catch(function(e){return t.loading=!1,e})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.queryAll()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.queryAll()}},{key:"editCode",value:function(e){this.isCodeVisible=!0,this.currentId=e.id,this.getCodes(),this.getCountryData()}},{key:"getCodes",value:function(){var e=this;this.dialogLoading=!0,C({id:this.currentId}).then(function(t){var a=t.data||[];a.length<=0?e.selectForm.sections=[{countryId:void 0,customCode:void 0,customCodeN:void 0}]:e.selectForm.sections=a.map(function(e){var t=e.customCode,a=e.customCodeN,o=Object(c["a"])(e,["customCode","customCodeN"]);return F({},o,{customCode:t||void 0,customCodeN:a||void 0})}),e.dialogLoading=!1}).catch(function(t){return e.dialogLoading=!1,t})}},{key:"addRangeData",value:function(){this.selectForm.sections.push({countryId:void 0,customCode:void 0,customCodeN:void 0})}},{key:"deleteRangeData",value:function(e){this.selectForm.sections.splice(e,1)}},{key:"cancelCode",value:function(){this.isCodeVisible=!1,this.selectForm={sections:[{countryId:void 0,customCode:void 0,customCodeN:void 0}]}}},{key:"saveConfirm",value:function(){var e=this,t=this.selectForm.sections,a=Array.isArray(t)&&t.every(function(e){return e.countryId&&e.customCode&&e.customCodeN});if(a){var o=t.map(function(e){return e.countryId}),i=Object(s["a"])(new Set(o));if(i.length<t.length)this.$message.error("国家不能重复");else{this.dialogLoading=!0;var n=t.map(function(t){var a=t.countryId,o=t.customCode,i=t.customCodeN,n=t.deleted,l=t.essentialId,s=t.id,r=e.countryList.find(function(e){return e.id===a})||{};return{countryId:r.id,countryName:r.name,customCode:o,customCodeN:i,deleted:n||0,essentialId:l||e.currentId,id:s}});S({id:this.currentId,list:n}).then(function(t){e.dialogLoading=!1,e.$message({type:"success",message:"保存成功"}),e.isCodeVisible=!1,e.selectForm={sections:[{countryId:void 0,customCode:void 0,customCodeN:void 0}]},e.queryAll()}).catch(function(t){return e.dialogLoading=!1,t})}}else this.$message.error("请填写完整国家和海关编码")}},{key:"addRow",value:function(){this.isDialogFormShow=!0,this.isEdit="add"}},{key:"editRow",value:function(e){this.isDialogFormShow=!0,this.isEdit="edit",this.form=F({},e)}},{key:"copyRow",value:function(e){this.isDialogFormShow=!0,this.isEdit="copy";var t=Object.assign({},e);this.form=F({},t)}},{key:"switchChange",value:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t,a){var o,i,l,s,r,c,u,d=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=t.deleted.toString(),i=a.toString(),o&&o!==i){e.next=4;break}return e.abrupt("return");case 4:return l="1"===i?"禁用":"开启",e.next=7,this.$confirm("此操作将".concat(l,"该报关要素，是否继续？"),"提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 7:if(s=e.sent,r=Object(n["a"])(s,2),c=r[0],r[1],!c){e.next=13;break}return e.abrupt("return");case 13:u={id:t.id},N(u).then(function(e){d.$message({type:"success",message:"更新成功"}),d.queryAll()}).catch(function(e){return e});case 15:case"end":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}()},{key:"deleteRow",value:function(e){var t=this,a=F({},e,{deleted:1});this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){k(a).then(function(e){t.$message({type:"success",message:"删除成功"}),t.queryAll()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"confirm",value:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return!1;e.dialogLoading=!0;var a=F({},e.form,{deleted:0});"copy"===e.isEdit?x(a).then(function(t){e.dialogLoading=!1,e.cancel(),e.$message({type:"success",message:"保存成功"}),e.queryAll()}).catch(function(t){return e.dialogLoading=!1,t}):k(a).then(function(t){e.dialogLoading=!1,e.cancel(),e.$message({type:"success",message:"保存成功"}),e.queryAll()}).catch(function(t){return e.dialogLoading=!1,t})})}},{key:"cancel",value:function(){this.isDialogFormShow=!1,this.isEdit="",this.reset()}},{key:"reset",value:function(){this.form={cnName:void 0,enName:void 0,brand:void 0,model:void 0,cnMeterial:void 0,enMeterial:void 0,cnUsage:void 0,enUsage:void 0,remarks:void 0},this.clearValidate()}},{key:"clearValidate",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.editForm;t.clearValidate()})}},{key:"created",value:function(){this.queryAll()}},{key:"labelPosition",get:function(){var e=g["a"].language;return e&&"en"===e?"top":"left"}},{key:"lang",get:function(){var e=g["a"].language;return e||"en"}}]),t}(h["e"]);O=v["a"]([Object(h["a"])({name:"Port",components:{},props:{}})],O);var j=O,$=j,L=(a("9a7a"),a("2877")),I=Object(L["a"])($,o,i,!1,null,"67b7c72c",null);t["default"]=I.exports},"9a7a":function(e,t,a){"use strict";var o=a("36f5"),i=a.n(o);i.a}}]);