(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["warehouse-price"],{"1a56":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[r("app-slide",{staticStyle:{margin:"15px 0 15px 15px",padding:"0"},attrs:{width:"400","is-active":e.isActive}},[r("div",{staticStyle:{padding:"20px"}},[r("el-row",[r("el-col",{staticStyle:{"line-height":"32px"},attrs:{span:12}},[e._v("\n          仓储报价\n        ")]),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehousQuoteAdd"],expression:"['warehousQuoteAdd']"}],attrs:{type:"text",size:"small"},on:{click:e.addPrice}},[e._v("\n            新增报价\n          ")])],1)],1),r("div",{staticStyle:{"padding-top":"10px"}},[r("el-form",{staticClass:"search-form",attrs:{model:e.searchForm,size:"mini"}},[r("el-form-item",[r("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,size:"mini",clearable:"",filterable:"",placeholder:"仓库"},on:{focus:function(t){return e.getServiceList("sea")},change:e.getTableData},model:{value:e.searchForm.warehouseId,callback:function(t){e.$set(e.searchForm,"warehouseId",t)},expression:"searchForm.warehouseId"}},e._l(e.serviceList1,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),r("el-form-item",[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",filterable:"",placeholder:"审核状态"},on:{change:e.getTableData},model:{value:e.searchForm.auditing,callback:function(t){e.$set(e.searchForm,"auditing",t)},expression:"searchForm.auditing"}},e._l(e.auditList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),r("el-form-item",[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini",clearable:"",filterable:"",placeholder:"报价标准"},on:{change:e.getTableData},model:{value:e.searchForm.ifStandard,callback:function(t){e.$set(e.searchForm,"ifStandard",t)},expression:"searchForm.ifStandard"}},[r("el-option",{attrs:{label:"标准",value:!0}}),r("el-option",{attrs:{label:"特殊",value:!1}})],1)],1),r("el-form-item",[r("el-popover",{attrs:{placement:"bottom-start",trigger:"click"},model:{value:e.popoverShow,callback:function(t){e.popoverShow=t},expression:"popoverShow"}},[r("div",{staticStyle:{padding:"8px 15px 0 0"}},[r("el-form-item",{attrs:{label:"有效时间","label-width":"90px"}},[r("el-date-picker",{staticStyle:{width:"280px"},attrs:{clearable:!1,"unlink-panels":"",type:"daterange",align:"left",size:"mini","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"起始时间","end-placeholder":"截止时间"},model:{value:e.searchForm.times,callback:function(t){e.$set(e.searchForm,"times",t)},expression:"searchForm.times"}})],1),r("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.handleClear}},[e._v("\n                    清空\n                  ")]),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehousQuoteQuery"],expression:"['warehousQuoteQuery']"}],attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("\n                    筛选\n                  ")])],1)],1),r("div",{staticClass:"el-select el-select--small",staticStyle:{width:"100%"},attrs:{slot:"reference"},slot:"reference"},[r("el-input",{attrs:{placeholder:"全部筛选",readonly:"","suffix-icon":"el-select__caret el-input__icon el-icon-arrow-up"}})],1)])],1)],1),r("el-scrollbar",{directives:[{name:"loading",rawName:"v-loading",value:e.cardLoading,expression:"cardLoading"}],staticStyle:{height:"calc(100vh - 280px)"}},e._l(e.cardList,function(t,i){return r("div",{key:i,staticClass:"el-card is-hover-shadow",class:{"active-card":e.currentId===t.id},staticStyle:{"font-size":"12px","margin-bottom":"10px",cursor:"pointer"},on:{click:function(i){return e.onRow(t)},contextmenu:function(i){return i.preventDefault(),e.showMenu(t,i)}}},[r("div",{staticClass:"el-card__body"},[r("el-row",{staticStyle:{"padding-bottom":"10px"}},[r("el-col",{attrs:{span:1}},[1===t.auditing?r("el-tooltip",{attrs:{effect:"dark",content:"待审核",placement:"top"}},[r("i",{staticClass:"card-tips card-tip-zero"})]):e._e(),4===t.auditing?r("el-tooltip",{attrs:{effect:"dark",content:"已通过",placement:"top"}},[r("i",{staticClass:"card-tips card-tip-one"})]):e._e(),3===t.auditing?r("el-tooltip",{attrs:{effect:"dark",content:"已拒绝",placement:"top"}},[r("i",{staticClass:"card-tips card-tip-two"})]):e._e(),2===t.auditing?r("el-tooltip",{attrs:{effect:"dark",content:"审核中",placement:"top"}},[r("i",{staticClass:"card-tips card-tip-three"})]):e._e()],1),r("el-col",{staticClass:"word-limit",attrs:{span:19}},[e._v("\n                  "+e._s(t.warehouseName)+"\n                ")]),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("\n                  "+e._s(t.ifStandard?"标准报价":"特殊报价")+"\n                ")])],1),r("el-row",[r("el-col",{attrs:{span:4}},[1===t.effective?r("span",{staticClass:"btn-tip-blue"},[e._v("待生效")]):2===t.effective?r("span",{staticClass:"btn-tip-green"},[e._v("生效中")]):3===t.effective?r("span",{staticClass:"btn-tip-grey"},[e._v("已失效")]):e._e()]),r("el-col",{staticStyle:{"line-height":"16px"},attrs:{span:16}},[e._v("\n                  "+e._s(e.formatTime(t))+"\n                ")]),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},["2"===t.toCustType?r("span",[e._v("代理商价")]):"1"===t.toCustType&&"0"===t.toCustSubtype?r("span",[e._v("直客价")]):"1"===t.toCustType&&"1"===t.toCustSubtype?r("span",[e._v("同行价")]):"0"===t.toCustType?r("span",[e._v("聚货通价")]):e._e()])],1)],1)])}),0),r("el-pagination",{staticStyle:{"text-align":"right","margin-top":"10px"},attrs:{small:"","current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),r("div",{staticStyle:{display:"flex","align-items":"center"}},[r("div",{staticClass:"arrow-btn",on:{click:e.toggle}},[r("img",{class:{arrow:!e.isActive},attrs:{src:i("1e9b"),alt:""}})])]),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],staticStyle:{flex:"1",overflow:"auto",margin:"15px","background-color":"#fff",padding:"20px"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isRightShow,expression:"isRightShow"}]},[r("el-form",{ref:"editForm",staticClass:"select-form",attrs:{model:e.selectForm,rules:e.formRules,"label-width":"90px","label-position":"right",size:"mini"}},[r("el-row",[r("el-col",{attrs:{span:18}},[r("el-form-item",{attrs:{prop:"warehouseId","label-width":"75px"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("仓库")]),r("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.selectForm.warehouseId,expression:"selectForm.warehouseId"}],attrs:{slot:"label",content:e.selectForm.warehouseName,placement:"top",effect:"light"},slot:"label"},[r("i",{staticClass:"el-icon-warning-outline"})]),r("el-select",{staticStyle:{width:"90px"},attrs:{loading:e.selectLoading,disabled:e.isEdit||!e.isAdd,clearable:"",filterable:"",placeholder:"请选择"},on:{focus:function(t){return e.getServiceList("sel")},change:e.onService},model:{value:e.selectForm.warehouseId,callback:function(t){e.$set(e.selectForm,"warehouseId",t)},expression:"selectForm.warehouseId"}},e._l(e.serviceList2,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),"2"===e.custType?r("el-form-item",{attrs:{label:"参考报价",prop:"refId"}},[r("el-select",{staticStyle:{width:"170px"},attrs:{loading:e.selectLoading,disabled:e.isEdit||!e.isAdd||!e.selectForm.warehouseId,size:"mini",clearable:"",filterable:"",placeholder:"请选择"},on:{focus:e.getEffectiveBook,change:e.onEffect},model:{value:e.selectForm.refId,callback:function(t){e.$set(e.selectForm,"refId",t)},expression:"selectForm.refId"}},e._l(e.effectList,function(t,i){return r("el-option",{key:i,attrs:{label:e.dayjs(t.startTime).format("YYYY-MM-DD")+"-"+e.dayjs(t.endTime).format("YYYY-MM-DD"),value:t.id}})}),1)],1):e._e(),r("el-form-item",{attrs:{label:"报价对象",prop:"toCustSubtype",required:"2"===e.custType||"3"===e.custType}},["0"===e.custType?r("div",[e._v("\n                一级代理商\n              ")]):"2"===e.custType||"3"===e.custType?r("el-select",{staticStyle:{width:"90px"},attrs:{disabled:e.isEdit||!e.isAdd,clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.onType},model:{value:e.selectForm.toCustSubtype,callback:function(t){e.$set(e.selectForm,"toCustSubtype",t)},expression:"selectForm.toCustSubtype"}},e._l(e.custList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e()],1)],1),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e.isHistory?e._e():[e.isEdit||e.isAdd||1!==e.selectForm.auditing&&3!==e.selectForm.auditing||!e.$checkPermission(["warehousQuoteEdit"])?e._e():r("el-button",{style:4===e.selectForm.auditing?"margin-right: 10px;":"",attrs:{type:"text",size:"small"},on:{click:e.editRow}},[e._v("\n                编辑\n              ")]),r("el-popover",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit&&!e.isAdd&&4!==e.selectForm.auditing&&e.$checkPermission(["warehousQuoteAudit"]),expression:"!isEdit && !isAdd && selectForm.auditing !== 4 && $checkPermission(['warehousQuoteAudit'])"}],attrs:{placement:"bottom",trigger:"click"},on:{show:e.onShow,hide:e.onHide},model:{value:e.auditShow,callback:function(t){e.auditShow=t},expression:"auditShow"}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.selectLoading,expression:"selectLoading"}],staticStyle:{"padding-right":"15px"}},[r("el-form",{ref:"auditForm",attrs:{model:e.auditForm,rules:e.auditRules,"label-width":"90px","label-position":"right",size:"small"}},[r("el-form-item",{attrs:{label:"审核状态：",prop:"auditing","label-width":"110px"}},[r("el-radio-group",{model:{value:e.auditForm.auditing,callback:function(t){e.$set(e.auditForm,"auditing",t)},expression:"auditForm.auditing"}},[r("el-radio",{attrs:{label:4}},[e._v("\n                          通过\n                        ")]),r("el-radio",{attrs:{label:3}},[e._v("\n                          拒绝\n                        ")])],1)],1),3===e.auditForm.auditing?r("el-form-item",{attrs:{label:"拒绝原因：",prop:"reason"}},[r("el-input",{attrs:{type:"textarea",rows:2,maxlength:100,placeholder:"请输入原因"},model:{value:e.auditForm.reason,callback:function(t){e.$set(e.auditForm,"reason",t)},expression:"auditForm.reason"}})],1):e._e(),r("div",{staticStyle:{"text-align":"right","padding-top":"10px"}},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.auditShow=!1}}},[e._v("\n                        取消\n                      ")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.auditRow}},[e._v("\n                        确认\n                      ")])],1)],1)],1),r("el-button",{staticStyle:{margin:"0 10px"},attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[e._v("\n                  审核\n                ")])],1),(e.isAdd||e.isEdit)&&e.$checkPermission(["warehousQuoteAdd","warehousQuoteEdit"])?r("el-button",{staticStyle:{"padding-right":"10px"},attrs:{type:"text",size:"small"},on:{click:e.cancelRow}},[e._v("\n                取消\n              ")]):e._e(),(e.isAdd||e.isEdit)&&e.$checkPermission(["warehousQuoteAdd","warehousQuoteEdit"])?r("el-button",{attrs:{type:"text",size:"small"},on:{click:e.saveRow}},[e._v("\n                保存\n              ")]):e._e(),e.isAdd||e.isEdit||1!==e.selectForm.auditing&&3!==e.selectForm.auditing||!e.$checkPermission(["warehousQuoteDel"])?e._e():r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.deleteRow(1)}}},[e._v("\n                删除\n              ")])],e.isEdit||e.isAdd?e._e():[e.$checkPermission(["warehousQuoteCopy"])?r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"small"},on:{click:e.copyPrice}},[e._v("\n                复制此版本\n              ")]):e._e(),4!==e.selectForm.auditing||e.historyId?e._e():r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text",size:"small"},on:{click:e.invalidPrice}},[e._v("\n                失效\n              ")])]],2)],1),r("div",{staticClass:"item-read"},[r("el-form-item",{attrs:{label:"重量单位：",prop:"umWeight"}},[r("div",{staticStyle:{width:"60px"}},["T"===e.selectForm.umWeight?r("span",[e._v("\n                T-吨\n              ")]):e._e(),"LBS"===e.selectForm.umWeight?r("span",[e._v("\n                LB-磅\n              ")]):e._e(),"KGS"===e.selectForm.umWeight?r("span",[e._v("\n                KG-公斤\n              ")]):e._e(),"OZS"===e.selectForm.umWeight?r("span",[e._v("\n                OZ-盎\n              ")]):e._e()])]),r("el-form-item",{attrs:{label:"长度单位：",prop:"umLength"}},[r("div",{staticStyle:{width:"60px"}},["FT"===e.selectForm.umLength?r("span",[e._v("\n                FT-英尺\n              ")]):e._e(),"M"===e.selectForm.umLength?r("span",[e._v("\n                M-米\n              ")]):e._e(),"CM"===e.selectForm.umLength?r("span",[e._v("\n                CM-厘米\n              ")]):e._e()])]),r("el-form-item",{attrs:{label:"货币单位：",prop:"currencyId"}},[e.selectForm.currencyId?r("span",[e._v("\n              "+e._s(e.selectForm.currencyId)+"\n            ")]):e._e()])],1),r("el-row",[r("el-col",{attrs:{span:21}},["0"===e.custType||"2"===e.custType||"3"===e.custType&&["0","1"].includes(e.selectForm.toCustSubtype)?r("el-form-item",{attrs:{label:"价格标准",prop:"mode"}},[r("el-radio-group",{attrs:{disabled:!e.isEdit&&!e.isAdd},on:{change:e.onMode},model:{value:e.selectForm.ifStandard,callback:function(t){e.$set(e.selectForm,"ifStandard",t)},expression:"selectForm.ifStandard"}},[r("el-radio",{attrs:{label:!0}},[e._v("\n                  标准\n                ")]),r("el-radio",{attrs:{label:!1}},[e._v("\n                  特殊\n                ")])],1)],1):e._e(),("0"===e.custType||"2"===e.custType||"3"===e.custType&&["0","1"].includes(e.selectForm.toCustSubtype))&&!e.selectForm.ifStandard?r("el-form-item",{staticClass:"is-required",attrs:{label:e.isLabelValue,"label-width":"110px"}},[r("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.onCompany}},[e._v("\n                已选择("+e._s((e.selectForm.associatedAgents||[]).length)+")\n              ")])],1):e._e(),e.selectForm.ifStandard?e._e():r("el-form-item",{attrs:{label:"有效时间",prop:"refStandard"}},[r("el-select",{staticStyle:{width:"180px"},attrs:{loading:e.selectLoading,disabled:!e.isEdit&&!e.isAdd,clearable:"",filterable:"",placeholder:"请选择"},on:{focus:e.getTimeList},model:{value:e.selectForm.refStandard,callback:function(t){e.$set(e.selectForm,"refStandard",t)},expression:"selectForm.refStandard"}},e._l(e.timeList,function(t){return r("el-option",{key:t.id,attrs:{label:e.dayjs(t.startTime).format("YYYY-MM-DD")+"-"+e.dayjs(t.endTime).format("YYYY-MM-DD"),value:t.id}})}),1)],1),e.selectForm.ifStandard?r("el-form-item",{attrs:{label:"有效时间","label-width":"90px",prop:"times"}},[r("el-date-picker",{staticStyle:{width:"240px","margin-right":"20px"},attrs:{disabled:!e.isEdit&&!e.isAdd,clearable:!1,"picker-options":e.pickerOptions,"unlink-panels":"",type:"daterange",align:"left",size:"mini","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"起始时间","end-placeholder":"截止时间"},model:{value:e.selectForm.times,callback:function(t){e.$set(e.selectForm,"times",t)},expression:"selectForm.times"}})],1):e._e()],1),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[e.isEdit||e.isAdd?e._e():r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:"历史版本",size:"mini"},on:{focus:e.getHistoryPrice,change:e.onHistory},model:{value:e.historyId,callback:function(t){e.historyId=t},expression:"historyId"}},e._l(e.historyList,function(t,i){return r("el-option",{key:i,attrs:{label:e.dayjs(t.startTime).format("YYYY-MM-DD")+"-"+e.dayjs(t.endTime).format("YYYY-MM-DD"),value:t.id}})}),1),"2"===e.custType&&(e.isAdd||e.isEdit)?r("el-popover",{attrs:{placement:"bottom",trigger:"click"},on:{show:e.onOpen,hide:e.onClose},model:{value:e.batchShow,callback:function(t){e.batchShow=t},expression:"batchShow"}},[r("div",{staticStyle:{padding:"0 20px 0 10px",width:"240px"}},[r("div",[e._v("请输入需要批量修改的值")]),r("el-input-number",{staticClass:"input-number-valiate",staticStyle:{margin:"13px 0 26px 0"},attrs:{controls:!1,placeholder:"请输入",precision:2,size:"mini"},on:{focus:function(e){e.stopPropagation()}},model:{value:e.batchNum,callback:function(t){e.batchNum=t},expression:"batchNum"}}),r("div",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{color:"#FF6D00"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.batchConfirm(0)}}},[e._v("\n                    重置\n                  ")]),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{staticStyle:{color:"#999999"},attrs:{type:"text",size:"mini"},on:{click:function(t){e.batchShow=!1}}},[e._v("\n                      取消\n                    ")]),r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.batchConfirm(1)}}},[e._v("\n                      保存\n                    ")])],1)],1)],1),r("el-button",{attrs:{slot:"reference",type:"text",size:"mini"},slot:"reference"},[e._v("\n                批量修改\n              ")])],1):e._e()],1)],1),e.isEdit||e.isAdd||3!==e.selectForm.auditing?e._e():r("div",[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"拒绝原因：","label-width":"90px"}},[e._v("\n            "+e._s(e.selectForm.reason)+"\n          ")])],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isTableShow,expression:"isTableShow"}]},[r("el-row",{attrs:{gutter:20}},["2"===e.custType?r("el-col",{attrs:{span:12}},[r("div",{staticClass:"table-header-title"},[e._v("\n              参考价\n            ")]),r("el-table",{ref:"priceTable",staticStyle:{width:"100%"},attrs:{data:e.tableUpper,"span-method":e.tableUpperSpanMethod,height:"calc(100vh - 360px)",border:""}},[r("el-table-column",{attrs:{prop:"name",width:"150","show-overflow-tooltip":"",label:"收费项目"}}),r("el-table-column",{attrs:{prop:"type",width:"100",label:"计费方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(e.formatType(t.row.type))+"\n                ")]}}],null,!1,2123470975)}),r("el-table-column",{attrs:{width:"150",label:"计费配置","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticStyle:{height:"32px","line-height":"32px"}},[5===t.row.type||6===t.row.type?r("span",[e._v(e._s(t.row.cellName))]):t.row.min&&t.row.max?r("span",[e._v(e._s(t.row.min+"-"+t.row.max))]):r("span",[e._v("单位单价")])])}}],null,!1,911983298)}),r("el-table-column",{attrs:{prop:"price",label:"价格"}}),r("el-table-column",{attrs:{"min-width":"120",label:"备注",prop:"remark"}})],1)],1):e._e(),r("el-col",{attrs:{span:"2"===e.custType?12:24}},[r("div",{staticClass:"table-header-title"},[e._v("\n              标准价\n            ")]),r("el-table",{ref:"priceTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"span-method":e.tableDataSpanMethod,height:"calc(100vh - 360px)",border:""}},[r("el-table-column",{attrs:{prop:"name",width:"150",label:"收费项目","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{prop:"type",width:"100",label:"计费方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  "+e._s(e.formatType(t.row.type))+"\n                ")]}}])}),r("el-table-column",{attrs:{width:"150",label:"计费配置","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return r("div",{staticStyle:{height:"32px","line-height":"32px"}},[5===t.row.type||6===t.row.type?r("span",[e._v(e._s(t.row.cellName))]):t.row.min&&t.row.max?r("span",[e._v(e._s(t.row.min+"-"+t.row.max))]):r("span",[e._v("单位单价")])])}}])}),r("el-table-column",{attrs:{label:"价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[(e.isEdit||e.isAdd)&&(5!==t.row.type&&6!==t.row.type||t.row.cellValue)?r("el-input-number",{staticClass:"input-number-valiate",attrs:{size:"small",controls:!1,placeholder:"请输入",min:0,max:999999,precision:2},model:{value:t.row.price,callback:function(i){e.$set(t.row,"price",i)},expression:"scope.row.price"}}):r("span",[e._v(e._s(t.row.price))])],1)]}}])}),r("el-table-column",{attrs:{label:"最低收费"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[(e.isEdit||e.isAdd)&&(5!==t.row.type&&6!==t.row.type||t.row.cellValue)?r("el-input-number",{staticClass:"input-number-valiate",attrs:{size:"small",controls:!1,placeholder:"请输入",min:0,max:999999,precision:2},model:{value:t.row.minCharge,callback:function(i){e.$set(t.row,"minCharge",i)},expression:"scope.row.minCharge"}}):r("span",[e._v(e._s(t.row.minCharge))])],1)]}}])}),r("el-table-column",{attrs:{"min-width":"120",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[(e.isEdit||e.isAdd)&&(5!==t.row.type&&6!==t.row.type||t.row.cellValue)?r("el-input",{attrs:{placeholder:"请输入",maxlength:100,size:"small"},model:{value:t.row.remark,callback:function(i){e.$set(t.row,"remark",i)},expression:"scope.row.remark"}}):r("span",[e._v(e._s(t.row.remark))])]}}])})],1)],1)],1)],1)],1)]),r("el-dialog",{attrs:{title:e.title,visible:e.dialogCompany,"close-on-click-modal":!1,width:"960px"},on:{"update:visible":function(t){e.dialogCompany=t},closed:e.cancelCompany}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.selectLoading,expression:"selectLoading"}]},[r("el-transfer",{ref:"transferItem",staticStyle:{height:"500px"},attrs:{filterable:"","filter-method":e.filterMethod,titles:["选择"+e.title,"已选择"],props:{key:"id",label:"name"},"filter-placeholder":"输入搜索",data:e.companyList},model:{value:e.options,callback:function(t){e.options=t},expression:"options"}}),e.isHistory&&4===e.selectForm.auditing?e._e():r("div",{staticStyle:{"text-align":"right",margin:"20px 40px 0"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogCompany=!1}}},[e._v("\n          取消\n        ")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.saveCompany}},[e._v("\n          保存\n        ")])],1)],1)]),r("agent-price",{ref:"AgentPrice",on:{close:e.closeAgentPrice}}),r("transition",{attrs:{name:"el-fade-in-linear"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.showAgentPriceModel&&e.isRightShow&&"0"===e.custType&&e.$checkPermission(["warehousQuoteQuotation"]),expression:"showAgentPriceModel && isRightShow && custType === '0' && $checkPermission(['warehousQuoteQuotation'])"},{name:"drag",rawName:"v-drag"}],staticClass:"agent-price"},[r("el-tooltip",{attrs:{effect:"dark",content:"供应商报价",placement:"top"}},[r("i",{staticClass:"icon-price",on:{click:e.showAgentPrice}})])],1)]),r("ul",{directives:[{name:"show",rawName:"v-show",value:e.isShowMenu,expression:"isShowMenu"}],staticClass:"contextmenu",style:{left:e.menuLeft+"px",top:e.menuTop+"px"}},[r("li",{directives:[{name:"permission",rawName:"v-permission",value:["warehousQuoteCopy"],expression:"['warehousQuoteCopy']"}],staticClass:"contextmenu-item",on:{click:function(t){return e.onRow(e.showMenuRow,!0)}}},[e._v("\n      复制\n    ")]),r("li",{directives:[{name:"permission",rawName:"v-permission",value:["warehousQuoteGet"],expression:"['warehousQuoteGet']"}],staticClass:"contextmenu-item",on:{click:function(t){return e.onRow(e.showMenuRow)}}},[e._v("\n      查看\n    ")]),1===e.showMenuRow.auditing&&e.$checkPermission(["warehousQuoteDel"])?r("li",{staticClass:"contextmenu-item",on:{click:function(t){return e.deleteRow(2)}}},[e._v("\n      删除\n    ")]):e._e()])],1)},a=[],s=(i("8e6e"),i("ac6a"),i("456d"),i("6762"),i("2fdb"),i("c5f6"),i("a8db")),n=(i("7f7f"),i("7514"),i("bd86")),o=(i("96cf"),i("3b8d")),c=i("d225"),l=i("b0b4"),u=i("308d"),d=i("6bb5"),h=i("4e2b"),p=i("9ab4"),m=i("60a3"),f=i("9dba"),v=i("5b63"),g=i("5a0c"),y=i.n(g),b=i("59c4"),w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("vxe-modal",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"show-zoom":"",resize:"","z-index":1314,"lock-view":!1,mask:!1,"lock-scroll":!1,width:"1100","min-width":"700",height:"500","min-height":"400"},on:{close:e.close},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[i("div",{staticClass:"my-title",attrs:{slot:"title"},on:{click:function(e){return e.stopPropagation(),function(e){return e}(e)}},slot:"title"},[i("span",[e._v("供应商")]),i("el-select",{staticStyle:{width:"200px","margin-left":"10px","margin-right":"20px"},attrs:{clearable:"",filterable:"",size:"mini",placeholder:"请选择"},on:{change:e.selectAgentChange},model:{value:e.form.agent,callback:function(t){e.$set(e.form,"agent",t)},expression:"form.agent"}},e._l(e.agentList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),i("span",[e._v("版本")]),i("el-select",{staticStyle:{width:"240px","margin-left":"10px"},attrs:{clearable:"",filterable:"",disabled:!e.form.agent,size:"mini",placeholder:"请选择"},on:{change:e.showPrice},model:{value:e.form.edition,callback:function(t){e.$set(e.form,"edition",t)},expression:"form.edition"}},e._l(e.editionList,function(t){return i("el-option",{key:t.id,attrs:{label:e.formatTime(t),value:t.id}})}),1)],1),i("div",[e.tableData.length?i("el-table",{ref:"priceTable",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,"span-method":e.tableDataSpanMethod,border:""}},[i("el-table-column",{attrs:{prop:"name",width:"150","show-overflow-tooltip":"",label:"收费项目"}}),i("el-table-column",{attrs:{prop:"type",width:"100",label:"计费方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.formatType(t.row.type))+"\n        ")]}}],null,!1,1295640191)}),i("el-table-column",{attrs:{width:"150",label:"计费配置","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[5===t.row.type||6===t.row.type?i("span",[e._v(e._s(t.row.cellName))]):t.row.min&&t.row.max?i("span",[e._v(e._s(t.row.min+"-"+t.row.max))]):i("span",[e._v("单位单价")])]}}],null,!1,3582323774)}),i("el-table-column",{attrs:{label:"价格"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v("\n            "+e._s(t.row.price)+"\n          ")])]}}],null,!1,1752307612)}),i("el-table-column",{attrs:{label:"最低收费"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",[e._v("\n            "+e._s(t.row.minCharge)+"\n          ")])]}}],null,!1,967402785)}),i("el-table-column",{attrs:{"min-width":"120",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.remark)+"\n        ")]}}],null,!1,3601625951)})],1):e._e()],1)])},k=[],S=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.spanNum1=0,e.spanNum2=0,e.divNum1=0,e.divNum2=0,e.visible=!1,e.isMinimize=!1,e.loading=!1,e.agentList=[],e.agentPriceList=[],e.aAxisData=[],e.tableData=[],e.editionList=[],e.spanArr1=[],e.spanArr2=[],e.divArr1=[],e.divArr2=[],e.settlementList=[{id:0,name:"按重量"},{id:1,name:"按体积"},{id:2,name:"按金额"},{id:3,name:"按票"},{id:4,name:"按箱"},{id:5,name:"按车"},{id:6,name:"按柜"},{id:7,name:"按里程"},{id:8,name:"按时间"},{id:9,name:"按托"},{id:"A",name:"按个数"}],e.selectService={},e.dayjs=y.a,e.form={agent:"",edition:""},e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"formatType",value:function(e){var t=this.settlementList.find(function(t){return t.id===e})||{};return t.name||""}},{key:"tableDataSpanMethod",value:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(0===i){var r=this.spanArr1[t],a=r>0?1:0;return{rowspan:r,colspan:a}}if(1===i){var s=this.spanArr2[t],n=s>0?1:0;return{rowspan:s,colspan:n}}}},{key:"show",value:function(e,t){this.isMinimize||(this.selectService=e,this.aAxisData=[],this.tableData=[],this.agentList=[],this.agentPriceList=[],this.editionList=[],this.form={agent:"",edition:""},this.getAgentPriceList(t)),this.visible=!0}},{key:"getAgentPriceList",value:function(e){var t=this;this.loading=!0,Object(v["d"])(e).then(function(e){t.loading=!1,e.success&&(t.agentPriceList=e.data||[],t.getAgentList())}).catch(function(e){return t.loading=!1,e})}},{key:"getAxis",value:function(e){this.tableData=e.priceList||[],this.getSpanArr(this.tableData)}},{key:"getSpanArr",value:function(e){for(var t=0;t<e.length;t++)0===t?(this.spanArr1.push(1),this.spanNum1=0,this.spanArr2.push(1),this.spanNum2=0):e[t].name===e[t-1].name?(this.spanArr1[this.spanNum1]+=1,this.spanArr1.push(0),e[t].type===e[t-1].type&&(this.spanArr2[this.spanNum2]+=1,this.spanArr2.push(0))):(this.spanArr1.push(1),this.spanNum1=t,this.spanArr2.push(1),this.spanNum2=t)}},{key:"getAgentList",value:function(){var e=this.agentPriceList.map(function(e){return{name:e.fromCustName,id:e.fromCustId}});this.agentList=e.reduce(function(e,t){return e.find(function(e){return e.id===t.id})||e.push(t),e},[])}},{key:"selectAgentChange",value:function(e){this.editionList=this.agentPriceList.filter(function(t){return t.fromCustId===e}),this.form.edition="",this.aAxisData=[],this.tableData=[]}},{key:"showPrice",value:function(e){this.spanArr1=[],this.spanNum1=0,this.spanArr2=[],this.spanNum2=0,this.aAxisData=[],this.tableData=[];var t=this.agentPriceList.find(function(t){return t.id===e});t&&this.getAxis(t)}},{key:"formatTime",value:function(e){var t=(e||{}).startTime,i=(e||{}).endTime;return y()(t).format("YYYY-MM-DD")+"-"+y()(i).format("YYYY-MM-DD")}},{key:"minimize",value:function(){this.isMinimize=!0,this.visible=!1,this.$emit("close")}},{key:"close",value:function(){this.isMinimize=!1,this.visible=!1,this.$emit("close")}}]),t}(m["e"]);S=p["a"]([Object(m["a"])({name:"agentPrice"})],S);var x=S,A=x,L=(i("f651"),i("2877")),F=Object(L["a"])(A,w,k,!1,null,"1e6b18e4",null),C=F.exports;function _(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function T(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_(i,!0).forEach(function(t){Object(n["a"])(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function I(){return{id:void 0,warehouseId:void 0,warehouseName:void 0,refStandard:void 0,auditing:void 0,reason:void 0,refId:void 0,countryId:void 0,toCustSubtype:void 0,toCustType:void 0,umWeight:void 0,umLength:void 0,currencyId:void 0,associatedAgents:[],ifStandard:!0,times:[],country:{}}}var O=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.showMenuRow={},e.isShowMenu=!1,e.menuTop=0,e.menuLeft=0,e.dayjs=y.a,e.searchForm={warehouseId:void 0,auditing:void 0,ifStandard:void 0,times:[]},e.selectForm=I(),e.auditForm={auditing:void 0,reason:void 0},e.auditRules={auditing:[{required:!0,message:"请选择审核状态",trigger:"change"}]},e.formRules={warehouseId:[{required:!0,message:"请选择仓库",trigger:"change"}],toCustSubtype:[{message:"请选择报价对象",trigger:"change"}],refId:[{required:!0,message:"请选择参考报价",trigger:"change"}],ifStandard:[{required:!0,message:"请选择价格标准",trigger:"change"}],times:[{required:!0,message:"请选择有效时间",trigger:"change"}],refStandard:[{required:!0,message:"请选择有效时间",trigger:"change"}]},e.isActive=!0,e.showAgentPriceModel=!0,e.popoverShow=!1,e.selectLoading=!1,e.formLoading=!1,e.cardLoading=!1,e.checkAll=!1,e.isEdit=!1,e.isAdd=!1,e.dialogCompany=!1,e.title="",e.currentId="",e.currentWhId="",e.currentRefId="",e.isTableShow=!1,e.isRightShow=!1,e.isHistory=!1,e.auditShow=!1,e.batchShow=!1,e.batchNum="",e.options=[],e.copyTable=[],e.serviceTypeList=[],e.companyList=[],e.auditList=[{name:"待审核",id:1},{name:"已通过",id:4},{name:"已拒绝",id:3},{name:"审核中",id:2}],e.settlementList=[{id:0,name:"按重量"},{id:1,name:"按体积"},{id:2,name:"按金额"},{id:3,name:"按票"},{id:4,name:"按箱"},{id:5,name:"按车"},{id:6,name:"按柜"},{id:7,name:"按里程"},{id:8,name:"按时间"},{id:9,name:"按托"},{id:"A",name:"按个数"}],e.effectList=[],e.custList=[],e.historyId="",e.historyList=[],e.serviceList1=[],e.serviceList2=[],e.timeList=[],e.tableData=[],e.spanArr1=[],e.spanArr2=[],e.divArr1=[],e.divArr2=[],e.spanNum1=0,e.spanNum2=0,e.divNum1=0,e.divNum2=0,e.cardList=[],e.tableUpper=[],e.page=1,e.size=10,e.total=0,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"onIsShowMenuChange",value:function(e){e?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},{key:"copyPrice",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t="",this.spanArr1=[],this.spanArr2=[],this.spanNum1=0,this.spanNum2=0,!this.historyId){e.next=14;break}return t=this.historyId,this.historyList.map(function(e){i.historyId===e.id&&(i.selectForm.refId=e.refId)}),this.selectForm.warehouseId=this.currentWhId,e.next=11,this.getEffectiveBook();case 11:this.effectList.map(function(e){if(i.selectForm.refId===e.id){var t=e.rows||[];i.tableUpper=t.map(function(e){if(e)return T({},e,{isUpper:!0})})}}),e.next=15;break;case 14:t=this.currentId;case 15:return e.next=17,this.getRowDetail(t,!0);case 17:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"invalidPrice",value:function(){var e=this;this.$confirm("该操作会使此报价及相关代理报价失效，请确认是否操作?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){var t={id:e.currentId},i=e.$loading({lock:!0,text:"",background:"hsla(0,0%,100%,.9)"});Object(v["n"])(t).then(function(){i.close(),e.resetForm(),e.getTableData()}).catch(function(){i.close()})}).catch(function(){return!1})}},{key:"showMenu",value:function(e,t){this.$checkPermission(["warehousQuoteCopy","warehousQuoteGet","warehousQuoteDel"])&&(this.showMenuRow=e,this.menuLeft=t.clientX,this.menuTop=t.clientY,this.isShowMenu=!0)}},{key:"closeMenu",value:function(){this.isShowMenu=!1}},{key:"closeAgentPrice",value:function(){this.showAgentPriceModel=!0}},{key:"showAgentPrice",value:function(){var e=this;if(this.selectForm.warehouseId){var t=this.$refs.AgentPrice,i=this.selectForm,r=i.country,a=i.fromCustSubtype,s=i.currencyId,n=i.fromCustType,o=i.toCustSubtype,c=i.toCustType,l=i.umLength,u=i.umWeight,d=i.warehouseId,h=i.ifStandard,p={country:r,fromCustSubtype:a,currencyId:s,fromCustType:n,toCustSubtype:o,toCustType:c,umLength:l,umWeight:u,warehouseId:d,ifStandard:h},m=this.serviceList2.find(function(t){return t.id===e.selectForm.warehouseId});m?(t.show(m,p),this.showAgentPriceModel=!1):this.$message.warning("请选择仓库")}else this.$message.warning("请选择仓库")}},{key:"formatTime",value:function(e){var t=(e||{}).startTime,i=(e||{}).endTime;return t&&i?y()(t).format("YYYY-MM-DD")+"-"+y()(i).format("YYYY-MM-DD"):""}},{key:"formatType",value:function(e){var t=this.settlementList.find(function(t){return t.id===e})||{};return t.name||""}},{key:"toggle",value:function(){this.isActive=!this.isActive}},{key:"handleClear",value:function(){this.searchForm.times=[]}},{key:"handleConfirm",value:function(e){this.popoverShow=!1,this.getTableData()}},{key:"getTableData",value:function(){var e=this;this.cardLoading=!0;var t=this.searchForm,i=t.times,r=Object(s["a"])(t,["times"]),a={model:T({},r,{startTime:Array.isArray(i)&&i.length>0?i[0]:void 0,endTime:Array.isArray(i)&&i.length>0?i[1]:void 0}),page:this.page,size:this.size};Object(v["h"])(a).then(function(t){var i=t.data||{};e.cardList=i.result||[],e.total=i.total,e.resetForm(),e.cardLoading=!1}).catch(function(t){return e.cardLoading=!1,t})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.getTableData()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.getTableData()}},{key:"getSpanArr",value:function(e){for(var t=0;t<e.length;t++)0===t?(this.spanArr1.push(1),this.spanNum1=0,this.spanArr2.push(1),this.spanNum2=0):e[t].name===e[t-1].name?(this.spanArr1[this.spanNum1]+=1,this.spanArr1.push(0),e[t].type===e[t-1].type&&(this.spanArr2[this.spanNum2]+=1,this.spanArr2.push(0))):(this.spanArr1.push(1),this.spanNum1=t,this.spanArr2.push(1),this.spanNum2=t)}},{key:"getDivArr",value:function(e){for(var t=0;t<e.length;t++)0===t?(this.divArr1.push(1),this.divNum1=0,this.divArr2.push(1),this.divNum2=0):e[t].name===e[t-1].name?(this.divArr1[this.divNum1]+=1,this.divArr1.push(0),e[t].type===e[t-1].type&&(this.divArr2[this.divNum2]+=1,this.divArr2.push(0))):(this.divArr1.push(1),this.divNum1=t,this.divArr2.push(1),this.divNum2=t)}},{key:"tableDataSpanMethod",value:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(0===i){var r=this.spanArr1[t],a=r>0?1:0;return{rowspan:r,colspan:a}}if(1===i){var s=this.spanArr2[t],n=s>0?1:0;return{rowspan:s,colspan:n}}}},{key:"tableUpperSpanMethod",value:function(e){e.row,e.column;var t=e.rowIndex,i=e.columnIndex;if(0===i){var r=this.divArr1[t],a=r>0?1:0;return{rowspan:r,colspan:a}}if(1===i){var s=this.divArr2[t],n=s>0?1:0;return{rowspan:s,colspan:n}}}},{key:"onRow",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,i){var r,a,s,n,o,c=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.$checkPermission(["warehousQuoteCopy","warehousQuoteGet"])){e.next=2;break}return e.abrupt("return");case 2:if(!this.formLoading){e.next=4;break}return e.abrupt("return");case 4:return this.resetForm(),this.isRightShow=!0,this.currentId=t.id,this.currentWhId=t.warehouseId,this.currentRefId=t.refId,this.selectForm.warehouseId=t.warehouseId,this.selectForm.refId=t.refId,this.formLoading=!0,e.next=14,this.getEffectiveBook();case 14:if(r=this.effectList.find(function(e){return c.selectForm.refId===e.id}),!r){e.next=21;break}a=r.priceList||[],this.tableUpper=a,this.getDivArr(this.tableUpper),e.next=29;break;case 21:if(!t.refId){e.next=29;break}return e.next=24,Object(v["f"])({id:t.refId});case 24:s=e.sent,n=s.data||{},o=n.priceList||[],this.tableUpper=o,this.getDivArr(this.tableUpper);case 29:return e.next=31,this.getRowDetail(this.currentId,i);case 31:case"end":return e.stop()}},e,this)}));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"getRowDetail",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,i){var r,a,n,o,c,l,u,d,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.formLoading=!0,e.prev=1,e.next=4,Object(v["f"])({id:t});case 4:r=e.sent,a=r.data||{},n=a.priceList,o=a.refId,c=a.endTime,l=a.startTime,u=Object(s["a"])(a,["priceList","refId","endTime","startTime"]),this.selectForm=T({},u,{refId:o}),l&&c&&!i&&(d=y()(l).format("YYYY-MM-DD"),h=y()(c).format("YYYY-MM-DD"),this.$set(this.selectForm,"times",[d,h])),this.tableData=n.map(function(e){return e.price=e.price||void 0,e.minCharge=e.minCharge||void 0,e}),this.copyTable=JSON.parse(JSON.stringify(this.tableData)),this.getSpanArr(this.tableData),this.getServiceList("sel"),this.getTimeList(),i?(this.selectForm.auditing=void 0,this.selectForm.id=void 0,this.selectForm.status=void 0,this.selectForm.refId=void 0,this.isAdd=!0,this.isEdit=!1,this.currentId="",this.historyId="",this.isHistory=!1,this.tableUpper=[],this.getDivArr(this.tableUpper)):(this.isAdd=!1,this.isEdit=!1),this.isTableShow=!0,this.formLoading=!1,this.serviceTypeList=a.serviceTypeList,"0"!==this.custType||this.showAgentPriceModel||this.showAgentPrice(),this.selectForm.ifStandard||this.getCustTypeList(),e.next=26;break;case 22:return e.prev=22,e.t0=e["catch"](1),this.formLoading=!1,e.abrupt("return",e.t0);case 26:case"end":return e.stop()}},e,this,[[1,22]])}));function t(t,i){return e.apply(this,arguments)}return t}()},{key:"addPrice",value:function(){this.resetForm(),this.isRightShow=!0,this.isAdd=!0}},{key:"editRow",value:function(){this.isEdit=!0}},{key:"onShow",value:function(){this.auditingRow();var e=this.selectForm,t=(e.auditing,e.reason);this.auditForm={auditing:4,reason:t}}},{key:"onHide",value:function(){this.auditForm={auditing:void 0,reason:void 0};var e=this.$refs.auditForm;this.$nextTick(function(){e.clearValidate()})}},{key:"onOpen",value:function(){this.batchNum=void 0}},{key:"onClose",value:function(){this.batchNum=void 0}},{key:"batchConfirm",value:function(e){var t=this;this.batchShow=!1,this.tableData=this.tableData.map(function(i,r){var a=t.tableUpper[r];return 1===e&&a&&a.price?i.price=parseFloat((a.price+t.batchNum).toFixed(2)):i.price=void 0,i})}},{key:"auditingRow",value:function(){var e=this,t=this.selectForm.auditing;if(1===t){var i={id:this.currentId,tag:2,reason:""};Object(v["b"])(i).then(function(t){e.cardList.map(function(t){t.id===e.currentId&&(t.auditing=2,e.selectForm.auditing=2)})}).catch(function(e){return e})}}},{key:"auditRow",value:function(){var e=this;this.formLoading=!0;var t={tag:this.auditForm.auditing,id:this.currentId,reason:this.auditForm.reason};Object(v["b"])(t).then(function(t){e.auditShow=!1,e.getTableData(),e.resetForm(),e.formLoading=!1;var i=e.$refs.AgentPrice;i.close()}).catch(function(t){return e.formLoading=!1,t})}},{key:"cancelRow",value:function(){if(this.isEdit=!1,this.isAdd){this.resetForm();var e=this.$refs.AgentPrice;e.close()}}},{key:"deleteRow",value:function(e){var t=this,i={id:1===e?this.currentId:this.showMenuRow.id};this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){Object(v["c"])(i).then(function(e){t.$message({type:"success",message:"删除成功"}),t.resetForm(),t.getTableData();var i=t.$refs.AgentPrice;i.close()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"saveRow",value:function(){var e=this,t=this.$refs.editForm;t.validate(function(t){if(!t)return!1;if(e.tableData.length<=0)e.$message.error("暂未配置，无法报价");else{var i=e.tableData.every(function(e){return!e.price});if(i)e.$message.error("请至少填写一条报价");else{var r=e.selectForm,a=r.times,n=r.refId,o=r.ifStandard,c=r.toCustSubtype,l=r.refStandard,u=r.associatedAgents,d=Object(s["a"])(r,["times","refId","ifStandard","toCustSubtype","refStandard","associatedAgents"]);if(!o&&Array.isArray(u)&&u.length<=0)e.$message.error("请选择关联代理商");else{var h=T({},d,{ifStandard:o,refStandard:l,toCustSubtype:c,refId:n||e.custId,associatedAgents:u,serviceTypeList:e.serviceTypeList,priceList:e.tableData});o?(h.startTime=Array.isArray(a)&&a.length>0?y()(a[0]).format("YYYY-MM-DD")+" 00:00:00":void 0,h.endTime=Array.isArray(a)&&a.length>0?y()(a[1]).format("YYYY-MM-DD")+" 23:59:59":void 0):e.timeList.map(function(e){l===e.id&&(h.startTime=e.startTime,h.endTime=e.endTime)});var p=e.custType;"0"===p?h.toCustType="2":"2"===p?h.toCustType="2"===c?"2":"1":"3"===p&&("-1"===e.selectForm.toCustSubtype?h.toCustType="0":h.toCustType="1"),e.formLoading=!0,e.isEdit?Object(v["o"])(h).then(function(t){e.$message({type:"success",message:"保存成功"}),e.resetForm(),e.formLoading=!1,e.getTableData();var i=e.$refs.AgentPrice;i.close()}).catch(function(t){return e.formLoading=!1,t}):Object(v["a"])(h).then(function(t){e.$message({type:"success",message:"新增成功"}),e.resetForm(),e.formLoading=!1,e.getTableData();var i=e.$refs.AgentPrice;i.close()}).catch(function(t){return e.formLoading=!1,t})}}}})}},{key:"resetForm",value:function(){var e=this;this.selectForm=I(),this.getCustId(),this.currentId="",this.currentWhId="",this.currentRefId="",this.historyId="",this.isHistory=!1,this.isTableShow=!1,this.isRightShow=!1,this.isAdd=!1,this.isEdit=!1,this.spanArr1=[],this.spanArr2=[],this.divArr1=[],this.divArr2=[],this.spanNum1=0,this.spanNum2=0,this.divNum1=0,this.divNum2=0,this.tableData=[],this.copyTable=[],this.options=[],this.$nextTick(function(){var t=e.$refs.editForm,i=e.$refs.priceTable;t.clearValidate(),i.doLayout()})}},{key:"getServiceList",value:function(e){var t=this;this.selectLoading=!0,Object(v["l"])().then(function(i){var r=i.data||[];if("sea"===e)t.serviceList1=r;else{var a=r.filter(function(e){return"1"===e.status});t.serviceList2=a||[]}t.selectLoading=!1}).catch(function(e){return t.selectLoading=!1,e})}},{key:"onService",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.selectForm.warehouseName=void 0,this.selectForm.umLength=void 0,this.selectForm.umWeight=void 0,this.selectForm.refId=void 0,this.selectForm.country={},this.effectList=[],this.tableUpper=[],this.isTableShow=!1,this.tableData=[],this.copyTable=[],this.spanArr1=[],this.spanArr2=[],this.divArr1=[],this.divArr2=[],this.spanNum1=0,this.spanNum2=0,this.divNum1=0,this.divNum2=0,this.serviceList2.map(function(e){e.id===t.selectForm.warehouseId&&(t.selectForm.warehouseName=e.name,t.getWarehouseData())}),e.next=21,this.getPriceConfig();case 21:"0"!==this.custType||this.showAgentPriceModel||this.showAgentPrice();case 22:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getWarehouseData",value:function(){var e=this;Object(v["k"])({id:this.selectForm.warehouseId}).then(function(t){var i=t.data||{},r=i.unitOfLength,a=i.unitOfWeight,s=i.currencyId,n=i.cityId,o=i.cityName,c=i.countryId,l=i.countryName,u=i.stateId,d=i.stateName,h=i.countyId,p=i.countyName;e.selectForm.umLength=r,e.selectForm.umWeight=a,e.selectForm.currencyId=s,e.selectForm.country={cityId:n,cityName:o,countryId:c,countryName:l,stateId:u,stateName:d,countyId:h,countyName:p}}).catch(function(e){return e})}},{key:"onEffect",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.divArr1=[],this.divArr2=[],this.divNum1=0,this.divNum2=0,this.selectForm.refId?this.effectList.map(function(e){if(t.selectForm.refId===e.id){var i=e.priceList||[];t.tableUpper=i,t.getDivArr(t.tableUpper)}}):this.tableUpper=[];case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getEffectiveBook",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,i,r,a,s,n,o,c,l,u,d,h,p,m;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.selectForm.warehouseId||!this.parentId){e.next=21;break}return this.selectLoading=!0,t=this.selectForm,t.country,i=t.fromCustSubtype,r=t.currencyId,a=t.fromCustType,s=t.toCustSubtype,n=t.toCustType,o=t.umLength,c=t.umWeight,l=t.warehouseId,u=t.ifStandard,d={fromCustSubtype:i,currencyId:r,fromCustType:a,toCustSubtype:s,toCustType:n,umLength:o,umWeight:c,warehouseId:l,ifStandard:u},h=this.custType,"0"===h?d.toCustType="2":"2"===h?d.toCustType="2"===s?"2":"1":"3"===h&&("-1"===this.selectForm.toCustSubtype?d.toCustType="0":d.toCustType="1"),e.prev=6,e.next=9,Object(v["d"])(d);case 9:p=e.sent,m=p.data||[],this.effectList=m,this.selectLoading=!1,e.next=19;break;case 15:return e.prev=15,e.t0=e["catch"](6),this.selectLoading=!1,e.abrupt("return",e.t0);case 19:e.next=22;break;case 21:this.effectList=[];case 22:case"end":return e.stop()}},e,this,[[6,15]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"getPriceConfig",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,i,r,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectForm.warehouseId){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,this.formLoading=!0,e.next=6,Object(v["m"])({id:this.selectForm.warehouseId});case 6:return t=e.sent,i=t.data||[],this.serviceTypeList=i,e.next=11,Object(v["g"])({serviceTypeId:"04",warehouseId:this.selectForm.warehouseId,list:i.length<=0?[""]:i});case 11:r=e.sent,a=r.data||[],this.tableData=a.map(function(e){var t=e.id,i=Object(s["a"])(e,["id"]);return T({},i,{cid:t,price:void 0})}),this.copyTable=JSON.parse(JSON.stringify(this.tableData)),this.getSpanArr(this.tableData),this.isTableShow=!0,this.formLoading=!1,e.next=24;break;case 20:return e.prev=20,e.t0=e["catch"](2),this.formLoading=!1,e.abrupt("return",e.t0);case 24:case"end":return e.stop()}},e,this,[[2,20]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"getTimeList",value:function(){var e=this;this.selectLoading=!0;var t=this.selectForm,i=t.country,r=t.fromCustSubtype,a=t.currencyId,s=t.fromCustType,n=t.toCustSubtype,o=t.toCustType,c=t.umLength,l=t.umWeight,u=t.warehouseId,d={country:i,fromCustSubtype:r,currencyId:a,fromCustType:s,toCustSubtype:n,toCustType:o,umLength:c,umWeight:l,warehouseId:u,ifStandard:!0},h=this.custType;"0"===h?d.toCustType="2":"2"===h?d.toCustType="2"===n?"2":"1":"3"===h&&("-1"===this.selectForm.toCustSubtype?d.toCustType="0":d.toCustType="1"),Object(v["i"])(d).then(function(t){var i=t.data||[];e.timeList=i,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onHistory",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.spanArr1=[],this.spanArr2=[],this.spanNum1=0,this.spanNum2=0,t="",this.historyId?(t=this.historyId,this.isHistory=!0,this.historyList.map(function(e){i.historyId===e.id&&(i.selectForm.refId=e.refId)})):(this.selectForm.refId=this.currentRefId,t=this.currentId,this.isHistory=!1),this.selectForm.warehouseId=this.currentWhId,e.next=9,this.getEffectiveBook();case 9:return this.effectList.map(function(e){if(i.selectForm.refId===e.id){var t=e.priceList||[];i.tableUpper=t,i.getDivArr(i.tableUpper)}}),e.next=12,this.getRowDetail(t);case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getHistoryPrice",value:function(){var e=this;this.selectLoading=!0;var t={id:this.currentId};Object(v["e"])(t).then(function(t){var i=t.data||[];e.historyList=i,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onMode",value:function(){"0"===this.selectForm.mode&&(this.selectForm.associatedAgents=[]),this.selectForm.refStandard=void 0,this.selectForm.times=[]}},{key:"onCompany",value:function(){!["2","3"].includes(this.custType)||this.selectForm.toCustSubtype?(this.dialogCompany=!0,this.options=this.selectForm.associatedAgents,this.getCustTypeList()):this.$message.warning("请选择报价对象")}},{key:"cancelCompany",value:function(){this.dialogCompany=!1}},{key:"saveCompany",value:function(){this.dialogCompany=!1,this.selectForm.associatedAgents=this.options}},{key:"getCustTypeList",value:function(){var e=this,t="",i="",r=this.selectForm.toCustSubtype;if("3"===this.custType)if("0"===r)t="1",i="0";else{if("1"!==r)return void(t="0");t="1",i="1"}"0"===this.custType&&(t="2",i="1"),"2"===this.custType&&("2"===r?(t="2",i="2"):(t="1",i=r));var a={toCustSubtype:i,toCustType:t,subtypeId:this.serviceTypeList.join(","),typeId:"04"},s=this.custType;this.title="0"===s?"关联代理商":"2"===s&&"2"===r?"关联代理商":"关联客户",this.selectLoading=!0,Object(b["j"])(a).then(function(t){var i=t.data||[],r=i.filter(function(e){return e}).map(function(e){return e.name=e.name||e.id,e});1===e.selectForm.auditing&&r.map(function(t,i){e.options.map(function(e){e===t.id&&(r[i].disabled=!0)})}),e.companyList=r,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"filterMethod",value:function(e,t){var i=t.name||"";return i.indexOf(e)>-1}},{key:"onType",value:function(){this.selectForm.associatedAgents=[],this.companyList=[]}},{key:"getCustId",value:function(){var e=this.custType,t=this.custSubtype;switch(e){case"0":this.selectForm.toCustSubtype="1";break;case"2":"1"===t?this.custList=[{name:"二级代理商",id:"2"},{name:"直客",id:"0"},{name:"同行",id:"1"}]:"2"===t&&(this.custList=[{name:"直客",id:"0"},{name:"同行",id:"1"}]);break;case"3":this.selectForm.toCustSubtype="",this.custList=[{name:"聚货通",id:"-1"},{name:"直客",id:"0"},{name:"同行",id:"1"}];break;default:break}}},{key:"created",value:function(){this.custType,this.custSubtype;this.getCustId(),this.getTableData()}},{key:"custId",get:function(){var e=f["a"].info||{},t=e.custId;return t}},{key:"parentId",get:function(){var e=f["a"].info||{},t=e.parentId;return t}},{key:"custName",get:function(){var e=f["a"].info||{},t=e.custName;return t}},{key:"custType",get:function(){var e=f["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=f["a"].info||{},t=e.custSubtype;return t}},{key:"pickerOptions",get:function(){return{disabledDate:function(e){return e.getTime()<=Date.now()}}}},{key:"isLabelValue",get:function(){var e,t=this.custType,i=this.selectForm;return e="0"===t?"关联代理商":"2"===t&&"2"===i.toCustSubtype?"关联代理商":"关联客户",e}}]),t}(m["e"]);p["a"]([Object(m["f"])("isShowMenu")],O.prototype,"onIsShowMenuChange",null),O=p["a"]([Object(m["a"])({name:"",components:{AgentPrice:C},props:{}})],O);var j=O,D=j,N=(i("8cd8"),Object(L["a"])(D,r,a,!1,null,"12a9b9c8",null));t["default"]=N.exports},"1e9b":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAGRJREFUGJXF0LEJgFAQA9Ccdm7yCxewdBixdBMb4W/iKsmfRfGshN+c2Hld4JHAAcFJGkn2T24DlAGcKaU9KoKkLGkOwSfk7k0pZSM5RaYBADO73P0ws+51sppeJS0/Y5JD/fAbvDw8mbaIFiYAAAAASUVORK5CYII="},2748:function(e,t,i){},"59c4":function(e,t,i){"use strict";i.d(t,"i",function(){return a}),i.d(t,"o",function(){return s}),i.d(t,"h",function(){return n}),i.d(t,"n",function(){return o}),i.d(t,"e",function(){return c}),i.d(t,"j",function(){return l}),i.d(t,"g",function(){return u}),i.d(t,"f",function(){return d}),i.d(t,"m",function(){return h}),i.d(t,"p",function(){return p}),i.d(t,"a",function(){return m}),i.d(t,"d",function(){return f}),i.d(t,"c",function(){return v}),i.d(t,"s",function(){return g}),i.d(t,"r",function(){return y}),i.d(t,"b",function(){return b}),i.d(t,"l",function(){return w}),i.d(t,"k",function(){return k}),i.d(t,"q",function(){return S});var r=i("b32d");function a(){var e={url:"/setting/area/getCountryList",method:"get"};return Object(r["a"])(e)}function s(e){var t={url:"/setting/area/getStateByCountry",method:"get",params:{countryId:e}};return Object(r["a"])(t)}function n(e){var t={url:"/setting/area/getCityByState",method:"get",params:{stateId:e}};return Object(r["a"])(t)}function o(e){var t={url:"/cfg/type/getServiceSubtypeList",method:"get",params:e};return Object(r["a"])(t)}function c(e){var t={url:"/setting/currency/getCurrencyList",method:"get",params:e};return Object(r["a"])(t)}function l(e){var t={url:"/auth/custtype/queryAgents",method:"post",data:e};return Object(r["a"])(t)}function u(e){var t={url:"/cfg/ksc/getKscList",method:"post",data:e};return Object(r["a"])(t)}function d(e){var t={url:"/cfg/ksc/axis",method:"post",params:e};return Object(r["a"])(t)}function h(e){var t={url:"/price/truck/page",method:"post",data:e};return Object(r["a"])(t)}function p(e){var t={url:"/price/truck/page1",method:"post",data:e};return Object(r["a"])(t)}function m(e){var t={url:"/price/truck/add",method:"post",data:e};return Object(r["a"])(t)}function f(e){var t={url:"/price/truck/update",method:"post",data:e};return Object(r["a"])(t)}function v(e){var t={url:"/price/truck/del",method:"delete",params:e};return Object(r["a"])(t)}function g(e){var t={url:"/price/truck/superior",method:"post",data:e};return Object(r["a"])(t)}function y(e){var t={url:"/price/truck/refStandard",method:"post",data:e};return Object(r["a"])(t)}function b(e){var t={url:"/price/truck/review",method:"post",data:e};return Object(r["a"])(t)}function w(e){var t={url:"/price/truck/history",method:"get",params:e};return Object(r["a"])(t)}function k(e){var t={url:"/price/truck/history/get",method:"get",params:e};return Object(r["a"])(t)}function S(e){var t={url:"/price/truck/doExpire",method:"get",params:e};return Object(r["a"])(t)}},"5b63":function(e,t,i){"use strict";i.d(t,"l",function(){return a}),i.d(t,"h",function(){return s}),i.d(t,"j",function(){return n}),i.d(t,"f",function(){return o}),i.d(t,"d",function(){return c}),i.d(t,"e",function(){return l}),i.d(t,"a",function(){return u}),i.d(t,"o",function(){return d}),i.d(t,"c",function(){return h}),i.d(t,"b",function(){return p}),i.d(t,"m",function(){return m}),i.d(t,"k",function(){return f}),i.d(t,"g",function(){return v}),i.d(t,"i",function(){return g}),i.d(t,"n",function(){return y});var r=i("b32d");function a(){var e={url:"/wms/warehouse/c",method:"get"};return Object(r["a"])(e)}function s(e){var t={url:"/price/warehouse/page",method:"post",data:e};return Object(r["a"])(t)}function n(e){var t={url:"/price/warehouse/page1",method:"post",data:e};return Object(r["a"])(t)}function o(e){var t={url:"/price/warehouse/history/get",method:"get",params:e};return Object(r["a"])(t)}function c(e){var t={url:"/price/warehouse/superior",method:"post",data:e};return Object(r["a"])(t)}function l(e){var t={url:"/price/warehouse/history",method:"get",params:e};return Object(r["a"])(t)}function u(e){var t={url:"/price/warehouse/add",method:"post",data:e};return Object(r["a"])(t)}function d(e){var t={url:"/price/warehouse/update",method:"post",data:e};return Object(r["a"])(t)}function h(e){var t={url:"/price/warehouse/del",method:"delete",params:e};return Object(r["a"])(t)}function p(e){var t={url:"/price/warehouse/review",method:"post",data:e};return Object(r["a"])(t)}function m(e){var t={url:"/wms/warehouse/server/cat",method:"get",params:e};return Object(r["a"])(t)}function f(e){var t={url:"/wms/warehouse/getWarehouse",method:"get",params:e};return Object(r["a"])(t)}function v(e){var t={url:"/finance/r/axis",method:"post",data:e};return Object(r["a"])(t)}function g(e){var t={url:"/price/warehouse/refStandard",method:"post",data:e};return Object(r["a"])(t)}function y(e){var t={url:"/price/warehouse/doExpire",method:"get",params:e};return Object(r["a"])(t)}},"8cd8":function(e,t,i){"use strict";var r=i("2748"),a=i.n(r);a.a},cbf4:function(e,t,i){},f651:function(e,t,i){"use strict";var r=i("cbf4"),a=i.n(r);a.a}}]);