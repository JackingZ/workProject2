(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["operating-cost-project-groups"],{"7b9a":function(e,t,i){},c351:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[i("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[i("div",{staticClass:"app-container"},[i("head-info",{attrs:{info:"",title:"成本项目组"}}),i("div",{staticClass:"app-panel"},[i("div",[i("el-row",[i("el-col",{attrs:{span:6}},[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["wAdd"],expression:"['wAdd']"}],staticStyle:{"margin-left":"10px"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.saveCostgroupData}},[e._v("\n                新增项目组\n              ")])],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 313px)",border:""}},[i("el-table-column",{attrs:{label:"成本项目组名称","min-width":"280",prop:"name"}}),i("el-table-column",{attrs:{label:"类型",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.findByKeyValueReturnAnotherKeyValue(t.row.type))+"\n              ")]}}])}),i("el-table-column",{attrs:{label:"成本项目",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.showProjects(t.row.id)}}},[e._v("\n                  成本项目\n                ")])]}}])}),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["wEdit"],expression:"['wEdit']"}],attrs:{type:"text"},on:{click:function(i){return e.toEditForm(t.row)}}},[e._v("\n                  编辑\n                ")]),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["wDel"],expression:"['wDel']"}],attrs:{type:"text"},on:{click:function(i){return e.deleteData(t.row)}}},[e._v("\n                  删除\n                ")])]}}])})],1),i("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.queryAll}}),i("el-dialog",{attrs:{title:e.isEdit?"编辑项目组":"新增项目组",visible:e.isAddEditVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.isAddEditVisible=t},close:e.cancel}},[i("div",{staticClass:"add-edit-express"},[i("el-form",{ref:"editForm",staticStyle:{"padding-right":"20px"},attrs:{model:e.selectForm,rules:e.formRules,size:"small","label-width":"110px","label-position":"right"}},[i("el-form-item",{attrs:{label:"项目组名称",prop:"name"}},[i("el-input",{attrs:{maxlength:20,placeholder:"请输入"},model:{value:e.selectForm.name,callback:function(t){e.$set(e.selectForm,"name",t)},expression:"selectForm.name"}})],1),i("el-form-item",{attrs:{label:"类型",prop:"type"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.selectForm.type,callback:function(t){e.$set(e.selectForm,"type",t)},expression:"selectForm.type"}},e._l(e.typeList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{attrs:{maxlength:100,placeholder:"请输入"},model:{value:e.selectForm.remark,callback:function(t){e.$set(e.selectForm,"remark",t)},expression:"selectForm.remark"}})],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("\n                取 消\n              ")]),i("el-button",{attrs:{type:"primary"},on:{click:e.saveConfirm}},[e._v("\n                确 定\n              ")])],1)]),i("el-dialog",{attrs:{title:"关联成本项目",visible:e.isItemDialogShow,"close-on-click-modal":!1,width:"960px"},on:{"update:visible":function(t){e.isItemDialogShow=t},close:e.itemDialogClose}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isItemLoading,expression:"isItemLoading"}]},[i("div",[i("el-select",{staticStyle:{width:"130px",margin:"0px 0px 10px 43px"},attrs:{loading:e.selectLoading,filterable:"",placeholder:"请选择",size:"small"},on:{change:e.onServiceType},model:{value:e.serviceType,callback:function(t){e.serviceType=t},expression:"serviceType"}},e._l(e.serviceList,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),i("el-transfer",{ref:"transferItem",staticStyle:{height:"500px"},attrs:{filterable:"","filter-method":e.filterMethod,titles:["成本项目组","已选择"],props:{key:"id",label:"name"},"filter-placeholder":"输入搜索",data:e.itemData},model:{value:e.itemValue,callback:function(t){e.itemValue=t},expression:"itemValue"}}),i("div",{staticStyle:{"text-align":"right",margin:"0 40px 0"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:e.itemDialogClose}},[e._v("\n                  取 消\n                ")]),i("el-button",{attrs:{disabled:!e.$checkPermission(["wProjects"]),type:"primary",size:"small"},on:{click:e.saveItem}},[e._v("\n                  确 定\n                ")])],1)],1)])],1)])],1)])])},a=[],n=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),s=(i("7514"),i("96cf"),i("3b8d")),o=(i("7f7f"),i("d225")),l=i("b0b4"),c=i("308d"),u=i("6bb5"),d=i("4e2b"),m=i("9ab4"),p=i("60a3"),f=i("ac1a"),h=i("b32d");function v(e){var t={url:"/finance/costgroup/getCostgroupList",method:"get",params:e};return Object(h["a"])(t)}function g(e){var t={url:"/finance/costgroup/saveCostgroup",method:"post",data:e};return Object(h["a"])(t)}function y(e){var t={url:"/finance/costgroup/saveCostmember",method:"post",data:e};return Object(h["a"])(t)}function b(e){var t={url:"/finance/costgroup/deleteCostgroup",method:"delete",params:e};return Object(h["a"])(t)}function w(e){var t={url:"/finance/costgroup/getCostmemberList",method:"get",params:e};return Object(h["a"])(t)}function k(e){var t={url:"/finance/costitem/getCostitemList",method:"get",params:e};return Object(h["a"])(t)}function x(e){var t={url:"/cfg/type/getServiceTypeList",method:"get",params:e};return Object(h["a"])(t)}function O(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function I(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?O(i,!0).forEach(function(t){Object(n["a"])(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):O(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var L=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.loading=!1,e.isItemLoading=!1,e.tableData=[],e.isEdit=!1,e.isAddEditVisible=!1,e.isItemDialogShow=!1,e.itemData=[],e.itemValue=[],e.itemJson=[],e.selectLoading=!1,e.serviceType="",e.serviceList=[],e.typeList=[{id:"0",name:"普通组"},{id:"1",name:"计费生成的发票费用组"},{id:"2",name:"订舱成本费用组"},{id:"3",name:"国内出口杂费组"},{id:"4",name:"国外目的港清关费"}],e.currentId="",e.ruleForm={},e.selectForm={name:void 0,type:void 0,remark:void 0},e.formRules={name:[{required:!0,message:"项目中文名称不能为空",trigger:"blur"}],type:[{required:!0,message:"类型不能为空",trigger:"change"}]},e.page=1,e.size=10,e.total=0,e.currentCostId="",e}return Object(d["a"])(t,e),Object(l["a"])(t,[{key:"filterMethod",value:function(e,t){var i=t.name||"";return i.indexOf(e)>-1}},{key:"queryAll",value:function(){var e=this;this.loading=!0;var t={page:this.page,size:this.size};v(t).then(function(t){e.loading=!1;var i=t.data||{};e.tableData=i.result||[],e.total=i.total}).catch(function(t){return e.loading=!1,t})}},{key:"getCostmemberList",value:function(e){var t=this;this.isItemLoading=!0,w({costgroupId:e}).then(function(e){t.isItemLoading=!1;var i=e.data||[];t.itemValue=i.map(function(e){return e.costitemId}),t.itemJson=JSON.parse(JSON.stringify(t.itemValue))}).catch(function(e){return t.isItemLoading=!1,e})}},{key:"getServiceTypeList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isItemLoading=!0,t="1",i={custType:t},e.prev=3,e.next=6,x(i);case 6:return r=e.sent,this.serviceList=r.data||[],this.serviceType=(this.serviceList[0]||{}).id,e.next=11,this.getCostList();case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e["catch"](3),this.isItemLoading=!1,e.abrupt("return",e.t0);case 17:case"end":return e.stop()}},e,this,[[3,13]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"onServiceType",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.itemValue=JSON.parse(JSON.stringify(this.itemJson)),e.next=3,this.getCostList();case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getCostList",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isItemLoading=!0,t={serviceTypeId:this.serviceType,page:1,size:9999},e.next=4,k(t).then(function(e){var t=e.data||{};i.itemData=t.result||[],i.isItemLoading=!1}).catch(function(e){return i.isItemLoading=!1,e});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"findByKeyValueReturnAnotherKeyValue",value:function(e){var t=this.typeList,i=t.find(function(t){return parseInt(t.id,10)===parseInt(e,10)})||{};return i.name}},{key:"saveCostgroupData",value:function(){this.isEdit=!1,this.isAddEditVisible=!0}},{key:"toEditForm",value:function(e){this.currentId=e.id;var t=e.name,i=e.type,r=e.remark;this.selectForm={name:t,type:i,remark:r},this.isEdit=!0,this.isAddEditVisible=!0}},{key:"deleteData",value:function(e){var t=this,i={id:e.id};this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){b(i).then(function(e){t.$message({type:"success",message:"删除成功"}),t.queryAll()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"cancel",value:function(){this.isAddEditVisible=!1,this.resetForm(),this.clearValidate()}},{key:"itemDialogClose",value:function(){this.isItemDialogShow=!1;var e=this.$refs.transferItem;e.clearQuery("left"),e.clearQuery("right"),this.itemData=[],this.itemValue=[]}},{key:"saveConfirm",value:function(){var e=this,t=this.$refs.editForm;t.validate(function(t){if(!t)return!1;var i=I({},e.selectForm);e.isEdit&&(i.id=e.currentId),g(i).then(function(t){e.$message({type:"success",message:"操作成功"}),e.isAddEditVisible=!1,e.resetForm(),e.queryAll()}).catch(function(e){return e})})}},{key:"saveItem",value:function(){var e=this;this.isItemLoading=!0,y({costgroupId:this.currentCostId,costmembers:this.itemValue.map(function(e){return{costitemId:e}})}).then(function(t){e.currentCostId="",e.itemDialogClose(),e.isItemLoading=!1}).catch(function(t){return e.isItemLoading=!1,t})}},{key:"resetForm",value:function(){this.selectForm={name:void 0,type:void 0,remark:void 0}}},{key:"clearValidate",value:function(){var e=this.$refs.editForm;this.$nextTick(function(){e.clearValidate()})}},{key:"showProjects",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.isItemDialogShow=!0,this.currentCostId=t,e.next=4,this.getServiceTypeList();case 4:this.getCostmemberList(t);case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){this.queryAll()}},{key:"labelPosition",get:function(){var e=f["a"].language;return e&&"en"===e?"top":"left"}},{key:"lang",get:function(){var e=f["a"].language;return e||"en"}}]),t}(p["e"]);L=m["a"]([Object(p["a"])({name:"ProjectGroupsCost",components:{},props:{}})],L);var j=L,C=j,S=(i("f48f"),i("2877")),D=Object(S["a"])(C,r,a,!1,null,"484dc396",null);t["default"]=D.exports},f48f:function(e,t,i){"use strict";var r=i("7b9a"),a=i.n(r);a.a}}]);