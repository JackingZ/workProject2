(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["service-genara"],{"0fb9":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{staticClass:"app-container"},[a("head-info",{attrs:{info:"",title:"服务大类"}}),a("div",{staticClass:"app-panel"},[a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["categoryAdd"],expression:"['categoryAdd']"}],staticStyle:{float:"left"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addType}},[e._v("\n              新增服务大类\n            ")]),a("el-select",{staticStyle:{width:"200px","margin-right":"5px"},attrs:{size:"small",clearable:"",placeholder:"公司类型"},model:{value:e.selectValue.type,callback:function(t){e.$set(e.selectValue,"type",t)},expression:"selectValue.type"}},[a("el-option",{attrs:{label:"供应商",value:"3"}}),a("el-option",{attrs:{label:"代理商",value:"2"}}),a("el-option",{attrs:{label:"客户",value:"1"}})],1),a("el-input",{staticStyle:{width:"300px","margin-right":"10px"},attrs:{maxlength:20,size:"small",placeholder:"请输入"},model:{value:e.selectValue.name,callback:function(t){e.$set(e.selectValue,"name",t)},expression:"selectValue.name"}},[a("template",{slot:"prepend"},[e._v("\n                服务大类\n              ")])],2),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["categoryQuery"],expression:"['categoryQuery']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.queryAll(1)}}},[e._v("\n              查询\n            ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 313px)",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"服务大类","min-width":"120"}}),a("el-table-column",{attrs:{prop:"supplier",label:"供应商",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.typeFilter(t.row,"3"))+"\n            ")]}}])}),a("el-table-column",{attrs:{prop:"customer",label:"代理商",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.typeFilter(t.row,"2"))+"\n            ")]}}])}),a("el-table-column",{attrs:{prop:"customer",label:"客户",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.typeFilter(t.row,"1"))+"\n            ")]}}])}),a("el-table-column",{attrs:{prop:"sort",width:"150",label:"排序值"}}),a("el-table-column",{attrs:{label:"添加类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["categoryStatistics"]),type:"text"},on:{click:function(a){return e.setSubType(t.row)}}},[e._v("\n                服务类型\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"添加时间",width:"180"}}),a("el-table-column",{attrs:{fixed:"right",width:"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["categoryUpdate"],expression:"['categoryUpdate']"}],attrs:{type:"text"},on:{click:function(a){return e.editType(t.row)}}},[e._v("\n                编辑\n              ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.isEdit?"编辑服务大类":"新增服务大类",visible:e.isAddEditVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.isAddEditVisible=t},close:e.cancel}},[a("div",{staticStyle:{padding:"0 20px"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"editForm",attrs:{model:e.selectForm,rules:e.formRules,"label-width":"90px","label-position":"right",size:"small"}},[a("el-form-item",{attrs:{label:"服务大类",prop:"name"}},[a("el-input",{ref:"firstInput",attrs:{maxlength:20,placeholder:"请输入"},model:{value:e.selectForm.name,callback:function(t){e.$set(e.selectForm,"name",t)},expression:"selectForm.name"}})],1),a("el-form-item",{attrs:{label:"公司类型",prop:"type"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",multiple:"",clearable:""},model:{value:e.selectForm.type,callback:function(t){e.$set(e.selectForm,"type",t)},expression:"selectForm.type"}},[a("el-option",{attrs:{label:"供应商",value:"3"}}),a("el-option",{attrs:{label:"代理商",value:"2"}}),a("el-option",{attrs:{label:"客户",value:"1"}})],1)],1),a("el-form-item",{attrs:{label:"排序值",prop:"sort"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",min:0,max:9999,step:1,"step-strictly":""},model:{value:e.selectForm.sort,callback:function(t){e.$set(e.selectForm,"sort",t)},expression:"selectForm.sort"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("\n              取 消\n            ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveConfirm()}}},[e._v("\n              确 定\n            ")])],1)]),a("el-dialog",{attrs:{title:"服务类型【"+e.typeName+"】",visible:e.isTypeVisible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.isTypeVisible=t},close:function(t){e.isTypeVisible=!1}}},[a("subType",{ref:"subType"})],1)],1)],1)])])},i=[],l=(a("c5f6"),a("6762"),a("2fdb"),a("55dd"),a("7f7f"),a("d225")),n=a("b0b4"),o=a("308d"),s=a("6bb5"),u=a("4e2b"),c=a("9ab4"),d=a("60a3"),p=a("ac1a"),m=a("b32d");function v(e){var t={url:"/cfg/type/getServiceTypeConfigList",method:"get",params:e};return Object(m["a"])(t)}function f(e){var t={url:"/cfg/type/getServiceSubtypeConfigList",method:"get",params:e};return Object(m["a"])(t)}function g(e){var t={url:"/cfg/type/saveType",method:"post",data:e};return Object(m["a"])(t)}function h(e){var t={url:"/cfg/type/saveSubtype",method:"post",data:e};return Object(m["a"])(t)}function b(e){var t={url:"/cfg/type/deleteSubtype",method:"delete",params:e};return Object(m["a"])(t)}var y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-type"},[a("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addSubType}},[e._v("\n    新增服务类型\n  ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"450px",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"服务类型"}}),a("el-table-column",{attrs:{prop:"overdue",width:"100",label:"逾期计费"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.overdueFormat(t.row))+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"overdueCharges",label:"计费区间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.overdueChargesFormat(t.row))+"\n      ")]}}])}),a("el-table-column",{attrs:{fixed:"right",width:"100",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editOrgan(t.row)}}},[e._v("\n          编辑\n        ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.subEdit?"编辑服务类型":"新增服务类型",visible:e.isAddEditType,"close-on-click-modal":!1,"append-to-body":"",width:"600px"},on:{"update:visible":function(t){e.isAddEditType=t},close:e.cancel}},[a("div",{staticClass:"subType-form"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"editForm",attrs:{model:e.selectForm,rules:e.formRules,"label-width":"90px","label-position":"right",size:"small"}},[a("el-form-item",{attrs:{label:"服务类型",prop:"name"}},[a("el-input",{ref:"firstInput",attrs:{maxlength:"20",placeholder:"请输入"},model:{value:e.selectForm.name,callback:function(t){e.$set(e.selectForm,"name",t)},expression:"selectForm.name"}})],1),a("el-form-item",{attrs:{label:"逾期计费",prop:"overdue"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.selectForm.overdue,callback:function(t){e.$set(e.selectForm,"overdue",t)},expression:"selectForm.overdue"}},[a("el-option",{attrs:{label:"按重量",value:"0"}}),a("el-option",{attrs:{label:"按体积",value:"1"}}),a("el-option",{attrs:{label:"按比例",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"计费区间",prop:"overdueCharges"}},e._l(e.selectForm.overdueCharges,function(t,r){return a("div",{key:r,staticClass:"item-after-icon"},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"输入下限",min:0,max:999999,step:1,"step-strictly":""},model:{value:e.selectForm.overdueCharges[r].lower,callback:function(t){e.$set(e.selectForm.overdueCharges[r],"lower",t)},expression:"selectForm.overdueCharges[index].lower"}}),a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"输入上限",min:0,max:999999,step:1,"step-strictly":""},model:{value:e.selectForm.overdueCharges[r].upper,callback:function(t){e.$set(e.selectForm.overdueCharges[r],"upper",t)},expression:"selectForm.overdueCharges[index].upper"}}),a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"单位金额",min:0,max:999999,precision:2},model:{value:e.selectForm.overdueCharges[r].amount,callback:function(t){e.$set(e.selectForm.overdueCharges[r],"amount",t)},expression:"selectForm.overdueCharges[index].amount"}}),a("span",[a("i",0===r?{staticClass:"el-icon-circle-plus-outline item-icon-plus",on:{click:e.addRangeData}}:{staticClass:"el-icon-remove-outline item-icon-reduce",on:{click:function(t){return e.deleteRangeData(r)}}})])],1)}),0)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("\n        取 消\n      ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveConfirm()}}},[e._v("\n        确 定\n      ")])],1)])],1)},k=[],w=(a("8e6e"),a("ac6a"),a("456d"),a("bd86"));function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(a,!0).forEach(function(t){Object(w["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var C=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.loading=!1,e.isAddEditType=!1,e.dialogLoading=!1,e.subEdit=!1,e.tableData=[],e.typeId="",e.typeName="",e.selectForm={name:void 0,overdue:void 0,overdueCharges:[{lower:void 0,upper:void 0,amount:void 0}]},e.formLoading=!1,e.page=1,e.size=10,e.total=0,e.formRules={name:[{required:!0,message:"服务类型不能为空",trigger:"blur"}],overdue:[{required:!0,message:"请选择逾期计费",trigger:"change"}],overdueCharges:[{required:!0,message:"计费区间不能为空",trigger:"blur"}]},e}return Object(u["a"])(t,e),Object(n["a"])(t,[{key:"overdueFormat",value:function(e){var t;switch(e.overdue){case"0":t="按重量";break;case"1":t="按体积";break;case"2":t="按比例";break;default:break}return t}},{key:"overdueChargesFormat",value:function(e){var t="";return e.overdueCharges.map(function(e){e.lower&&e.upper&&(t+=e.lower+"-"+e.upper+", ")}),t}},{key:"addSubType",value:function(){var e=this;this.subEdit=!1,this.isAddEditType=!0,this.$nextTick(function(){var t=e.$refs.firstInput;t.focus()})}},{key:"editOrgan",value:function(e){this.selectForm=e,(!Array.isArray(e.overdueCharges)||e.overdueCharges.length<=0)&&(this.selectForm.overdueCharges=[{lower:void 0,upper:void 0,amount:void 0}]),this.subEdit=!0,this.isAddEditType=!0}},{key:"addRangeData",value:function(){this.selectForm.overdueCharges.push({lower:void 0,upper:void 0,amount:void 0})}},{key:"deleteRangeData",value:function(e){this.selectForm.overdueCharges.splice(e,1)}},{key:"resetForm",value:function(){this.selectForm={name:void 0,overdue:void 0,overdueCharges:[{lower:void 0,upper:void 0,amount:void 0}]}}},{key:"close",value:function(){this.isAddEditType=!1,this.resetForm()}},{key:"cancel",value:function(){this.isAddEditType=!1,this.resetForm(),this.clearValidate()}},{key:"clearValidate",value:function(){var e=this.$refs.editForm;this.$nextTick(function(){e.clearValidate()})}},{key:"saveConfirm",value:function(){var e=this,t=this.$refs.editForm;t.validate(function(t){if(!t)return!1;var a=e.selectForm.overdueCharges.every(function(e){return e.lower>=0&&e.upper&&e.amount});if(!a)return e.$message.error("请完整填写计费值&单位金额"),!1;var r=e.selectForm.overdueCharges.some(function(e){return e.upper<=e.lower});if(r)e.$message({type:"error",message:"下限值不能大于等于上限值"});else{var i=!1;if(e.selectForm.overdueCharges.map(function(t,a){i=e.selectForm.overdueCharges.some(function(e,r){return a!==r&&(e.lower<=t.lower&&t.lower<e.upper||e.lower<t.upper&&t.upper<=e.upper)})}),i)e.$message({type:"error",message:"区间范围不能重叠"});else{e.formLoading=!0;var l=x({},e.selectForm);l.typeId=e.typeId,l.typeName=e.typeName,h(l).then(function(t){e.formLoading=!1,e.$message({type:"success",message:"操作成功"}),e.isAddEditType=!1,e.resetForm(),e.clearValidate(),e.queryAll()}).catch(function(t){return e.formLoading=!1,t})}}})}},{key:"deletRow",value:function(e){var t=this,a={id:e.id};this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){b(a).then(function(e){t.$message({type:"success",message:"删除成功"}),t.queryAll()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"queryAll",value:function(){var e=this;this.loading=!0;var t={typeId:this.typeId,page:this.page,size:this.size};f(t).then(function(t){e.loading=!1;var a=t.data||[];e.tableData=a,e.total=t.total}).catch(function(t){return e.loading=!1,t})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.queryAll()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.queryAll()}},{key:"init",value:function(e){this.typeId=e.id,this.typeName=e.name,this.queryAll()}},{key:"labelPosition",get:function(){var e=p["a"].language;return e&&"en"===e?"top":"left"}},{key:"lang",get:function(){var e=p["a"].language;return e||"en"}}]),t}(d["e"]);C=c["a"]([Object(d["a"])({name:"Port",components:{},props:{}})],C);var O=C,S=O,T=(a("f854"),a("2877")),_=Object(T["a"])(S,y,k,!1,null,"e39698ca",null),$=_.exports,A=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments)),e.loading=!1,e.isAddEditVisible=!1,e.isTypeVisible=!1,e.isEdit=!1,e.tableData=[],e.currentId="",e.typeName="",e.selectValue={type:[],name:void 0},e.selectForm={name:void 0,type:[],sort:void 0},e.formLoading=!1,e.page=1,e.size=10,e.total=0,e.formRules={name:[{required:!0,message:"服务大类不能为空",trigger:"blur"}],type:[{required:!1,message:"请选择关联公司",trigger:"change"}],sort:[{required:!0,message:"排序值不能为空",trigger:"blur"}]},e}return Object(u["a"])(t,e),Object(n["a"])(t,[{key:"setSubType",value:function(e){var t=this;this.typeName=e.name,this.isTypeVisible=!0,this.$nextTick(function(){var a=t.$refs.subType;a.init(e)})}},{key:"typeFilter",value:function(e,t){var a;switch(t){case"3":a=e.supplier?"√":"--";break;case"2":a=e.agent?"√":"--";break;case"1":a=e.customer?"√":"--";break;default:break}return a}},{key:"addType",value:function(){var e=this;this.isEdit=!1,this.isAddEditVisible=!0,this.$nextTick(function(){var t=e.$refs.firstInput;t.focus()})}},{key:"resetForm",value:function(){this.selectForm={name:void 0,sort:void 0,type:[]}}},{key:"editType",value:function(e){this.currentId=e.id;var t=e.name,a=e.sort,r=e.customer,i=e.supplier,l=e.agent;this.selectForm={name:t,sort:a};var n=[];r&&n.push("1"),l&&n.push("2"),i&&n.push("3"),this.$set(this.selectForm,"type",n),this.isEdit=!0,this.isAddEditVisible=!0}},{key:"close",value:function(){this.isAddEditVisible=!1,this.resetForm()}},{key:"cancel",value:function(){this.isAddEditVisible=!1,this.resetForm(),this.clearValidate()}},{key:"clearValidate",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.editForm;t.clearValidate()})}},{key:"saveConfirm",value:function(){var e=this,t=this.$refs.editForm;t.validate(function(t){if(!t)return!1;e.formLoading=!0;var a={name:e.selectForm.name,sort:e.selectForm.sort,supplier:void 0,customer:void 0,agent:void 0};a.supplier=e.selectForm.type.includes("3"),a.agent=e.selectForm.type.includes("2"),a.customer=e.selectForm.type.includes("1"),e.isEdit&&(a.id=e.currentId),g(a).then(function(t){e.formLoading=!1,e.$message({type:"success",message:"操作成功"}),e.isAddEditVisible=!1,e.resetForm(),e.clearValidate(),e.queryAll()}).catch(function(t){return e.formLoading=!1,t})})}},{key:"queryAll",value:function(e){var t=this;this.loading=!0,e&&(this.page=e);var a={name:this.selectValue.name,page:this.page,size:this.size,supplier:void 0,customer:void 0,agent:void 0};this.selectValue.type.includes("3")&&(a.supplier=!0),this.selectValue.type.includes("2")&&(a.agent=!0),this.selectValue.type.includes("1")&&(a.customer=!0),v(a).then(function(e){t.loading=!1,t.tableData=e.data.result,t.total=e.data.total}).catch(function(e){return t.loading=!1,e})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.queryAll()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.queryAll()}},{key:"created",value:function(){this.queryAll()}},{key:"labelPosition",get:function(){var e=p["a"].language;return e&&"en"===e?"top":"left"}},{key:"lang",get:function(){var e=p["a"].language;return e||"en"}}]),t}(d["e"]);A=c["a"]([Object(d["a"])({name:"ServiceGenara",components:{subType:$},props:{}})],A);var V=A,j=V,E=(a("7624"),Object(T["a"])(j,r,i,!1,null,"012a7bf1",null));t["default"]=E.exports},7624:function(e,t,a){"use strict";var r=a("cdb8"),i=a.n(r);i.a},b988:function(e,t,a){},cdb8:function(e,t,a){},f854:function(e,t,a){"use strict";var r=a("b988"),i=a.n(r);i.a}}]);