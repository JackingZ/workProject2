(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["personnel-management"],{"1c4c":function(e,t,r){"use strict";var a=r("9b43"),n=r("5ca1"),i=r("4bf8"),s=r("1fa8"),o=r("33a4"),u=r("9def"),c=r("f1ae"),l=r("27ee");n(n.S+n.F*!r("5cc5")(function(e){Array.from(e)}),"Array",{from:function(e){var t,r,n,d,p=i(e),f="function"==typeof this?this:Array,m=arguments.length,h=m>1?arguments[1]:void 0,g=void 0!==h,v=0,b=l(p);if(g&&(h=a(h,m>2?arguments[2]:void 0,2)),void 0==b||f==Array&&o(b))for(t=u(p.length),r=new f(t);t>v;v++)c(r,v,g?h(p[v],v):p[v]);else for(d=b.call(p),r=new f;!(n=d.next()).done;v++)c(r,v,g?s(d,h,[n.value,v],!0):n.value);return r.length=v,r}})},"2f71":function(e,t,r){"use strict";r.d(t,"l",function(){return n}),r.d(t,"n",function(){return i}),r.d(t,"m",function(){return s}),r.d(t,"k",function(){return o}),r.d(t,"b",function(){return u}),r.d(t,"a",function(){return c}),r.d(t,"f",function(){return l}),r.d(t,"i",function(){return d}),r.d(t,"c",function(){return p}),r.d(t,"d",function(){return f}),r.d(t,"e",function(){return m}),r.d(t,"h",function(){return h}),r.d(t,"g",function(){return g}),r.d(t,"j",function(){return v});var a=r("b32d");function n(e){var t={url:"/auth/user/getUserList",method:"post",data:e};return Object(a["a"])(t)}function i(e){var t={url:"/auth/user/saveUser",method:"post",data:e};return Object(a["a"])(t)}function s(e){var t={url:"/auth/user/resetPassword?id=".concat(e),method:"post"};return Object(a["a"])(t)}function o(e){var t={url:"/auth/user/getUser",method:"get",params:{id:e}};return Object(a["a"])(t)}function u(e){var t={url:"/auth/user/deleteUser",method:"delete",params:{id:e}};return Object(a["a"])(t)}function c(e){var t={url:"/auth/user/changeStatus",method:"post",params:e};return Object(a["a"])(t)}function l(e){var t={url:"/auth/dept/getDeptList",method:"get",params:e};return Object(a["a"])(t)}function d(e){var t={url:"/auth/supplier/getSupplierList",method:"get",params:e};return Object(a["a"])(t)}function p(e){var t={url:"/auth/agent/getAgentList",method:"get",params:e};return Object(a["a"])(t)}function f(e){var t={url:"/auth/customer/customer",method:"post",data:e};return Object(a["a"])(t)}function m(e){var t={url:"/auth/custtype/getServiceTypes",method:"get",params:e};return Object(a["a"])(t)}function h(e){var t={url:"/auth/post/getPostList",method:"get",params:e};return Object(a["a"])(t)}function g(e){var t={url:"/auth/user/parent",method:"get",params:e};return Object(a["a"])(t)}function v(){var e={url:"/auth/agent/customer_finance",method:"get"};return Object(a["a"])(e)}},49175:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[r("div",{staticClass:"dashboard-container",staticStyle:{width:"100%",overflow:"auto"}},[r("div",{staticClass:"app-container"},[r("head-info",{attrs:{title:"人员管理",info:""}}),r("div",{staticClass:"app-panel"},[r("el-row",[r("el-col",{attrs:{span:2}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["addUser"],expression:"['addUser']"}],attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAdd}},[e._v("\n              新增\n            ")])],1),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:22}},["1"!==e.custType?r("el-select",{staticStyle:{width:"120px","margin-right":"5px"},attrs:{size:"small",placeholder:"公司类型"},on:{change:e.onType},model:{value:e.selectValue.tag,callback:function(t){e.$set(e.selectValue,"tag",t)},expression:"selectValue.tag"}},e._l(e.typeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):e._e(),"4"===e.selectValue.tag?r("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"分公司",filterable:"",clearable:""},on:{change:e.onFiliale,focus:e.getFilialeCompanyList},model:{value:e.selectValue.comId,callback:function(t){e.$set(e.selectValue,"comId",t)},expression:"selectValue.comId"}},e._l(e.filialeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),"3"!==e.custType&&"1"!==e.selectValue.tag&&"5"!==e.selectValue.tag||"3"===e.custType&&"8"===e.selectValue.tag?r("el-select",{staticStyle:{width:"200px","margin-right":"5px"},attrs:{loading:e.selectLoading,disabled:"4"===e.selectValue.tag&&!e.selectValue.comId,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.selectValue.custId,callback:function(t){e.$set(e.selectValue,"custId",t)},expression:"selectValue.custId"}},e._l(e.companyList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),r("el-tree-select",{staticStyle:{display:"inline-block",width:"140px","margin-right":"5px"},attrs:{data:e.departmentList,"default-expand-all":!1,filterable:"",clearable:"",size:"small",placeholder:"请选择所属部门"},on:{change:e.onDept},model:{value:e.selectValue.deptId,callback:function(t){e.$set(e.selectValue,"deptId",t)},expression:"selectValue.deptId"}}),r("el-select",{staticStyle:{width:"120px","margin-right":"5px"},attrs:{size:"small",clearable:"",placeholder:"启用状态"},model:{value:e.selectValue.status,callback:function(t){e.$set(e.selectValue,"status",t)},expression:"selectValue.status"}},[r("el-option",{attrs:{label:"启用中",value:"1"}}),r("el-option",{attrs:{label:"已禁用",value:"0"}})],1),r("el-input",{staticClass:"input-with-select",staticStyle:{width:"300px","margin-right":"10px"},attrs:{placeholder:"请输入内容",size:"small"},model:{value:e.selectValue.key,callback:function(t){e.$set(e.selectValue,"key",t)},expression:"selectValue.key"}},[r("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",size:"small",placeholder:"请选择"},slot:"prepend",model:{value:e.selectValue.keyType,callback:function(t){e.$set(e.selectValue,"keyType",t)},expression:"selectValue.keyType"}},[r("el-option",{attrs:{label:"用户姓名",value:"1"}}),r("el-option",{attrs:{label:"手机号码",value:"2"}}),r("el-option",{attrs:{label:"登录账号",value:"3"}})],1)],1),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["queryUser"],expression:"['queryUser']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getUserList(1)}}},[e._v("\n              查询\n            ")])],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isTableLoading,expression:"isTableLoading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.list,height:"calc(100vh - 300px)",border:""}},[r("el-table-column",{attrs:{label:"姓名","min-width":"100",prop:"realName"}}),r("el-table-column",{attrs:{label:"登录名","min-width":"100",prop:"username"}}),r("el-table-column",{attrs:{label:"手机号",width:"150",prop:"phone"}}),r("el-table-column",{attrs:{label:"所属公司","min-width":"100",prop:"custName"}}),r("el-table-column",{attrs:{label:"所属部门","min-width":"100",prop:"deptName"}}),r("el-table-column",{attrs:{label:"用户权限","min-width":"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.rolesFormatter(t.row.roles))+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"添加时间",width:"180",prop:"createTime"}}),r("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"!==t.row.id&&t.row.username!==e.username?r("el-switch",{staticClass:"switchStyle",attrs:{value:t.row.status,disabled:!e.$checkPermission(["userChangeStatus"]),"active-text":"启用","inactive-text":"禁用","active-value":"1","inactive-value":"0"},on:{input:function(r){return e.onStatus(t.row,r)}}}):r("div",[e._v("\n                "+e._s("1"===t.row.status?"启用":"禁用")+"\n              ")])]}}])}),r("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"!==t.row.id&&t.row.username!==e.username&&e.$checkPermission(["userPassword"])?r("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(r){return e.resetPassword(t.row)}}},[e._v("\n                重置密码\n              ")]):e._e(),"admin"!==t.row.id&&t.row.username!==e.username?r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["editUser"],expression:"['editUser']"}],attrs:{type:"text",size:"medium"},on:{click:function(r){return e.editUser(t.row)}}},[e._v("\n                编辑\n              ")]):e._e(),"admin"!==t.row.id&&t.row.username!==e.username&&e.$checkPermission(["deleteUser"])?r("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(r){return e.deleteUser(t.row)}}},[e._v("\n                删除\n              ")]):e._e()]}}])})],1),r("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("app-drawer",{attrs:{"is-show":e.isShow,"cancel-text":"取消","confirm-text":"确定","mask-closable":!1,"drawer-title":"用户管理","drawer-style":"width: 500px;"},on:{drawerClose:e.close,drawerConfirm:e.confirm}},[r("edit-user",{ref:"userForm",attrs:{"is-edit":e.isEdit,"type-list":e.typeList},on:{onOk:e.close,getUserList:e.getUserList}})],1)],1)])])},n=[],i=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),s=r("a8db"),o=(r("7f7f"),r("5df3"),r("1c4c"),r("c5f6"),r("a481"),r("768b")),u=(r("96cf"),r("3b8d")),c=r("d225"),l=r("b0b4"),d=r("308d"),p=r("6bb5"),f=r("4e2b"),m=r("9ab4"),h=r("60a3"),g=r("9dba"),v=r("2f71"),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],staticClass:"app-panel"},[r("el-form",{ref:"userRoot",staticStyle:{"padding-right":"20px"},attrs:{"label-position":"right","label-width":"110px",size:"small",rules:e.formRules,model:e.form}},[e.isEdit||"1"===e.custType?e._e():r("el-form-item",{attrs:{label:"公司类型"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"公司类型"},on:{change:e.onType},model:{value:e.form.tag,callback:function(t){e.$set(e.form,"tag",t)},expression:"form.tag"}},e._l(e.typeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),r("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit&&"4"===e.form.tag,expression:"!isEdit && form.tag === '4'"}],attrs:{label:"分公司"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,size:"small",placeholder:"请选择",filterable:"",clearable:""},on:{change:e.onFiliale,focus:e.getFilialeCompanyList},model:{value:e.form.comId,callback:function(t){e.$set(e.form,"comId",t)},expression:"form.comId"}},e._l(e.filialeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),!e.isEdit&&("3"!==e.custType&&"1"!==e.form.tag&&"5"!==e.form.tag||"3"===e.custType&&"8"===e.form.tag)?r("el-form-item",{attrs:{label:"所属公司",prop:"custName"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,disabled:"4"===e.form.tag&&!e.form.comId,size:"small",placeholder:"请选择",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.form.custId,callback:function(t){e.$set(e.form,"custId",t)},expression:"form.custId"}},e._l(e.companyList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):e._e(),e.isEdit?r("el-form-item",{attrs:{label:"所属公司",prop:"custName"}},[r("el-input",{attrs:{disabled:e.isEdit},model:{value:e.form.custName,callback:function(t){e.$set(e.form,"custName",t)},expression:"form.custName"}})],1):e._e(),r("el-form-item",{attrs:{label:"所属部门",prop:"deptId"}},[r("el-tree-select",{ref:"tree",attrs:{data:e.deptList,"default-expand-all":!1,clearable:"",filterable:"",size:"small",placeholder:"请选择"},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}})],1),r("el-form-item",{attrs:{label:"所属岗位"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:"",filterable:"",loading:e.postLoading},on:{focus:e.getPostList},model:{value:e.form.postId,callback:function(t){e.$set(e.form,"postId",t)},expression:"form.postId"}},e._l(e.positionList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),r("el-form-item",{attrs:{label:"用户姓名",prop:"realName"}},[r("el-input",{attrs:{maxlength:20,placeholder:"请输入"},model:{value:e.form.realName,callback:function(t){e.$set(e.form,"realName",t)},expression:"form.realName"}})],1),r("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入",maxlength:20},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("el-form-item",{attrs:{label:"登录账号",prop:"un"}},[r("el-input",{attrs:{autocomplete:"off",placeholder:"请输入",maxlength:20,disabled:e.isEdit},model:{value:e.form.un,callback:function(t){e.$set(e.form,"un",t)},expression:"form.un"}})],1),r("el-form-item",{attrs:{label:"设置密码",prop:"pw"}},[r("el-input",{ref:"newPwdRef",attrs:{autocomplete:"new-password",maxlength:20,placeholder:"请输入",type:e.form.pw||e.newPwdReadOnly&&e.form.pw?"password":"text","auto-complete":"new-password",name:"new_password",readonly:e.newPwdReadOnly},on:{focus:function(t){return e.newPwdFocus(t)},blur:function(t){return e.newPwdBlur(t)}},model:{value:e.form.pw,callback:function(t){e.$set(e.form,"pw",t)},expression:"form.pw"}})],1),e.isEdit?e._e():r("el-form-item",{attrs:{label:"强制修改密码",prop:"ifUpdatePassword"}},[r("el-radio-group",{model:{value:e.form.ifUpdatePassword,callback:function(t){e.$set(e.form,"ifUpdatePassword",t)},expression:"form.ifUpdatePassword"}},[r("el-radio",{attrs:{label:"0"}},[e._v("\n          否\n        ")]),r("el-radio",{attrs:{label:"1"}},[e._v("\n          是\n        ")])],1)],1),r("el-form-item",{attrs:{label:"用户权限",prop:"roles"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",multiple:"","collapse-tags":"",clearable:"","value-key":"id"},model:{value:e.form.roles,callback:function(t){e.$set(e.form,"roles",t)},expression:"form.roles"}},e._l(e.rolesList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e}})}),1)],1)],1)],1)},y=[],w=(r("7514"),r("e0a1")),k=r("c530");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(r,!0).forEach(function(t){Object(i["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function x(){return{tag:"1",comId:"",comName:"",custId:"",custName:"",deptId:"",deptName:"",postId:"",realName:"",un:"",phone:"",pw:"",roles:[],ifUpdatePassword:"0"}}var I=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(d["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.form=x(),e.selectLoading=!1,e.editLoading=!1,e.isCompanyLoading=!1,e.rolesLoading=!1,e.postLoading=!1,e.newPwdReadOnly=!1,e.rolesList=[],e.orgTypeList=[],e.companyList=[],e.positionList=[],e.filialeList=[],e.typeIds=[],e.formRules={ifUpdatePassword:[{required:!0,message:"请选择是否强制修改密码",trigger:"change"}],custName:[{required:!0,message:"所属公司不能为空",trigger:"change"}],deptId:[{required:!0,message:"所属部门不能为空",trigger:"blur"}],realName:[{required:!0,message:"用户姓名不能为空",trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{validator:function(e,t,r){var a=/[\u4e00-\u9fa5]/;t&&a.test(t)?r(new Error("手机号码不能有中文")):r()},trigger:"blur"}],un:[{required:!0,message:"登录账号不能为空",trigger:"blur"},{validator:function(e,t,r){var a=/^[a-zA-Z][a-zA-Z0-9_]*$/;t||r(),t.length<4&&r(new Error("登录账号长度不能小于4位")),a.test(t)?r():r(new Error("格式不正确，必须以字母开头且只包含数字字母下划线"))}}],pw:[{required:!0,message:"账号密码不能为空",trigger:"blur"},{validator:function(e,t,r){var a=/^(?:\d+|[a-zA-Z\\W]+|[!@#$%^&*]+){6,20}$/;t||r(),(t.length<6||t.length>20)&&r(new Error("密码长度必须是大于6位小于20位")),a.test(t)?r():r(new Error("密码格式不正确"))}}],roles:[{required:!0,message:"请选择用户权限",trigger:"change"}]},e.deptList=[],e}return Object(f["a"])(t,e),Object(l["a"])(t,[{key:"pwChange",value:function(e){var t=this;""===e&&(this.newPwdReadOnly=!0,setTimeout(function(){t.newPwdReadOnly=!1},10))}},{key:"newPwdFocus",value:function(e){var t=this;e&&(e.stopPropagation(),e.preventDefault()),setTimeout(function(){t.newPwdReadOnly=!1},10)}},{key:"newPwdBlur",value:function(e){e&&e.stopPropagation(),this.newPwdReadOnly=!0}},{key:"setTag",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.form.tag=t,!r){e.next=6;break}return e.next=4,this.getUserById(t,r);case 4:e.next=8;break;case 6:return e.next=8,this.onType();case 8:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getUserById",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,r){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.editLoading=!0,Object(v["k"])(r.id).then(function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(n){var i,o,u,c,l,d,p,f,m,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=n.data,o=void 0===i?{}:i,JSON.parse(JSON.stringify(o)),u=o.roles,c=void 0===u?[]:u,l=o.deptId,d=void 0===l?"":l,p=o.username,f=o.password,m=Object(s["a"])(o,["roles","deptId","username","password"]),a.form=L({},m,{tag:t,custType:r.custType,un:p,pw:f}),e.next=6,a.getServerTypes();case 6:return e.next=8,a.getRoles();case 8:return e.next=10,a.getDeptList();case 10:a.getPostList(),h=c.map(function(e){if(a.rolesList.some(function(t){return t.id===e.id}))return e}).filter(function(e){return e&&e.id}),a.$set(a.form,"roles",h),a.$set(a.form,"deptId",d),a.editLoading=!1;case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return a.editLoading=!1,e});case 2:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"onType",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.form.deptId="",this.form.comId="",this.form.comName="",this.form.custName="",this.form.custId="",this.form.postId="",this.typeIds=[],this.rolesList=[],this.filialeList=[],this.companyList=[],"1"!==this.form.tag&&"5"!==this.form.tag&&("3"!==this.custType||"7"!==this.form.tag)){e.next=19;break}return this.form.custName=this.custName,this.form.custId=this.custId,e.next=15,this.getServerTypes();case 15:return e.next=17,this.getRoles();case 17:return e.next=19,this.getDeptList();case 19:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getFilialeCompanyList",value:function(){var e=this;this.selectLoading=!0,Object(v["j"])().then(function(t){var r=t.data||[];e.filialeList=r,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onFiliale",value:function(e){this.form.custId="",this.form.custName="",this.form.comName="";var t=this.filialeList.find(function(t){return t.id===e});t&&(this.form.comName=t.name)}},{key:"getCompanyList",value:function(){var e=this,t={page:1,size:99999},r=this.form,a=r.tag,n=r.comId,i=null;if("2"===a||"8"===a||"4"===a)t.custIds="4"===a?[n]:[this.custId],i=Object(v["d"])(t);else if("3"===a)i=Object(v["j"])();else if("6"===a)t.parentId=this.custId,i=Object(v["c"])(t);else{if("7"!==a)return void(this.companyList=[]);i=Object(v["i"])(t)}this.selectLoading=!0,i.then(function(t){if("3"===a||"2"===a||"4"===a||"8"===a){var r=t.data||[];e.companyList=r}else{var n=t.data||{};e.companyList=n.result||[]}e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onCompany",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.form.deptId="",this.form.deptName="",this.form.custName="",this.typeIds=[],this.deptList=[],this.rolesList=[],t=this.companyList.find(function(e){return e.id===r.form.custId}),!t){e.next=15;break}return this.form.custName=t.name,e.next=11,this.getServerTypes();case 11:return e.next=13,this.getRoles();case 13:return e.next=15,this.getDeptList();case 15:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getServerTypes",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(v["e"])({custId:this.form.custId});case 3:t=e.sent,r=t.data||[],this.typeIds=r.map(function(e){return e.id}),e.next=12;break;case 8:return e.prev=8,e.t0=e["catch"](0),this.editLoading=!1,e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"getDeptList",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r,a,n,i,s,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.form,r=t.tag,a=t.custId,n=this.custType,i="",("1"===r||"5"===r||"3"===n&&"7"===r)&&(i=this.deptId),a){e.next=6;break}return e.abrupt("return");case 6:return s={custId:a,deptId:i},e.next=9,Object(k["d"])(s).then(function(e){var t=e.data||{},r=t.result||[],a=JSON.parse(JSON.stringify(r).replace(/name/g,"label").replace(/id/g,"value"));o.deptList=a}).catch(function(e){return e});case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getPostList",value:function(){var e=this;this.postLoading=!0;var t=this.form.tag,r="";"1"===t||"3"===t||"6"===t?r="2":"2"===t||"4"===t||"8"===t?r="1":"5"===t?r="0":"7"===t&&(r="3");var a={page:1,size:99999,type:r};Object(v["h"])(a).then(function(t){e.postLoading=!1,e.positionList=t.data.result||[]}).catch(function(t){return e.postLoading=!1,t})}},{key:"getRoles",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.rolesLoading=!0,t=this.form.tag,r="","1"===t||"3"===t||"6"===t?r="2":"2"===t||"4"===t||"8"===t?r="1":"5"===t?r="0":"7"===t&&(r="3"),!(this.typeIds.length<=0)){e.next=7;break}return this.rolesList=[],e.abrupt("return");case 7:return e.next=9,Object(w["e"])({typeIds:this.typeIds,custType:r}).then(function(e){a.rolesLoading=!1,a.rolesList=e.data||[]}).catch(function(e){return a.rolesLoading=!1,a.editLoading=!1,e});case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"closeUser",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.userRoot;e.form=x(),e.rolesList=[],e.typeIds=[],t.clearValidate()})}},{key:"saveUser",value:function(){var e=this,t=this.$refs.tree,r=this.form,a=r.tag,n=r.comId,i=r.comName,o=Object(s["a"])(r,["tag","comId","comName"]),u=this.$refs.userRoot;u.validate(function(r){if(r){e.$emit("setLoad",!0);var s=L({},o,{ifOnce:e.isEdit?o.ifOnce:"1"}),u=e.custType,c=e.custSubtype;if("1"===a)s.custType="2",s.custSubtype=c,s.parentName=e.parentName,s.parentId=e.parentId;else if("3"===a||"6"===a)s.custType="2",s.custSubtype="3"===a?"2":"1",s.parentName=e.custName,s.parentId=e.custId;else if("2"===a||"4"===a||"8"===a){s.custType="1";var l=e.companyList.find(function(e){return e.id===s.custId});s.custSubtype=(l||{}).subtype,s.parentName="4"===a?i:e.custName,s.parentId="4"===a?n:e.custId}else"5"===a?s.custType="0":"7"===a&&(s.custType="3",s.parentName="0"===u?e.custName:e.parentName,s.parentId="0"===u?e.custId:e.parentId);e.positionList.find(function(e){e.id===s.postId&&(s.postName=e.name)}),s.deptName=t.query,s.username=s.un.trim(),s.password=s.pw.trim(),Object(v["n"])(s).then(function(t){e.editLoading=!1,e.$emit("onOk"),e.$emit("getUserList")}).catch(function(t){return e.editLoading=!1,t})}})}},{key:"custId",get:function(){var e=g["a"].info||{},t=e.custId;return t}},{key:"custName",get:function(){var e=g["a"].info||{},t=e.custName;return t}},{key:"deptId",get:function(){var e=g["a"].info||{},t=e.deptId;return t}},{key:"custType",get:function(){var e=g["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=g["a"].info||{},t=e.custSubtype;return t}},{key:"parentId",get:function(){var e=g["a"].info||{},t=e.parentId;return t}},{key:"parentName",get:function(){var e=g["a"].info||{},t=e.parentName;return t}}]),t}(h["e"]);m["a"]([Object(h["f"])("form.pw")],I.prototype,"pwChange",null),I=m["a"]([Object(h["a"])({name:"",components:{},props:{isEdit:{type:Boolean,default:!1},typeList:{type:Array,default:function(){return[]}}}})],I);var j=I,N=j,T=r("2877"),S=Object(T["a"])(N,b,y,!1,null,"57be58e9",null),P=S.exports;function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(r,!0).forEach(function(t){Object(i["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var $=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(d["a"])(this,Object(p["a"])(t).apply(this,arguments)),e.page=1,e.size=10,e.total=0,e.isActive=!1,e.isShow=!1,e.isTableLoading=!1,e.isEdit=!1,e.list=[],e.departmentList=[],e.companyList=[],e.filialeList=[],e.selectLoading=!1,e.selectValue={custId:void 0,comId:void 0,deptId:"",tag:void 0,status:void 0,keyType:"1",key:void 0},e.typeList=[],e}return Object(f["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this.custType,r=this.custSubtype,"0"===t?(this.typeList=[{id:"5",name:"聚货通"},{id:"6",name:"一级代理商"},{id:"7",name:"供应商"}],this.selectValue.tag="5"):"2"===t&&"1"===r?(this.typeList=[{id:"1",name:"本公司"},{id:"2",name:"客户(本公司)"},{id:"3",name:"分公司"},{id:"4",name:"客户(分公司)"}],this.selectValue.tag="1"):"2"===t&&"2"===r?(this.typeList=[{id:"1",name:"本公司"},{id:"2",name:"客户"}],this.selectValue.tag="1"):"3"===t&&(this.selectValue.tag="7",this.typeList=[{id:"7",name:"本公司"},{id:"8",name:"客户"}]),this.selectValue.custId=this.custId,this.getDepartment(),this.getUserList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"onType",value:function(){this.selectValue.deptId="",this.selectValue.custId="",this.list=[];var e=this.selectValue.tag;("1"===e||"5"===e||"3"===this.custType&&"7"===e)&&(this.selectValue.custId=this.custId),this.getDepartment(),this.getUserList()}},{key:"filterNode",value:function(e,t){return!e||-1!==t.title.indexOf(e)}},{key:"close",value:function(){var e=this;this.isShow=!1,this.$nextTick(function(){var t=e.$refs.userForm;t.closeUser()})}},{key:"confirm",value:function(){var e=this.$refs.userForm;e.saveUser()}},{key:"onStatus",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,r){var a,n,i,s,u=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.status&&t.status!==r){e.next=2;break}return e.abrupt("return");case 2:return a="0"===r?"禁用":"开启",e.next=5,this.$confirm("此操作将".concat(a,"用户，是否继续？"),"提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 5:if(n=e.sent,i=Object(o["a"])(n,2),s=i[0],i[1],!s){e.next=11;break}return e.abrupt("return");case 11:Object(v["a"])({id:t.id,status:r}).then(function(e){u.$message.success("修改成功"),u.getUserList()}).catch(function(e){return e});case 12:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getCompanyList",value:function(){var e=this,t={page:1,size:99999},r=null,a=this.selectValue.tag;if("2"===a||"4"===a||"8"===a)t.custIds="4"===a?[this.selectValue.comId]:[this.custId],r=Object(v["d"])(t);else if("3"===a)r=Object(v["j"])();else if("6"===a)t.parentId=this.custId,r=Object(v["c"])(t);else{if("7"!==a)return void(this.companyList=[]);r=Object(v["i"])(t)}this.selectLoading=!0,r.then(function(t){if("3"===a||"2"===a||"4"===a||"8"===a){var r=t.data||[];e.companyList=r}else{var n=t.data||{};e.companyList=n.result||[]}e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onCompany",value:function(){this.selectValue.deptId="",this.departmentList=[],this.getDepartment(),this.getUserList(1)}},{key:"getFilialeCompanyList",value:function(){var e=this;this.selectLoading=!0,Object(v["j"])().then(function(t){var r=t.data||[];e.filialeList=r,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onFiliale",value:function(){this.selectValue.custId=void 0,this.list=[],this.companyList=[],this.getUserList(1)}},{key:"onDept",value:function(){this.getUserList(1)}},{key:"getDepartment",value:function(){var e=this,t="";if(("1"===this.selectValue.tag||"5"===this.selectValue.tag||"3"===this.custType&&"7"===this.selectValue.tag)&&(t=this.deptId),this.selectValue.custId){var r={custId:this.selectValue.custId,deptId:t};Object(v["f"])(r).then(function(t){var r=t.data.result||[],a=JSON.parse(JSON.stringify(r).replace(/name/g,"label").replace(/id/g,"value"));e.departmentList=a}).catch(function(e){return e})}}},{key:"deleteUser",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,i,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,this.$confirm("此操作将删除用户，是否继续？","提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 3:if(a=e.sent,n=Object(o["a"])(a,2),i=n[0],n[1],!i){e.next=9;break}return e.abrupt("return");case 9:Object(v["b"])(r).then(function(e){var t=e.msg;s.$message.success(t),s.getUserList()}).catch(function(e){return e});case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"resetPassword",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r,a,n,i,s=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,e.next=3,this.$confirm("此操作将重置用户密码，是否继续？","提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 3:if(a=e.sent,n=Object(o["a"])(a,2),i=n[0],n[1],!i){e.next=9;break}return e.abrupt("return");case 9:Object(v["m"])(r).then(function(e){var t=e.data;s.$message.success("密码重置成功，新密码为：".concat(t))}).catch(function(e){return e});case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleAdd",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.isShow=!0,this.isEdit=!1,t=this.selectValue.tag,this.$nextTick(function(){var e=r.$refs.userForm;e.setTag(t)});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"editUser",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.isShow=!0,this.isEdit=!0,r=this.selectValue.tag,this.$nextTick(function(){var e=a.$refs.userForm;e.setTag(r,t)});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.getUserList()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.getUserList()}},{key:"rolesFormatter",value:function(e){if(Array.from(e)&&e){var t=e.map(function(e){return e.name});return t.join(",")}return"--"}},{key:"getUserList",value:function(e){var t=this;this.isTableLoading=!0;var r=this.selectValue,a=r.custId,n=r.tag,i=r.comId,o=Object(s["a"])(r,["custId","tag","comId"]);e&&(this.page=e);var u={model:V({},o,{tag:n,custIdList:"4"===n&&i?[i]:a?[a]:[],customerList:"4"===n&&a?[a]:[]}),page:this.page,size:this.size};Object(v["l"])(u).then(function(e){var r=e.data||{};t.list=r.result||[],t.total=r.total,t.isTableLoading=!1}).catch(function(e){return t.isTableLoading=!1,e})}},{key:"custId",get:function(){var e=g["a"].info||{},t=e.custId;return t}},{key:"deptId",get:function(){var e=g["a"].info||{},t=e.deptId;return t}},{key:"custType",get:function(){var e=g["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=g["a"].info||{},t=e.custSubtype;return t}},{key:"username",get:function(){var e=g["a"].info||{},t=e.username;return t}},{key:"custName",get:function(){var e=g["a"].info||{},t=e.custName;return t}}]),t}(h["e"]);$=m["a"]([Object(h["a"])({name:"Organization",components:{EditUser:P},props:{}})],$);var U=$,_=U,C=Object(T["a"])(_,a,n,!1,null,null,null);t["default"]=C.exports},c530:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"b",function(){return o}),r.d(t,"a",function(){return u});var a=r("b32d");function n(e){var t={url:"/auth/dept/saveDept",method:"post",data:e};return Object(a["a"])(t)}function i(e){var t={url:"/auth/dept/getDeptList",method:"get",params:e};return Object(a["a"])(t)}function s(e){var t={url:"/auth/dept/getDept",method:"get",params:e};return Object(a["a"])(t)}function o(e){var t={url:"/auth/dept/deleteDept",method:"delete",params:e};return Object(a["a"])(t)}function u(e){var t={url:"/auth/dept/changeStatus",method:"post",params:e};return Object(a["a"])(t)}},e0a1:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"h",function(){return o}),r.d(t,"b",function(){return u}),r.d(t,"g",function(){return c}),r.d(t,"a",function(){return l}),r.d(t,"f",function(){return d});var a=r("b32d");function n(e){var t={url:"/auth/permit/getRoles",method:"post",data:e};return Object(a["a"])(t)}function i(){var e={url:"/auth/permit/getPermits",method:"get"};return Object(a["a"])(e)}function s(e){var t={url:"/auth/permit/getPermitByRole",method:"get",params:{id:e}};return Object(a["a"])(t)}function o(e){var t={url:"/auth/permit/saveRolePermit",method:"post",data:e};return Object(a["a"])(t)}function u(e){var t={url:"/auth/permit/deleteRole",method:"post",params:{roleId:e}};return Object(a["a"])(t)}function c(e){var t={url:"/auth/permit/saveRole",method:"post",data:e};return Object(a["a"])(t)}function l(e){var t={url:"auth/permit/add",method:"post",data:e};return Object(a["a"])(t)}function d(e){var t={url:"/cfg/type/getServiceTypeList",method:"get",params:e};return Object(a["a"])(t)}}}]);