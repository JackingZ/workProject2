(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["car-order"],{"0afc":function(t,e,a){},"444f":function(t,e,a){},"59c4":function(t,e,a){"use strict";a.d(e,"i",function(){return n}),a.d(e,"o",function(){return i}),a.d(e,"h",function(){return s}),a.d(e,"n",function(){return o}),a.d(e,"e",function(){return c}),a.d(e,"j",function(){return l}),a.d(e,"g",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"m",function(){return m}),a.d(e,"p",function(){return p}),a.d(e,"a",function(){return h}),a.d(e,"d",function(){return v}),a.d(e,"c",function(){return f}),a.d(e,"s",function(){return b}),a.d(e,"r",function(){return g}),a.d(e,"b",function(){return y}),a.d(e,"l",function(){return w}),a.d(e,"k",function(){return _}),a.d(e,"q",function(){return k});var r=a("b32d");function n(){var t={url:"/setting/area/getCountryList",method:"get"};return Object(r["a"])(t)}function i(t){var e={url:"/setting/area/getStateByCountry",method:"get",params:{countryId:t}};return Object(r["a"])(e)}function s(t){var e={url:"/setting/area/getCityByState",method:"get",params:{stateId:t}};return Object(r["a"])(e)}function o(t){var e={url:"/cfg/type/getServiceSubtypeList",method:"get",params:t};return Object(r["a"])(e)}function c(t){var e={url:"/setting/currency/getCurrencyList",method:"get",params:t};return Object(r["a"])(e)}function l(t){var e={url:"/auth/custtype/queryAgents",method:"post",data:t};return Object(r["a"])(e)}function u(t){var e={url:"/cfg/ksc/getKscList",method:"post",data:t};return Object(r["a"])(e)}function d(t){var e={url:"/cfg/ksc/axis",method:"post",params:t};return Object(r["a"])(e)}function m(t){var e={url:"/price/truck/page",method:"post",data:t};return Object(r["a"])(e)}function p(t){var e={url:"/price/truck/page1",method:"post",data:t};return Object(r["a"])(e)}function h(t){var e={url:"/price/truck/add",method:"post",data:t};return Object(r["a"])(e)}function v(t){var e={url:"/price/truck/update",method:"post",data:t};return Object(r["a"])(e)}function f(t){var e={url:"/price/truck/del",method:"delete",params:t};return Object(r["a"])(e)}function b(t){var e={url:"/price/truck/superior",method:"post",data:t};return Object(r["a"])(e)}function g(t){var e={url:"/price/truck/refStandard",method:"post",data:t};return Object(r["a"])(e)}function y(t){var e={url:"/price/truck/review",method:"post",data:t};return Object(r["a"])(e)}function w(t){var e={url:"/price/truck/history",method:"get",params:t};return Object(r["a"])(e)}function _(t){var e={url:"/price/truck/history/get",method:"get",params:t};return Object(r["a"])(e)}function k(t){var e={url:"/price/truck/doExpire",method:"get",params:t};return Object(r["a"])(e)}},"626a7":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.detailShow,expression:"!detailShow"}],staticClass:"app-container"},[a("head-info",{attrs:{info:"",title:"卡派订单"}}),a("div",{staticClass:"app-panel"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3}}),a("el-col",{attrs:{span:(t.custId,24)}},[a("div",{staticStyle:{"text-align":"right"}},["0"===t.custType||"2"===t.custType?a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"订单类型",size:"small"},on:{change:t.onOrderType},model:{value:t.searchForm.orderType,callback:function(e){t.$set(t.searchForm,"orderType",e)},expression:"searchForm.orderType"}},t._l(t.orderTypeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1):t._e(),"2"===t.custType&&"1"===t.custSubtype&&"0"===t.searchForm.orderType?a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"公司类型",clearable:""},on:{change:t.onComType},model:{value:t.searchForm.comType,callback:function(e){t.$set(t.searchForm,"comType",e)},expression:"searchForm.comType"}},t._l(t.companyTypeList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})}),1):t._e(),"0"!==t.custType&&"2"!==t.custType||"0"!==t.searchForm.orderType?t._e():a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:t.selectLoading,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:t.onCompany,focus:t.getCompanyList},model:{value:t.searchForm.comId,callback:function(e){t.$set(t.searchForm,"comId",e)},expression:"searchForm.comId"}},t._l(t.companyList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"订单状态",size:"small",clearable:"",filterable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"业务类型",size:"small",clearable:"",filterable:"",loading:t.serviceLoading},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}},t._l(t.typeList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"目的地",size:"small",clearable:"",filterable:"",loading:t.countryLoading},on:{focus:t.getCountryList},model:{value:t.searchForm.objective,callback:function(e){t.$set(t.searchForm,"objective",e)},expression:"searchForm.objective"}},t._l(t.countryList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name+"-"+t.alias,value:t.id}})}),1),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"服务",size:"small",clearable:"",filterable:"",loading:t.serviceLoading},on:{focus:t.getSubtypeList},model:{value:t.searchForm.kscId,callback:function(e){t.$set(t.searchForm,"kscId",e)},expression:"searchForm.kscId"}},t._l(t.kscList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-date-picker",{staticStyle:{width:"240px","margin-right":"5px"},attrs:{clearable:!1,"unlink-panels":"",type:"daterange",align:"right",size:"small","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"下单起始时间","end-placeholder":"下单截止时间"},model:{value:t.searchForm.orderTime,callback:function(e){t.$set(t.searchForm,"orderTime",e)},expression:"searchForm.orderTime"}}),a("el-input",{staticClass:"input-with-select",staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"原单号",size:"small",clearable:""},model:{value:t.searchForm.number,callback:function(e){t.$set(t.searchForm,"number",e)},expression:"searchForm.number"}}),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["kapieOrderQuery"],expression:"['kapieOrderQuery']"}],attrs:{type:"primary",size:"small"},on:{click:function(e){return t.loadData(1)}}},[t._v("\n                查询\n              ")])],1)])],1),a("div",{staticClass:"table-wrap"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:t.tableData,height:"calc(100vh - 313px)",border:""}},[a("el-table-column",{attrs:{fixed:"left",prop:"number",label:"原单号","min-width":"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"left",prop:"status",label:"订单状态","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.status?a("span",[t._v("待分配")]):t._e(),"1"===e.row.status?a("span",[t._v("已分配")]):t._e(),"3"===e.row.status?a("span",[t._v("司机已取消/已拒绝")]):t._e(),"10"===e.row.status?a("span",[t._v("已完成")]):t._e(),"20"===e.row.status?a("span",[t._v("已到场")]):t._e(),"30"===e.row.status?a("span",[t._v("已提货")]):t._e(),"40"===e.row.status?a("span",[t._v("已装车")]):t._e(),"50"===e.row.status?a("span",[t._v("完成装车")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"下单时间",width:"160"}}),a("el-table-column",{attrs:{prop:"goodsName",label:"业务类型",width:"120"}}),a("el-table-column",{attrs:{prop:"kscName",label:"服务","min-width":"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"customerName",label:"下单客户","min-width":"150","show-overflow-tooltip":""}}),"0"===t.custType?a("el-table-column",{attrs:{prop:"orderCustomerName",label:"客户名称",width:"150","show-overflow-tooltip":""}}):t._e(),"0"===t.custType?a("el-table-column",{attrs:{prop:"sellerName",label:"供应商",width:"150","show-overflow-tooltip":""}}):t._e(),"2"===t.custType?a("el-table-column",{attrs:{prop:"sellerName",label:"服务提供商",width:"150","show-overflow-tooltip":""}}):t._e(),a("el-table-column",{attrs:{prop:"delivery",label:"提货方式",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.delivery?a("span",[t._v("自主送货")]):"1"===e.row.delivery?a("span",[t._v("上门提货")]):"2"===e.row.delivery?a("span",[t._v("快递发货")]):"3"===e.row.delivery?a("span",[t._v("整柜直装")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"planTime",label:"提货日期",width:"160"}}),a("el-table-column",{attrs:{prop:"destinationCountry",label:"目的地","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"pickTime",label:"送货日期",width:"160"}}),a("el-table-column",{attrs:{prop:"remake",label:"备注","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["kapieOrderGet"],expression:"['kapieOrderGet']"}],attrs:{type:"text",size:"small"},on:{click:function(a){return t.showDetail(e.row)}}},[t._v("\n                  查看\n                ")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.showVehiclesInfo(e.row)}}},[t._v("\n                  司机信息\n                ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":t.page,"page-size":t.size,layout:"total, prev, pager, next",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.detailShow,expression:"detailShow"}],staticClass:"app-container"},[a("detail",{ref:"detailForm",attrs:{form:t.detailData,"pick-list":t.pickList},on:{back:function(e){t.detailShow=!1}}})],1),a("el-dialog",{attrs:{title:"司机信息",width:"1200px",visible:t.visible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.visible=e},close:function(e){t.visible=!1}}},[a("div",[a("span",[t._v("原单号：")]),a("span",[t._v(t._s(t.vehiclesInfo.code))])]),a("el-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:t.vehiclesInfo.list,border:""}},[a("el-table-column",{attrs:{prop:"driverName",label:"司机","min-width":"180"}}),a("el-table-column",{attrs:{prop:"cardId",label:"车牌号","min-width":"180"}}),a("el-table-column",{attrs:{prop:"driverPhone",label:"联系电话","min-width":"180"}}),a("el-table-column",{attrs:{prop:"createTime",label:"接单时间","min-width":"180"}}),a("el-table-column",{attrs:{prop:"orderStatus",label:"订单状态","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.orderStatus?a("span",[t._v("待处理")]):t._e(),"1"===e.row.orderStatus?a("span",[t._v("已完成")]):t._e(),"2"===e.row.orderStatus?a("span",[t._v("已取消")]):t._e(),"3"===e.row.orderStatus?a("span",["0"===e.row.presentStatus&&"0"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(司机未到场)")]):t._e(),"1"===e.row.presentStatus&&"0"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(司机已到场)")]):t._e(),"1"===e.row.presentStatus&&"1"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(已装车)")]):t._e(),"1"===e.row.presentStatus&&"1"===e.row.completeStatus&&"1"===e.row.deliveryStatus?a("span",[t._v("进行中(运输中)")]):t._e()]):t._e()]}}])})],1)],1)],1)])},n=[],i=(a("c5f6"),a("96cf"),a("3b8d")),s=a("d225"),o=a("b0b4"),c=a("308d"),l=a("6bb5"),u=a("4e2b"),d=a("9ab4"),m=a("60a3"),p=a("8de4"),h=a("af5a"),v=a("9dba"),f=a("8099"),b=a("5a0c"),g=a.n(b),y=a("59c4"),w=a("bef3"),_=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.detailData={},t.detailShow=!1,t.loading=!1,t.countryLoading=!1,t.serviceLoading=!1,t.lscLoading=!1,t.selectLoading=!1,t.statusList=[{name:"待分配",id:0},{name:"已分配",id:1},{name:"司机已取消/已拒绝",id:3},{name:"已完成",id:10},{name:"已到场",id:20},{name:"已提货",id:30},{name:"已装车",id:40},{name:"完成装车",id:50}],t.countryList=[],t.typeList=[],t.kscList=[],t.tableData=[],t.companyList=[],t.orderTypeList=[{name:"销售订单",id:"0"},{name:"采购订单",id:"1"}],t.companyTypeList=[{id:"1",name:"客户"},{id:"2",name:"二级代理商"}],t.pickList=[{name:"自主送货",id:"0"},{name:"上门提货",id:"1"},{name:"快递发货",id:"2"},{name:"整柜直装",id:"3"}],t.page=1,t.size=10,t.total=0,t.searchForm={type:void 0,customerId:void 0,objective:void 0,sellerId:void 0,status:void 0,kscId:void 0,number:"",orderType:"0",comType:"",comId:"",orderTime:[]},t.visible=!1,t.vehiclesInfo={code:"",list:[]},t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"getSubtypeList",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.selectLoading=!0,t.next=3,Object(y["n"])({typeId:"01"}).then(function(t){e.selectLoading=!1,t.success&&(e.typeList=t.data||[])}).catch(function(t){return e.selectLoading=!1,t});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"toAllocationCat",value:function(){this.$router.push({name:"allocationCat"})}},{key:"showModal",value:function(t){var e=this,a=this.$refs.carOrderModal,r={id:t.id};this.loading=!0,Object(p["e"])(r).then(function(t){if(e.loading=!1,t.success){var r=t.data||{};a.show(r)}}).catch(function(t){return e.loading=!1,t})}},{key:"showVehiclesInfo",value:function(t){var e=this,a={cardId:t.id};this.loading=!0,Object(p["g"])(a).then(function(a){e.loading=!1,e.vehiclesInfo={code:t.number,list:a.data||[]},e.visible=!0}).catch(function(t){e.loading=!1})}},{key:"showDetail",value:function(t){var e=this,a={id:t.id};this.loading=!0,Object(p["e"])(a).then(function(t){if(e.loading=!1,t.success){var a=t.data||{},r=a.cardOrder,n=a.cardPackingList||[];e.detailData={customerName:r.customerName,consignorAdd:r.consignorAdd,consignorAddPick:(n[0]||{}).consignorAdd||r.warehouseAddress,consignorAddDetails:r.consignorCountry+r.consignorProvince+r.consignorCity+r.consignorAdd,warehouseAddress:r.warehouseAddress,pay:r.pay,planTime:r.planTime,remark:r.remark,consignor:r.consignor,consignorPhone:r.consignorPhone,consigneeCountry:r.consigneeCountry,consigneeProvince:r.consigneeProvince,consigneeCity:r.consigneeCity,consignorPostcode:r.consignorPostcode,harvestMan:r.harvestMan,harvestPhone:r.harvestPhone,harvestCountry:r.harvestCountry,harvestProvince:r.harvestProvince,harvestCity:r.harvestCity,harvestPostcode:r.harvestPostcode,harvestAdd:r.harvestAdd,containerType:r.cabinetType,total:r.total,cardValue:r.cardValue,currencyId:r.currencyId,weight:r.weight,volume:r.volume,umLength:r.umLength,umWeight:r.umWeight},e.detailShow=!0}}).catch(function(t){return e.loading=!1,t})}},{key:"onCompany",value:function(){this.tableData=[],this.loadData(1)}},{key:"getCompanyList",value:function(){var t=this,e={page:1,size:9999},a=this.custType,r=this.custSubtype,n=null;if("2"!==a||"1"!==this.searchForm.comType&&"2"!==r)if("2"===a&&"2"===this.searchForm.comType)e.parentId=this.custId,e.subtype="2",e.types="01",n=h["g"];else{if("0"!==a)return void(this.companyList=[]);e.parentId=this.custId,e.subtype="1",e.types="01",n=h["g"]}else e.custIds=[this.custId],n=h["l"];this.selectLoading=!0,n(e).then(function(e){if("2"!==a||"1"!==t.searchForm.comType&&"2"!==r){var n=e.data||{};t.companyList=n.result||[]}else{var i=e.data||[];t.companyList=i}t.selectLoading=!1}).catch(function(e){return t.selectLoading=!1,e})}},{key:"onComType",value:function(){this.searchForm.comId="",this.companyList=[],this.tableData=[]}},{key:"onOrderType",value:function(){this.tableData=[],"1"===this.searchForm.orderType&&(this.searchForm.comType="",this.searchForm.comId="",this.companyList=[]),"0"===this.custType&&this.loadData(1)}},{key:"getKscList",value:function(){var t=this,e={page:1,size:9999,model:{subtypeId:this.searchForm.type}};this.serviceLoading=!0,Object(p["d"])(e).then(function(e){var a=e.data||{};t.kscList=a.result||[],t.kscList=t.kscList.filter(function(t){return"1"===t.status}),t.serviceLoading=!1}).catch(function(e){return t.serviceLoading=!1,e})}},{key:"getCountryList",value:function(){var t=this,e={custId:this.custId||"",typeId:"01"};this.countryLoading=!0,Object(w["b"])(e).then(function(e){t.countryList=e.data||[],t.selectLoading=!1}).catch(function(e){return t.countryLoading=!1,e})}},{key:"loadData",value:function(t){var e=this;1===t&&(this.page=1);var a=this.custType,r=this.searchForm.orderTime;"1"===a?this.searchForm.orderType="1":"3"===a&&(this.searchForm.orderType="0"),"0"===this.searchForm.orderType?(this.searchForm.sellerId=this.searchForm.custId,this.searchForm.customerId="3"===a?"0":this.searchForm.comId):"1"===this.searchForm.orderType&&(this.searchForm.sellerId="",this.searchForm.customerId=this.searchForm.custId);var n={isTask:"1",type:this.searchForm.type,customerId:this.searchForm.customerId,objective:this.searchForm.objective,sellerId:this.searchForm.sellerId,status:this.searchForm.status,kscId:this.searchForm.kscId,number:this.searchForm.number,startDate:"",endDate:""};Array.isArray(r)&&r.length>0&&(n.startDate=r[0]+" 00:00:00",n.endDate=r[1]+" 23:59:59");var i={model:n,page:this.page,size:this.size};this.loading=!0,Object(p["b"])(i).then(function(t){if(e.loading=!1,t.success){var a=t.data||{};e.tableData=a.result||[],e.total=a.total}}).catch(function(t){return e.loading=!1,t})}},{key:"handleSizeChange",value:function(t){this.size=Number(t),this.loadData()}},{key:"handleCurrentChange",value:function(t){this.page=Number(t),this.loadData()}},{key:"created",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.custType,this.custSubtype,this.searchForm.custId=this.custId,this.searchForm.orderTime=[g()().subtract(30,"d").format("YYYY-MM-DD"),g()().format("YYYY-MM-DD")],this.loading=!0,t.next=7,this.getSubtypeList();case 7:this.loadData();case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"custId",get:function(){var t=v["a"].info||{},e=t.custId;return e}},{key:"custType",get:function(){var t=v["a"].info||{},e=t.custType;return e}},{key:"custSubtype",get:function(){var t=v["a"].info||{},e=t.custSubtype;return e}},{key:"parentId",get:function(){var t=v["a"].info||{},e=t.parentId;return e}},{key:"parentName",get:function(){var t=v["a"].info||{},e=t.parentName;return e}}]),e}(m["e"]);_=d["a"]([Object(m["a"])({name:"carOrder",components:{detail:f["a"]}})],_);var k=_,L=k,C=a("2877"),O=Object(C["a"])(L,r,n,!1,null,"5a85c531",null);e["default"]=O.exports},8099:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"detail-back"},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("back")}}},[a("i",{staticClass:"el-icon-back"}),a("span",[t._v("返回")])])]),a("div",{staticClass:"app-panel order-detail"},[a("el-form",{ref:"detail",staticClass:"detail-form",attrs:{model:t.form,"label-width":"130px","label-position":"right"}},[a("div",{staticClass:"form-title"},[a("el-row",[a("el-col",{attrs:{span:4}},[t._v("\n            基础信息\n          ")]),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}})],1)],1),a("div",{staticStyle:{padding:"0 20px"}},[a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","align-items":"top"}},[a("div",{staticStyle:{flex:"1 1 50%","border-right":"1px solid #F1F6FC"}},[a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"下单客户："}},[t._v("\n              "+t._s(t.form.customerName)+"\n            ")]),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"装货地址："}},[a("span",[t._v(t._s(t.form.consignorAddPick))])]),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"目的地："}},[a("span",[t._v(" "+t._s(t.form.warehouseAddress)+" ")])]),a("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"付款方式："}},["1"===t.form.pay?a("span",[t._v("\n                付款方式1\n              ")]):t._e(),"2"===t.form.pay?a("span",[t._v("\n                付款方式2\n              ")]):t._e()]),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"取货时间："}},[t._v("\n               "),a("span",[t._v(t._s(t.form.planTime))])]),t.form.remark?a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"备注："}},[t._v("\n              "+t._s(t.form.remark)+"\n            ")]):t._e()],1)])]),a("div",{staticClass:"form-title"},[t._v("\n        发货人\n      ")]),a("div",{staticStyle:{padding:"0 20px"}},[a("el-form-item",{attrs:{label:"发货人："}},[t._v("\n          "+t._s(t.form.consignor)+"\n        ")]),a("el-form-item",{attrs:{label:"联系电话："}},[t._v("\n          "+t._s(t.form.consignorPhone)+"\n        ")]),a("el-form-item",{attrs:{label:"联系地址："}},[t._v("\n          "+t._s(t.form.consignorAdd)+"\n        ")]),a("el-form-item",{attrs:{label:"邮编："}},[t._v("\n          "+t._s(t.form.consignorPostcode)+"\n        ")]),a("el-form-item",{attrs:{label:"详细地址："}},[a("div",{staticStyle:{"white-space":"nowrap"}},[t._v("\n            "+t._s(t.form.consignorAddDetails||"")+"\n          ")])])],1),a("div",{staticClass:"form-title"},[t._v("\n        收货人\n      ")]),a("div",{staticStyle:{padding:"0 20px"}},[a("el-form-item",{attrs:{label:"收货人："}},[t._v("\n          "+t._s(t.form.harvestMan)+"\n        ")]),a("el-form-item",{attrs:{label:"联系电话："}},[t._v("\n          "+t._s(t.form.harvestPhone)+"\n        ")]),a("el-form-item",{attrs:{label:"联系地址："}},[t._v("\n          "+t._s(t.form.harvestCountry)+" "+t._s(t.form.harvestProvince)+" "+t._s(t.form.harvestCity)+"\n        ")]),a("el-form-item",{attrs:{label:"邮编："}},[t._v("\n          "+t._s(t.form.harvestPostcode)+"\n        ")]),a("el-form-item",{attrs:{label:"详细地址："}},[a("div",{staticStyle:{"white-space":"nowrap"}},[t._v("\n            "+t._s(t.form.harvestAdd)+"\n          ")])])],1),a("div",{staticClass:"form-title"},[t._v("\n        货物信息\n      ")]),a("div",{staticStyle:{padding:"0 20px"}},[a("el-form-item",{attrs:{label:"拼箱/整柜："}},["1"===t.form.containerType?a("span",[t._v("\n            整柜\n          ")]):"0"===t.form.containerType?a("span",[t._v("\n            拼箱\n          ")]):a("span",[t._v("\n            --\n          ")])]),a("el-form-item",{attrs:{label:"车型/柜型："}},[t._v("\n          --\n        ")]),a("el-form-item",{attrs:{label:"总件数："}},[t._v("\n          "+t._s(t.form.total)+"\n        ")]),a("el-form-item",{attrs:{label:"总货值："}},[t._v("\n          "+t._s(t.form.cardValue)+" "+t._s(t.form.currencyId)+"\n        ")]),a("el-form-item",{attrs:{label:"总重量："}},[t._v("\n          "+t._s(t.$volumeConversion(t.form.weight,t.form.umWeight,"KGS"))+" kg\n        ")]),a("el-form-item",{attrs:{label:"总体积："}},[t._v("\n          "+t._s(t.$volumeConversion(t.form.volume,t.$getVolumeUnitByLengthUnit(t.form.umLength),"CBM"))+" m³\n        ")]),a("div",{staticStyle:{padding:"5px 0",background:"#F5F7FA"}},[a("el-form-item",{attrs:{label:"物流总运费："}},[t._v("\n            "+t._s(t.form.xxx)+"\n          ")]),a("el-form-item",{attrs:{label:"附加服务费："}},[t._v("\n            "+t._s(t.form.xxx)+"\n          ")]),a("el-form-item",{attrs:{label:"关税费用："}},[t._v("\n            "+t._s(t.form.xxx)+"\n          ")]),a("el-form-item",{attrs:{label:"附加关税："}},[t._v("\n            "+t._s(t.form.xxx)+"\n          ")])],1)],1)])],1)])},n=[],i=(a("7f7f"),a("d225")),s=a("b0b4"),o=a("308d"),c=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),m=a("9dba"),p=function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(o["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.wordsList=[],t}return Object(l["a"])(e,t),Object(s["a"])(e,[{key:"formatWarehouse",value:function(t){var e,a=this.wareList;return a.map(function(a){a.id===t&&(e=a.name)}),e}},{key:"volumesFilter",value:function(t,e){return"CM"===e?(1e-6*t).toFixed(3):"M"===e?t.toFixed(3):"INCH"===e?(164e-7*t).toFixed(3):"FT"===e?(.0283168*t).toFixed(3):void 0}},{key:"custType",get:function(){var t=m["a"].info||{},e=t.custType;return e}}]),e}(d["e"]);p=u["a"]([Object(d["a"])({name:"detail",components:{},props:{form:{type:Object,default:function(){return{}}},lineList:{type:Array,default:function(){return[]}},pickList:{type:Array,default:function(){return[]}},wareList:{type:Array,default:function(){return[]}}}})],p);var h=p,v=h,f=(a("af1b"),a("2877")),b=Object(f["a"])(v,r,n,!1,null,"3e2f1992",null);e["a"]=b.exports},"80f6":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"i"===t.showPage,expression:"showPage === 'i'"}],staticClass:"app-container"},[a("head-info",{attrs:{info:"",title:"调度任务"}}),a("div",{staticClass:"app-panel"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"订单状态",size:"small",clearable:"",filterable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"目的地",size:"small",clearable:"",filterable:"",loading:t.countryLoading},on:{focus:t.getCountryList},model:{value:t.searchForm.objective,callback:function(e){t.$set(t.searchForm,"objective",e)},expression:"searchForm.objective"}},t._l(t.countryList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name+"-"+t.alias,value:t.id}})}),1),a("el-date-picker",{staticStyle:{width:"240px","margin-right":"5px"},attrs:{clearable:!1,"unlink-panels":"",type:"daterange",align:"right",size:"small","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"下单起始时间","end-placeholder":"下单截止时间"},model:{value:t.searchForm.orderTime,callback:function(e){t.$set(t.searchForm,"orderTime",e)},expression:"searchForm.orderTime"}}),a("el-input",{staticClass:"input-with-select",staticStyle:{width:"200px","margin-right":"10px"},attrs:{clearable:"",placeholder:"原单号",size:"small"},model:{value:t.searchForm.number,callback:function(e){t.$set(t.searchForm,"number",e)},expression:"searchForm.number"}}),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["allocationQuery"],expression:"['allocationQuery']"}],attrs:{type:"primary",size:"small"},on:{click:function(e){return t.loadData(1)}}},[t._v("\n                查询\n              ")])],1)])],1),a("div",{staticClass:"table-wrap"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:t.tableData,height:"calc(100vh - 313px)",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{fixed:"left",type:"selection",width:"55"}}),a("el-table-column",{attrs:{fixed:"left",prop:"number",label:"原单号","min-width":"210"}}),a("el-table-column",{attrs:{fixed:"left",prop:"status",label:"订单状态","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("\n                  "+t._s((t.statusList.find(function(t){return t.id===e.row.status})||{}).name)+"\n                ")])]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"下单时间",width:"160"}}),a("el-table-column",{attrs:{prop:"goodsName",label:"业务类型",width:"120"}}),a("el-table-column",{attrs:{prop:"customerName",label:"下单客户","min-width":"150","show-overflow-tooltip":""}}),"0"===t.custType?a("el-table-column",{attrs:{prop:"orderCustomerName",label:"客户名称",width:"150","show-overflow-tooltip":""}}):t._e(),a("el-table-column",{attrs:{prop:"delivery",label:"提货方式",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.delivery?a("span",[t._v("自主送货")]):"1"===e.row.delivery?a("span",[t._v("上门提货")]):"2"===e.row.delivery?a("span",[t._v("快递发货")]):"3"===e.row.delivery?a("span",[t._v("整柜直装")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"planTime",label:"提货日期",width:"160"}}),a("el-table-column",{attrs:{prop:"destinationCountry",label:"目的地","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"pickTime",label:"送货日期",width:"160"}}),a("el-table-column",{attrs:{prop:"remake",label:"备注","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["getTask"],expression:"['getTask']"}],attrs:{type:"text",size:"small"},on:{click:function(a){return t.showDetail(e.row)}}},[t._v("\n                  查看\n                ")]),"0"===t.custId&&t.$checkPermission(["distributionTask"])?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.showModal(e.row)}}},[t._v("\n                  分配车辆\n                ")]):t._e(),"0"===t.custId&&t.$checkPermission(["distributionComplete"])?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.taskComplete(e.row)}}},[t._v("\n                  完成\n                ")]):t._e()]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":t.page,"page-size":t.size,layout:"total, prev, pager, next",total:t.total},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"d"===t.showPage,expression:"showPage === 'd'"}],staticClass:"app-container"},[a("detail",{ref:"detailForm",attrs:{form:t.detailData,"pick-list":t.pickList},on:{back:function(e){t.showPage="i"}}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"c"===t.showPage,expression:"showPage === 'c'"}],staticClass:"app-container"},[a("car-order-modal",{ref:"carOrderModal",on:{load:t.loadData,back:function(e){t.showPage="i"}}})],1)])])},n=[],i=(a("a481"),a("c5f6"),a("d225")),s=a("b0b4"),o=a("308d"),c=a("6bb5"),l=a("4e2b"),u=a("9ab4"),d=a("60a3"),m=a("8de4"),p=a("9dba"),h=a("8099"),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"detail-back"},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("back")}}},[a("i",{staticClass:"el-icon-back"}),a("span",[t._v("返回")])])]),a("div",{staticClass:"app-panel order-detail"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("div",{staticClass:"modal-top"},[a("div",{staticClass:"top-info-item"},[a("div",{staticClass:"label"},[t._v("\n            联系人：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.form.consignor)+"\n          ")])]),a("div",{staticClass:"top-info-item"},[a("div",{staticClass:"label"},[t._v("\n            联系电话：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.form.consignorPhone)+"\n          ")])]),a("div",{staticClass:"top-info-item"},[a("div",{staticClass:"label"},[t._v("\n            总重量：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.$volumeConversion(t.cardOrder.weight,t.cardOrder.umWeight,"KGS"))+" kg\n          ")])]),a("div",{staticClass:"top-info-item"},[a("div",{staticClass:"label"},[t._v("\n            总体积：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.$volumeConversion(t.cardOrder.volume,t.$getVolumeUnitByLengthUnit(t.cardOrder.umLength),"CBM"))+" m³\n          ")])]),a("div",{staticClass:"top-info-item w50"},[a("div",{staticClass:"label",staticStyle:{"white-space":"nowrap"}},[t._v("\n            装货地址：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.form.consignorAdd)+"\n          ")])]),a("div",{staticClass:"top-info-item w50"},[a("div",{staticClass:"label"},[t._v("\n            其他备注：\n          ")]),a("div",{staticClass:"value"},[t._v("\n            "+t._s(t.cardOrder.remark)+"\n          ")])])]),a("div",{staticClass:"card-list"},[a("el-form",{ref:"form",staticClass:"card-form",attrs:{model:t.cardListForm,size:"mini","label-width":"70px","label-position":"left"}},[a("el-form-item",{attrs:{label:"数量",prop:"cardNum"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",min:1,max:999999},on:{change:t.cardNumChange},model:{value:t.cardListForm.cardNum,callback:function(e){t.$set(t.cardListForm,"cardNum",e)},expression:"cardListForm.cardNum"}})],1),t._l(t.cardListForm.list,function(e,r){return a("el-row",{key:r,attrs:{gutter:10}},[a("el-col",{attrs:{span:2}},[a("div",{staticStyle:{"font-size":"14px",color:"#606266","font-weight":"400",height:"28px","line-height":"28px"}},[t._v("\n                "+t._s("车辆"+(r+1))+"\n              ")])]),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"服务",prop:"list."+r+".goodsId","label-width":"50px",rules:{required:!0,message:"请选择服务",trigger:"change"}}},[a("el-radio-group",{model:{value:t.cardListForm.list[r].goodsId,callback:function(e){t.$set(t.cardListForm.list[r],"goodsId",e)},expression:"cardListForm.list[index].goodsId"}},t._l(t.typeList,function(e){return a("el-radio",{key:e.id,attrs:{label:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])}),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"车辆",prop:"list."+r+".plateNumber","label-width":"50px",rules:{required:!0,message:"请选择车辆",trigger:"change"}}},[a("el-select",{attrs:{placeholder:"请选择车辆",size:"mini",clearable:"",filterable:""},on:{change:t.selectChange},model:{value:t.cardListForm.list[r].plateNumber,callback:function(e){t.$set(t.cardListForm.list[r],"plateNumber",e)},expression:"cardListForm.list[index].plateNumber"}},t._l(t.carList,function(t){return a("el-option",{key:t.plateNumber,attrs:{label:t.driverName+"-"+t.plateNumber,value:t.plateNumber,disabled:t.disabled}})}),1)],1)],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[0===r?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.confirm}},[t._v("\n                确认分配\n              ")]):a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.handlerDel(r)}}},[t._v("\n                删除\n              ")])],1)],1)})],2)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"car-container"},[a("div",{staticClass:"car-list"},[a("el-scrollbar",{staticStyle:{height:"100%"},attrs:{"wrap-class":"car-el-scrollbar-wrap","view-class":"car-el-scrollbar-view"}},t._l(t.carList,function(e,r){return a("div",{key:e.plateNumber,staticClass:"car-item",class:{active:e.plateNumber===t.selectDriver.plateNumber,recommend:0===r},on:{click:function(a){return t.getCarList(e)}}},[a("div",{staticClass:"number"},[t._v("\n                  "+t._s(e.plateNumber)+"\n                ")]),a("div",{staticClass:"name"},[t._v("\n                  "+t._s(e.driverName)+"\n                ")]),a("div",{staticClass:"status",class:"status"+e.workStatus})])}),0)],1),a("div",{staticClass:"car-bottom"},[a("span",[t._v("点击查看司机详细信息。已选择：")]),a("span",[t._v(t._s(t.selectDriver.plateNumber))])])]),a("div",{staticClass:"map-container",attrs:{id:"map-container"}})]),a("div",{staticClass:"driver"},[a("div",{staticClass:"title"},[t._v("\n          "+t._s(t.selectDriver.plateNumber)+"\n        ")]),a("div",{staticClass:"driver-info"},[a("div",{staticClass:"driver-info-item"},[a("span",{staticClass:"label"},[t._v("司机：")]),a("span",{staticClass:"value"},[t._v(t._s(t.selectDriver.driverName))])]),a("div",{staticClass:"driver-info-item"},[a("span",{staticClass:"label"},[t._v("联系电话：")]),a("span",{staticClass:"value"},[t._v(t._s(t.selectDriver.phone))])]),a("div",{staticClass:"driver-info-item"},[a("span",{staticClass:"label"},[t._v("证件类型：")]),0===t.selectDriver.certType?a("span",{staticClass:"value"},[t._v("身份证")]):t._e(),1===t.selectDriver.certType?a("span",{staticClass:"value"},[t._v("护照")]):t._e(),2===t.selectDriver.certType?a("span",{staticClass:"value"},[t._v("港澳通行证")]):t._e(),3===t.selectDriver.certType?a("span",{staticClass:"value"},[t._v("其他")]):t._e()]),a("div",{staticClass:"driver-info-item"},[a("span",{staticClass:"label"},[t._v("证件号码：")]),a("span",{staticClass:"value"},[t._v(t._s(t.selectDriver.certNo))])]),a("div",{staticClass:"driver-info-item"},[a("span",{staticClass:"label"},[t._v("是否带尾板：")]),a("span",{staticClass:"value"},[t._v(t._s(t.selectDriver.tailboard?"是":"否"))])]),a("div",{staticClass:"driver-info-item company"},[a("div",{staticClass:"label"},[t._v("\n              所属公司：\n            ")]),a("div",{staticClass:"value"},[t._v("\n              "+t._s(t.selectDriver.custName)+"\n            ")])])])]),a("div",{staticClass:"driver-order"},[a("div",{staticClass:"title"},[t._v("\n          订单实况\n        ")]),a("div",{staticClass:"order-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:t.tableData,"max-height":"400px",border:""}},[a("el-table-column",{attrs:{prop:"number",label:"原单号","min-width":"180"}}),a("el-table-column",{attrs:{prop:"volume",label:"提货方数","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.$volumeConversion(e.row.volume,t.$getVolumeUnitByLengthUnit(e.row.vunit),"CBM"))+" m³\n              ")]}}])}),a("el-table-column",{attrs:{prop:"deliveryTime",label:"提货时间","min-width":"180"}}),a("el-table-column",{attrs:{prop:"estimateTime",label:"预计到达","min-width":"180"}}),a("el-table-column",{attrs:{prop:"orderStatus",label:"订单状态","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return["0"===e.row.orderStatus?a("span",[t._v("待处理")]):t._e(),"1"===e.row.orderStatus?a("span",[t._v("已完成")]):t._e(),"2"===e.row.orderStatus?a("span",[t._v("已取消")]):t._e(),"3"===e.row.orderStatus?a("span",["0"===e.row.presentStatus&&"0"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(司机未到场)")]):t._e(),"1"===e.row.presentStatus&&"0"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(司机已到场)")]):t._e(),"1"===e.row.presentStatus&&"1"===e.row.completeStatus&&"0"===e.row.deliveryStatus?a("span",[t._v("进行中(已装车)")]):t._e(),"1"===e.row.presentStatus&&"1"===e.row.completeStatus&&"1"===e.row.deliveryStatus?a("span",[t._v("进行中(运输中)")]):t._e()]):t._e()]}}])})],1)],1)])])])])},f=[],b=a("75fc"),g=(a("55dd"),a("28a5"),a("ac6a"),a("7f7f"),a("96cf"),a("3b8d")),y=(a("7514"),function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(o["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.loading=!1,t.tableData=[],t.carList=[],t.tableLoading=!1,t.form={},t.cardListForm={cardNum:1,list:[{goodsId:"",plateNumber:""}]},t.cardOrder={},t.myMap={},t.pathSimplifierIns=null,t.selectDriver={},t.pathList=[],t.typeList=[],t}return Object(l["a"])(e,t),Object(s["a"])(e,[{key:"selectChange",value:function(){var t=this;this.carList=this.carList.map(function(e){return e.disabled=!1,t.cardListForm.list.find(function(t){return t.plateNumber===e.plateNumber})&&(e.disabled=!0),e})}},{key:"handlerDel",value:function(t){this.cardListForm.list.splice(t,1)}},{key:"cardNumChange",value:function(t){var e=this.cardListForm.list.length;if(t>e)for(var a=0;a<t-e;a++)this.cardListForm.list.push({goodsId:"",plateNumber:""});if(t<e)for(var r=0;r<e-t;r++)this.cardListForm.list.pop()}},{key:"initMap",value:function(){var t=this,e=window.AMap;t.myMap=new e.Map("map-container",{zoom:15})}},{key:"getSubtypeList",value:function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,Object(m["f"])({typeId:"01"}).then(function(t){e.loading=!1,t.success&&(e.typeList=t.data||[])}).catch(function(t){return e.loading=!1,t});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},{key:"confirm",value:function(){var t=this,e=this.$refs.form;e.validate(function(e){if(e){var a={id:t.cardOrder.id,source:t.cardOrder.source,list:t.cardListForm.list.map(function(e){var a=t.carList.find(function(t){return t.plateNumber===e.plateNumber})||{},r=t.typeList.find(function(t){return t.id===e.goodsId})||{};return{goodsId:e.goodsId,goodsName:r.name,operationUser:t.userInfo.id,operationPhone:t.userInfo.phone,custId:a.custId,custName:a.custName,driverId:a.driverId,driverName:a.driverName,phone:a.phone,plateNumber:a.plateNumber,cardType:a.cardType,userId:a.userId,estimateTime:t.cardOrder.planTime,orderCode:t.cardOrder.orderCode}})};t.loading=!0,Object(m["h"])(a).then(function(e){t.loading=!1,e.success&&(t.$message.success("分配车辆成功，请从卡派订单中查询对应的采购单！"),t.modalClose())}).catch(function(e){return t.loading=!1,e})}})}},{key:"showOrderPath",value:function(){var t=this;if(t.pathSimplifierIns){t.pathSimplifierIns.setData(t.pathList);var e=t.pathList.map(function(e,a){return t.pathSimplifierIns.createPathNavigator(a,{loop:!0,speed:1e4})});e.forEach(function(t){t.start()})}else{var a=window.AMapUI;a.load(["ui/misc/PathSimplifier","lib/$"],function(e,a){if(e.supportCanvas){t.pathSimplifierIns=new e({zIndex:100,map:t.myMap,getPath:function(t,e){return t.path},getHoverTitle:function(t,e,a){return 0===a?"装货位置":1===a?"目的地":"原单号："+t.name},renderOptions:{renderAllPointsIfNumberBelow:100}}),t.pathSimplifierIns.setData(t.pathList);var r=t.pathList.map(function(e,a){return t.pathSimplifierIns.createPathNavigator(a,{loop:!0,speed:1e4})});r.forEach(function(t){t.start()})}else alert("当前环境不支持 Canvas！")}),t.myMap.zoomOut()}}},{key:"show",value:function(){var t=Object(g["a"])(regeneratorRuntime.mark(function t(e){var a,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.cardOrder||{},this.cardOrder=e.cardOrder||{},this.tableData=[],this.cardListForm={cardNum:1,list:[{goodsId:"",plateNumber:""}]},t.next=6,this.getSubtypeList();case 6:this.form={consignor:e.cardPackingList[0]?e.cardPackingList[0].consignor||a.warehouseContact:"",consignorPhone:e.cardPackingList[0]?e.cardPackingList[0].consignorPhone||a.warehouseTel:"",consignorAdd:e.cardPackingList[0]?e.cardPackingList[0].consignorAdd||a.warehouseAddress:""},this.getCarList(),this.$nextTick(function(){var t=r.$refs.form;t.clearValidate(),r.initMap()});case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"selectDriverClick",value:function(t){var e=this;this.pathList=[],this.selectDriver=t,this.tableData=t.orderList;var a=[];if(this.cardOrder.packLongitudeLatitude){var r=this.cardOrder.packLongitudeLatitude.split(",").map(function(t){return Number(t)});a.push(r)}if(this.cardOrder.warehouseLongitudeLatitude){var n=this.cardOrder.warehouseLongitudeLatitude.split(",").map(function(t){return Number(t)});a.push(n)}this.pathList.push({name:this.cardOrder.number,path:a}),t.orderList&&t.orderList.length&&t.orderList.forEach(function(t){var a=[];if(t.startLongitudeLatitude){var r=t.startLongitudeLatitude.split(",").map(function(t){return Number(t)});a.push(r)}if(t.objectiveLongitudeLatitude){var n=t.objectiveLongitudeLatitude.split(",").map(function(t){return Number(t)});a.push(n)}t.startLongitudeLatitude&&t.objectiveLongitudeLatitude&&e.pathList.push({name:t.number,path:a})}),this.$nextTick(function(){e.showOrderPath()})}},{key:"modalClose",value:function(){this.$emit("load"),this.pathList=[],this.pathSimplifierIns=null,this.$emit("back")}},{key:"getCarList",value:function(t){var e=this,a={longitudeLatitude:this.cardOrder.packLongitudeLatitude,packDate:this.cardOrder.planTime};this.loading=!0,Object(m["a"])(a).then(function(a){if(e.loading=!1,a.success){var r=a.data.filter(function(t){return-1===t.distance}),n=a.data.filter(function(t){return-1!==t.distance}).sort(function(t,e){return t.distance-e.distance}).sort(function(t,e){return e.workStatus-t.workStatus});e.carList=[].concat(Object(b["a"])(n),Object(b["a"])(r));var i=e.carList[0]||{};t&&(i=e.carList.find(function(e){return e.plateNumber===t.plateNumber})||{}),e.selectDriverClick(i)}}).catch(function(t){return e.loading=!1,t})}},{key:"userInfo",get:function(){return p["a"].info||{}}}]),e}(d["e"]));y=u["a"]([Object(d["a"])({name:"CarOrderModal"})],y);var w=y,_=w,k=(a("e31e"),a("2877")),L=Object(k["a"])(_,v,f,!1,null,"78c6cc2a",null),C=L.exports,O=a("5a0c"),x=a.n(O),S=function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(o["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.detailData={},t.showPage="i",t.loading=!1,t.countryLoading=!1,t.serviceLoading=!1,t.lscLoading=!1,t.selectLoading=!1,t.statusList=[{name:"待分配",id:"0"},{name:"司机取消订单",id:"3"},{name:"完成调度",id:"60"}],t.countryList=[],t.selectRows=[],t.tableData=[],t.orderTypeList=[{name:"销售订单",id:"0"},{name:"采购订单",id:"1"}],t.companyTypeList=[{id:"1",name:"客户"},{id:"2",name:"二级代理商"}],t.pickList=[{name:"自主送货",id:"0"},{name:"上门提货",id:"1"},{name:"快递发货",id:"2"},{name:"整柜直装",id:"3"}],t.page=1,t.size=10,t.total=0,t.searchForm={lscId:void 0,customerId:void 0,objective:void 0,sellerId:void 0,status:void 0,kscId:void 0,number:"",orderType:"0",comType:"",comId:"",orderTime:[]},t}return Object(l["a"])(e,t),Object(s["a"])(e,[{key:"taskComplete",value:function(t){var e=this;this.$confirm("您确认该任务单已完成调度吗?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:t.id,status:"60"};e.loading=!0,Object(m["i"])(a).then(function(){e.loading=!1,e.$message.success("操作成功"),e.loadData(1)}).catch(function(){e.loading=!1})}).catch(function(){return!1})}},{key:"thirdparty",value:function(t){}},{key:"handleSelectionChange",value:function(t){this.selectRows=t}},{key:"showModal",value:function(t){var e=this,a=this.$refs.carOrderModal,r={id:t.id};this.loading=!0,Object(m["e"])(r).then(function(t){if(e.loading=!1,t.success){e.showPage="c";var r=t.data||{};a.show(r)}}).catch(function(t){return e.loading=!1,t})}},{key:"showDetail",value:function(t){var e=this,a={id:t.id};this.loading=!0,Object(m["e"])(a).then(function(t){if(e.loading=!1,t.success){var a=t.data||{},r=a.cardOrder,n=a.cardPackingList||[];e.detailData={customerName:r.customerName,consignorAdd:r.consignorAdd,consignorAddPick:(n[0]||{}).consignorAdd||r.warehouseAddress,consignorAddDetails:r.consignorCountry+r.consignorProvince+r.consignorCity+r.consignorAdd,warehouseAddress:r.warehouseAddress,pay:r.pay,planTime:r.planTime,remark:r.remark,consignor:r.consignor,consignorPhone:r.consignorPhone,consigneeCountry:r.consigneeCountry,consigneeProvince:r.consigneeProvince,consigneeCity:r.consigneeCity,consignorPostcode:r.consignorPostcode,harvestMan:r.harvestMan,harvestPhone:r.harvestPhone,harvestCountry:r.harvestCountry,harvestProvince:r.harvestProvince,harvestCity:r.harvestCity,harvestPostcode:r.harvestPostcode,harvestAdd:r.harvestAdd,containerType:r.cabinetType,total:r.total,cardValue:r.cardValue,currencyId:r.currencyId,weight:r.weight,volume:r.volume,umLength:r.umLength,umWeight:r.umWeight},e.showPage="d"}}).catch(function(t){return e.loading=!1,t})}},{key:"getCountryList",value:function(){var t=this;this.countryLoading=!0,Object(m["c"])().then(function(e){var a=e.data||{};t.countryList=a.result||[],t.countryLoading=!1}).catch(function(e){return t.countryLoading=!1,e})}},{key:"loadData",value:function(t){var e=this;1===t&&(this.page=1);var a=this.searchForm.orderTime,r={isTask:"0",lscId:this.searchForm.lscId,customerId:"",objective:this.searchForm.objective,sellerId:"",status:this.searchForm.status,kscId:this.searchForm.kscId,number:this.searchForm.number,startDate:"",endDate:""};Array.isArray(a)&&a.length>0&&(r.startDate=a[0]+" 00:00:00",r.endDate=a[1]+" 23:59:59");var n={model:r,page:this.page,size:this.size};this.loading=!0,Object(m["b"])(n).then(function(t){if(e.loading=!1,t.success){var a=t.data||{};e.tableData=a.result||[],e.total=a.total}}).catch(function(t){return e.loading=!1,t})}},{key:"handleSizeChange",value:function(t){this.size=Number(t),this.loadData()}},{key:"handleCurrentChange",value:function(t){this.page=Number(t),this.loadData()}},{key:"created",value:function(){"0"!==this.custId&&this.$router.replace("404"),this.searchForm.orderTime=[x()().subtract(30,"d").format("YYYY-MM-DD"),x()().format("YYYY-MM-DD")],this.loadData()}},{key:"custId",get:function(){var t=p["a"].info||{},e=t.custId;return e}},{key:"custType",get:function(){var t=p["a"].info||{},e=t.custType;return e}},{key:"custSubtype",get:function(){var t=p["a"].info||{},e=t.custSubtype;return e}},{key:"parentId",get:function(){var t=p["a"].info||{},e=t.parentId;return e}},{key:"parentName",get:function(){var t=p["a"].info||{},e=t.parentName;return e}}]),e}(d["e"]);S=u["a"]([Object(d["a"])({name:"carOrder",components:{detail:h["a"],CarOrderModal:C}})],S);var j=S,F=j,I=Object(k["a"])(F,r,n,!1,null,"0469f55f",null);e["default"]=I.exports},"8de4":function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"c",function(){return i}),a.d(e,"d",function(){return s}),a.d(e,"a",function(){return o}),a.d(e,"i",function(){return c}),a.d(e,"e",function(){return l}),a.d(e,"h",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"g",function(){return m});var r=a("b32d");function n(t){var e={url:"/orders/card/get_data",method:"post",data:t};return Object(r["a"])(e)}function i(){var t={url:"/setting/area/getCountryList",method:"get"};return Object(r["a"])(t)}function s(t){var e={url:"/cfg/ksc/getKscList",method:"post",data:t};return Object(r["a"])(e)}function o(t){var e={url:"/orders/card/get_card",method:"post",data:t};return Object(r["a"])(e)}function c(t){var e={url:"/orders/card/complete_task",method:"post",data:t};return Object(r["a"])(e)}function l(t){var e={url:"/orders/card/get_pack",method:"post",params:t};return Object(r["a"])(e)}function u(t){var e={url:"/orders/card/assign_driver",method:"post",data:t};return Object(r["a"])(e)}function d(t){var e={url:"/cfg/type/getServiceSubtypeList",method:"get",params:t};return Object(r["a"])(e)}function m(t){var e={url:"/orders/card/get_vehicles",method:"get",params:t};return Object(r["a"])(e)}},af1b:function(t,e,a){"use strict";var r=a("444f"),n=a.n(r);n.a},af5a:function(t,e,a){"use strict";a.d(e,"m",function(){return n}),a.d(e,"g",function(){return i}),a.d(e,"l",function(){return s}),a.d(e,"t",function(){return o}),a.d(e,"i",function(){return c}),a.d(e,"x",function(){return l}),a.d(e,"q",function(){return u}),a.d(e,"A",function(){return d}),a.d(e,"h",function(){return m}),a.d(e,"r",function(){return p}),a.d(e,"n",function(){return h}),a.d(e,"c",function(){return v}),a.d(e,"B",function(){return f}),a.d(e,"f",function(){return b}),a.d(e,"w",function(){return g}),a.d(e,"s",function(){return y}),a.d(e,"v",function(){return w}),a.d(e,"d",function(){return _}),a.d(e,"e",function(){return k}),a.d(e,"k",function(){return L}),a.d(e,"j",function(){return C}),a.d(e,"p",function(){return O}),a.d(e,"o",function(){return x}),a.d(e,"y",function(){return S}),a.d(e,"z",function(){return j}),a.d(e,"a",function(){return F}),a.d(e,"b",function(){return I}),a.d(e,"C",function(){return T}),a.d(e,"u",function(){return N});var r=a("b32d");function n(t){var e={url:"/setting/fbastore/getFbastoreList",method:"get",params:t};return Object(r["a"])(e)}function i(t){var e={url:"/auth/agent/getAgentList",method:"get",params:t};return Object(r["a"])(e)}function s(t){var e={url:"/auth/customer/customer",method:"post",data:t};return Object(r["a"])(e)}function o(t){var e={url:"/orders/declare_order/get_declare_data",method:"post",data:t};return Object(r["a"])(e)}function c(t){var e={url:"/orders/declare_order/container_view",method:"post",data:t};return Object(r["a"])(e)}function l(t){var e={url:"/orders/declare_order/container_update",method:"post",data:t};return Object(r["a"])(e)}function u(t){var e={url:"/orders/declareInvoice/getInfoByNo",method:"get",params:t};return Object(r["a"])(e)}function d(t){var e={url:"/orders/declareInvoice/update",method:"post",data:t};return Object(r["a"])(e)}function m(t){var e={url:"/orders/declarePackages/getInfoByNo",method:"get",params:t};return Object(r["a"])(e)}function p(t){var e={url:"/orders/declare_order/container_declare",method:"get",params:t};return Object(r["a"])(e)}function h(t){var e={url:"/orders/containFile/getPathByNo",method:"get",params:t};return Object(r["a"])(e)}function v(t){var e={url:"/orders/containFile/delete",method:"get",params:t};return Object(r["a"])(e)}function f(t){var e={url:"/orders/containFile/saveContainFile",method:"post",data:t};return Object(r["a"])(e)}function b(t){var e={url:"/orders/declare_order/export",method:"post",params:t,responseType:"blob"};return Object(r["a"])(e)}function g(t){var e={url:"/orders/worder/generateOrder",method:"post",data:t};return Object(r["a"])(e)}function y(t){var e={url:"/orders/worder/getWarehouseOrder",method:"get",params:t};return Object(r["a"])(e)}function w(t){var e={url:"/report/r/tag",method:"get",params:t};return Object(r["a"])(e)}function _(t){var e={url:"/orders/worder/deleteOrder",method:"delete",params:t};return Object(r["a"])(e)}function k(t){var e={url:"/orders/worder/deletePallet",method:"delete",params:t};return Object(r["a"])(e)}function L(t){var e={url:"/auth/custtype/getCustTypeList",method:"get",params:t};return Object(r["a"])(e)}function C(t){var e={url:"/auth/custtype/getcustlist",method:"post",data:t};return Object(r["a"])(e)}function O(t){var e={url:"/orders/declare_order/get_file_data",method:"post",params:t};return Object(r["a"])(e)}function x(t){var e={url:"/setting/fc/page",method:"post",data:t};return Object(r["a"])(e)}function S(t){var e={url:"/orders/declare_order/update",method:"post",data:t};return Object(r["a"])(e)}function j(t){var e={url:"/orders/declare_order/save_file",method:"post",data:t};return Object(r["a"])(e)}function F(t){var e={url:"/orders/declare_order/audit_file",method:"post",data:t};return Object(r["a"])(e)}function I(t){var e={url:"/orders/declare_order/jht_audit",method:"get",params:t};return Object(r["a"])(e)}function T(t){var e={url:"/orders/declare_order/assign",method:"post",data:t};return Object(r["a"])(e)}function N(t){var e={url:"/orders/declare_order/get_supply",method:"get",params:t};return Object(r["a"])(e)}},e31e:function(t,e,a){"use strict";var r=a("0afc"),n=a.n(r);n.a}}]);