(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["warehouse-order"],{1:function(e,t){},"1c0c":function(e,t,r){"use strict";var n=r("c4dc"),a=r.n(n);a.a},2:function(e,t){},"254e":function(e,t,r){"use strict";r.d(t,"p",function(){return a}),r.d(t,"z",function(){return i}),r.d(t,"m",function(){return o}),r.d(t,"q",function(){return s}),r.d(t,"B",function(){return c}),r.d(t,"i",function(){return l}),r.d(t,"K",function(){return u}),r.d(t,"A",function(){return d}),r.d(t,"b",function(){return m}),r.d(t,"x",function(){return p}),r.d(t,"C",function(){return f}),r.d(t,"w",function(){return h}),r.d(t,"a",function(){return v}),r.d(t,"v",function(){return y}),r.d(t,"I",function(){return b}),r.d(t,"D",function(){return g}),r.d(t,"g",function(){return w}),r.d(t,"j",function(){return _}),r.d(t,"E",function(){return x}),r.d(t,"c",function(){return O}),r.d(t,"L",function(){return k}),r.d(t,"k",function(){return S}),r.d(t,"r",function(){return j}),r.d(t,"F",function(){return C}),r.d(t,"l",function(){return L}),r.d(t,"d",function(){return T}),r.d(t,"n",function(){return I}),r.d(t,"G",function(){return D}),r.d(t,"o",function(){return F}),r.d(t,"e",function(){return N}),r.d(t,"s",function(){return $}),r.d(t,"H",function(){return R}),r.d(t,"u",function(){return B}),r.d(t,"t",function(){return A}),r.d(t,"f",function(){return z}),r.d(t,"y",function(){return P}),r.d(t,"J",function(){return E}),r.d(t,"h",function(){return M}),r.d(t,"M",function(){return Y});var n=r("b32d");function a(){var e={url:"/setting/area/getCountryList",method:"get"};return Object(n["a"])(e)}function i(e){var t={url:"/setting/area/getStateByCountry",method:"get",params:{countryId:e}};return Object(n["a"])(t)}function o(e){var t={url:"/setting/area/getCityByState",method:"get",params:{stateId:e}};return Object(n["a"])(t)}function s(e){var t={url:"/setting/area/getCountyByCity",method:"get",params:{cityId:e}};return Object(n["a"])(t)}function c(e){var t={url:"/auth/supplier/getSupplierList",method:"get",params:e};return Object(n["a"])(t)}function l(e){var t={url:"/auth/supplier/deleteSupplier",method:"delete",params:{id:e}};return Object(n["a"])(t)}function u(e){var t={url:"/auth/supplier/saveSupplier",method:"post",data:e};return Object(n["a"])(t)}function d(e){var t={url:"/auth/supplier/getSupplier",method:"get",params:{id:e}};return Object(n["a"])(t)}function m(e){var t={url:"/auth/supplier/changeStatus",method:"post",params:e};return Object(n["a"])(t)}function p(){var e={url:"/cfg/type/getServiceTypeList",method:"get",params:{custType:1}};return Object(n["a"])(e)}function f(e){var t={url:"/auth/user/user4position",method:"post",data:e};return Object(n["a"])(t)}function h(e){var t={url:"/auth/supplier/getStaffList",method:"get",params:e};return Object(n["a"])(t)}function v(e){var t={url:"/auth/supplier/saveStaff",method:"post",data:e};return Object(n["a"])(t)}function y(e){var t={url:"/auth/contact/getContactList",method:"get",params:e};return Object(n["a"])(t)}function b(e){var t={url:"/auth/contact/saveContact",method:"post",data:e};return Object(n["a"])(t)}function g(e){var t={url:"/auth/contact/getContact",method:"get",params:e};return Object(n["a"])(t)}function w(e){var t={url:"/auth/contact/deleteContact",method:"delete",params:e};return Object(n["a"])(t)}function _(e){var t={url:"/auth/address/getAddressList",method:"get",params:e};return Object(n["a"])(t)}function x(e){var t={url:"/auth/address/saveAddress",method:"post",data:e};return Object(n["a"])(t)}function O(e){var t={url:"/auth/address/deleteAddress",method:"delete",params:e};return Object(n["a"])(t)}function k(e){var t={url:"/auth/address/setAddressDefault",method:"post",params:e};return Object(n["a"])(t)}function S(e){var t={url:"/auth/invoice/getInvoiceList",method:"get",params:e};return Object(n["a"])(t)}function j(e){var t={url:"/setting/currency/getCurrencyList",method:"get",params:e};return Object(n["a"])(t)}function C(e){var t={url:"/auth/invoice/saveInvoice",method:"post",data:e};return Object(n["a"])(t)}function L(e){var t={url:"/auth/invoice/getInvoice",method:"get",params:e};return Object(n["a"])(t)}function T(e){var t={url:"/auth/invoice/deleteInvoice",method:"delete",params:e};return Object(n["a"])(t)}function I(e){var t={url:"/auth/acct/getAcctList",method:"get",params:e};return Object(n["a"])(t)}function D(e){var t={url:"/auth/acct/saveAcct",method:"post",data:e};return Object(n["a"])(t)}function F(e){var t={url:"/auth/acct/getAcct",method:"get",params:e};return Object(n["a"])(t)}function N(e){var t={url:"/auth/acct/deleteAcct",method:"delete",params:e};return Object(n["a"])(t)}function $(e){var t={url:"/auth/doc/getDocList",method:"get",params:e};return Object(n["a"])(t)}function R(e){var t={url:"/auth/doc/saveDoc",method:"post",data:e};return Object(n["a"])(t)}function B(e){var t={url:"/setting/util/getFileUrl",method:"get",params:e};return Object(n["a"])(t)}function A(e){var t={url:"/auth/doc/getDoc",method:"get",params:e};return Object(n["a"])(t)}function z(e){var t={url:"/auth/doc/deleteDoc",method:"delete",params:e};return Object(n["a"])(t)}function P(e){var t={url:"/auth/bookc/getBookcList",method:"get",params:e};return Object(n["a"])(t)}function E(e){var t={url:"/auth/bookc/saveBookc",method:"post",data:e};return Object(n["a"])(t)}function M(e){var t={url:"/auth/bookc/deleteBookc",method:"delete",params:e};return Object(n["a"])(t)}function Y(e){var t={url:"/auth/bookc/setBookcDefault",method:"post",params:e};return Object(n["a"])(t)}},3:function(e,t){},"3df3":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[r("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:"i"===e.detailShow,expression:"detailShow === 'i'"}],staticClass:"app-container"},[r("head-info",{attrs:{info:"",title:"仓库订单"},scopedSlots:e._u([{key:"option",fn:function(){return[r("el-button",{attrs:{loading:e.excelLoading,type:"primary",size:"small"},on:{click:e.handleExport}},[e._v("\n            导出当前数据\n          ")])]},proxy:!0}])}),r("div",{staticClass:"app-panel"},[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.showPrint("1")}}},[e._v("\n              打印入仓单\n            ")]),r("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){return e.showPrint("2")}}},[e._v("\n              打印唛头\n            ")])],1),r("el-col",{attrs:{span:20}},[r("div",{staticStyle:{"text-align":"right"}},["0"===e.custType||"2"===e.custType?r("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"订单类型",size:"small"},on:{change:e.onOrderType},model:{value:e.searchForm.orderType,callback:function(t){e.$set(e.searchForm,"orderType",t)},expression:"searchForm.orderType"}},e._l(e.orderTypeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),"2"===e.custType&&"1"===e.custSubtype&&"0"===e.searchForm.orderType?r("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"公司类型",clearable:""},on:{change:e.onComType},model:{value:e.searchForm.comType,callback:function(t){e.$set(e.searchForm,"comType",t)},expression:"searchForm.comType"}},e._l(e.companyTypeList,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):e._e(),"0"!==e.custType&&"2"!==e.custType||"0"!==e.searchForm.orderType?e._e():r("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.searchForm.comId,callback:function(t){e.$set(e.searchForm,"comId",t)},expression:"searchForm.comId"}},e._l(e.companyList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),r("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{loading:e.selectLoading,placeholder:"订单状态",size:"small",clearable:"",filterable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l("3"===e.searchForm.type?e.orderStatusList2:e.statusList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),r("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"业务类型",filterable:""},on:{change:e.typeChange},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},e._l(e.typeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),"2"===e.searchForm.type?r("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"订单来源",clearable:"",filterable:""},model:{value:e.searchForm.from,callback:function(t){e.$set(e.searchForm,"from",t)},expression:"searchForm.from"}},[r("el-option",{attrs:{label:"客户端",value:"web"}}),r("el-option",{attrs:{label:"专线",value:"line"}})],1):e._e(),r("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"仓库",clearable:"",filterable:""},on:{focus:e.getWarehouseList},model:{value:e.searchForm.warehouseId,callback:function(t){e.$set(e.searchForm,"warehouseId",t)},expression:"searchForm.warehouseId"}},e._l(e.warehouseList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),r("el-date-picker",{staticStyle:{width:"240px","margin-right":"5px"},attrs:{clearable:!1,"unlink-panels":"",type:"daterange",align:"right",size:"small","value-format":"yyyy-MM-dd","range-separator":"~","start-placeholder":"下单起始时间","end-placeholder":"下单截止时间"},model:{value:e.searchForm.orderTime,callback:function(t){e.$set(e.searchForm,"orderTime",t)},expression:"searchForm.orderTime"}}),r("el-input",{staticClass:"input-with-select",staticStyle:{width:"240px","margin-right":"10px"},attrs:{placeholder:"请输入内容",size:"small",clearable:""},model:{value:e.searchForm.code,callback:function(t){e.$set(e.searchForm,"code",t)},expression:"searchForm.code"}},["3"!==e.searchForm.type?r("template",{slot:"prepend"},[e._v("\n                  原单号\n                ")]):r("template",{slot:"prepend"},[r("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},[r("el-option",{attrs:{label:"订单号",value:"1"}}),r("el-option",{attrs:{label:"柜号",value:"2"}})],1)],1)],2),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderQuery"],expression:"['warehouseOrderQuery']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getTableData(1)}}},[e._v("\n                查询\n              ")])],1)])],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"3"!==e.searchForm.type,expression:"searchForm.type !== '3'"}]},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 313px)",border:""}},[r("el-table-column",{attrs:{fixed:"left",prop:"code",label:"原单号",width:"160"}}),r("el-table-column",{attrs:{formatter:e.formmatStatus,label:"订单状态",width:"100"}}),r("el-table-column",{attrs:{formatter:e.formmatType,label:"业务类型",width:"100"}}),r("el-table-column",{directives:[{name:"show",rawName:"v-show",value:"2"===e.searchForm.type,expression:"searchForm.type === '2'"}],attrs:{label:"订单来源",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["web"===t.row.from?r("span",[e._v("客户端")]):"line"===t.row.from?r("span",[e._v("专线")]):r("span",[e._v("--")])]}}])}),r("el-table-column",{directives:[{name:"show",rawName:"v-show",value:"2"===e.searchForm.type,expression:"searchForm.type === '2'"}],attrs:{label:"渠道","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s((t.row.service||{}).value||"--")+"\n                ")])]}}])}),r("el-table-column",{attrs:{prop:"createTime",label:"下单时间",width:"180"}}),r("el-table-column",{attrs:{label:"下单客户","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s((t.row.buyer||{}).name)+"\n                ")])]}}])}),r("el-table-column",{attrs:{label:"客户名称","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s((t.row.orderCustomer||{}).name)+"\n                ")])]}}])}),r("el-table-column",{attrs:{label:"下单仓库","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s((t.row.warehouse||{}).name)+"\n                ")])]}}])}),r("el-table-column",{attrs:{formatter:e.formmatLoading,label:"装货方式",width:"150"}}),r("el-table-column",{attrs:{prop:"",label:"箱数","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v("理论："+e._s(t.row.packages))]),r("div",[e._v("实际："+e._s((t.row.measure||{}).packages))])]}}])}),r("el-table-column",{attrs:{prop:"",label:"体积","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v("理论："+e._s(e.$volumeConversion(t.row.volumes,e.$getVolumeUnitByLengthUnit((t.row.um||{}).umLength),"CBM"))+" CBM")]),r("div",[e._v("实际："+e._s(e.$volumeConversion((t.row.measure||{}).totalVolume,"CBCM","CBM"))+" CBM")])]}}])}),r("el-table-column",{attrs:{prop:"",label:"重量","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v("理论："+e._s(e.$volumeConversion(t.row.weights,e.$getVolumeUnitByLengthUnit((t.row.um||{}).umWeight),"KGS"))+" KGS")]),r("div",[e._v("实际："+e._s((t.row.measure||{}).totalWeight)+" KGS")])]}}])}),r("el-table-column",{attrs:{prop:"remark",label:"备注","min-width":"120","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderGet"],expression:"['warehouseOrderGet']"}],attrs:{type:"text"},on:{click:function(r){return e.viewData(t.row)}}},[e._v("\n                  查看\n                ")]),"0"===t.row.status&&"1"===e.searchForm.orderType&&e.$checkPermission(["warehouseOrderDel"])?r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.deleteData(t.row)}}},[e._v("\n                  删除\n                ")]):e._e(),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderFinancial"],expression:"['warehouseOrderFinancial']"}],attrs:{type:"text"},on:{click:function(r){return e.showFinancial(t.row)}}},[e._v("\n                  账单信息\n                ")]),("0"===e.custType||"3"===e.custType)&&t.row.express&&t.row.express.trackingNos?r("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[r("span",{staticClass:"el-dropdown-link",on:{click:function(r){return e.handleMore(t.row)}}},[e._v("\n                    更多\n                    "),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[("0"===e.custType||"3"===e.custType)&&t.row.express&&t.row.express.trackingNos?r("el-dropdown-item",{attrs:{command:"1"}},[e._v("\n                      下载快递标签ZIP\n                    ")]):e._e(),("0"===e.custType||"3"===e.custType)&&t.row.express&&t.row.express.trackingNos?r("el-dropdown-item",{attrs:{command:"2"}},[e._v("\n                      下载快递标签PDF\n                    ")]):e._e(),("0"===e.custType||"3"===e.custType)&&t.row.express&&t.row.express.trackingNos?r("el-dropdown-item",{attrs:{command:"6"}},[e._v("\n                      下载快递标签PDF(马赛克)\n                    ")]):e._e(),("0"===e.custType||"3"===e.custType)&&t.row.express&&t.row.express.trackingNos?r("el-dropdown-item",{attrs:{command:"3"}},[e._v("\n                      下载指定快递标签\n                    ")]):e._e()],1)],1):e._e()]}}])})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"3"===e.searchForm.type,expression:"searchForm.type === '3'"}]},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableList,height:"calc(100vh - 313px)",border:""}},[r("el-table-column",{attrs:{fixed:"left",prop:"code",label:"订单号",width:"160"}}),r("el-table-column",{attrs:{fixed:"left",label:"原单号",width:"160",formatter:e.formmatCode}}),r("el-table-column",{attrs:{formatter:e.formmatStatus2,label:"订单状态",width:"100"}}),r("el-table-column",{attrs:{formatter:e.formmatType,label:"业务类型",width:"100"}}),r("el-table-column",{attrs:{prop:"createTime",label:"下单时间",width:"180"}}),r("el-table-column",{attrs:{label:"下单客户","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s(t.row.orderCustomer)+"\n                ")])]}}])}),r("el-table-column",{attrs:{label:"客户名称","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s(t.row.custName)+"\n                ")])]}}])}),r("el-table-column",{attrs:{label:"下单仓库","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("\n                  "+e._s((t.row.warehouse||{}).name)+"\n                ")])]}}])}),r("el-table-column",{attrs:{label:"装货方式",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.loadingType+""==="1"?r("span",[e._v("\n                  托盘\n                ")]):t.row.loadingType+""==="0"?r("span",[e._v("\n                  箱子\n                ")]):t.row.loadingType+""==="2"?r("span",[e._v("\n                  家具等超大件\n                ")]):e._e()]}}])}),r("el-table-column",{attrs:{prop:"totalBox",label:"箱数",width:"120"}}),r("el-table-column",{attrs:{prop:"",label:"体积","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.totalVolume)+" "+e._s((t.row.um||{}).umVolume)+"\n              ")]}}])}),r("el-table-column",{attrs:{prop:"",label:"重量","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.totalWeight)+" "+e._s((t.row.um||{}).umWeight)+"\n              ")]}}])}),r("el-table-column",{attrs:{prop:"remarks",label:"备注","min-width":"120","show-overflow-tooltip":""}}),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderGet"],expression:"['warehouseOrderGet']"}],attrs:{type:"text"},on:{click:function(r){return e.viewData(t.row)}}},[e._v("\n                  查看\n                ")]),1!==t.row.openTankTask&&e.$checkPermission(["addRemoval"])?r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.addRemoval(t.row)}}},[e._v("\n                  生成拆柜\n                ")]):e._e(),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderFinancial"],expression:"['warehouseOrderFinancial']"}],attrs:{type:"text"},on:{click:function(r){return e.showFinancial(t.row)}}},[e._v("\n                  账单信息\n                ")])]}}])})],1)],1),r("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"d"===e.detailShow,expression:"detailShow === 'd'"}],staticClass:"app-container"},["3"!==e.searchForm.type?r("detail",{ref:"detailForm",on:{back:function(t){e.detailShow="i"}}}):e._e(),"3"===e.searchForm.type?r("detail2",{ref:"detailForm",on:{back:function(t){e.detailShow="i"}}}):e._e()],1),r("div",{directives:[{name:"show",rawName:"v-show",value:"f"===e.detailShow,expression:"detailShow === 'f'"}],staticClass:"app-container"},[r("order-financial",{ref:"financial",on:{back:function(t){e.detailShow="i"}}})],1)]),r("el-dialog",{attrs:{title:"客户信息",width:"600px","close-on-click-modal":!1,visible:e.isCustomerVisible},on:{"update:visible":function(t){e.isCustomerVisible=t},close:e.cancel}},[r("div",[e._v("弹框")])]),r("el-dialog",{attrs:{title:"操作日志",width:"600px","close-on-click-modal":!1,visible:e.isLogVisible},on:{"update:visible":function(t){e.isLogVisible=t},close:e.cancel}},[r("div",[e._v("弹框")])]),r("el-dialog",{attrs:{title:"1"===e.printType?"打印入仓单":"打印唛头",width:"500px","close-on-click-modal":!1,visible:e.printShow},on:{"update:visible":function(t){e.printShow=t}}},[r("div",{staticStyle:{display:"flex","align-items":"center"}},[r("span",[e._v("原单号：")]),r("el-input",{staticStyle:{flex:"1"},attrs:{size:"small",placeholder:"请输入原单号"},model:{value:e.printCode,callback:function(t){e.printCode=t},expression:"printCode"}})],1),r("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.printShow=!1}}},[e._v("\n        取 消\n      ")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.printClick}},[e._v("\n        打 印\n      ")]),"1"!==e.printType?r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.printClickNew}},[e._v("\n        打印新版\n      ")]):e._e()],1)]),r("print",{ref:"print"}),r("import-order",{ref:"ImportOrder",on:{load:function(t){return e.getTableData(1)}}}),r("express-export",{ref:"expressExport"})],1)},a=[],i=(r("8e6e"),r("ac6a"),r("456d"),r("768b")),o=(r("c5f6"),r("7514"),r("7f7f"),r("96cf"),r("3b8d")),s=r("bd86"),c=r("a8db"),l=r("d225"),u=r("b0b4"),d=r("308d"),m=r("6bb5"),p=r("4e2b"),f=r("9ab4"),h=r("60a3"),v=r("9dba"),y=r("b32d");function b(e){var t={url:"/wms/warehouse/getWarehouseList",method:"post",data:e};return Object(y["a"])(t)}function g(e){var t={url:"/wms/worder/getWinOrderByCode",method:"post",params:e};return Object(y["a"])(t)}function w(){var e={url:"/wms/warehouse/selectlist",method:"get"};return Object(y["a"])(e)}function _(e){var t={url:"/auth/agent/getAgentList",method:"get",params:e};return Object(y["a"])(t)}function x(e){var t={url:"/auth/customer/customer",method:"post",data:e};return Object(y["a"])(t)}function O(e){var t={url:"/orders/worder/getOrderList",method:"post",data:e};return Object(y["a"])(t)}function k(e){var t={url:"/orders/worder/generateOrder",method:"post",data:e};return Object(y["a"])(t)}function S(e){var t={url:"/orders/worder/getWarehouseOrder",method:"get",params:e};return Object(y["a"])(t)}function j(e){var t={url:"/report/r/tag",method:"get",params:e};return Object(y["a"])(t)}function C(e){var t={url:"/orders/worder/deleteOrder",method:"delete",params:e};return Object(y["a"])(t)}function L(e){var t={url:"/orders/worder/deletePallet",method:"delete",params:e};return Object(y["a"])(t)}function T(e){var t={url:"/orders/ordertype/getSscByOrderType",method:"get",params:e};return Object(y["a"])(t)}function I(e){var t={url:"/orders/worder/saveOrder",method:"post",data:e};return Object(y["a"])(t)}function D(e){var t={url:"/finance/query-boxs-by-code",method:"post",data:e};return Object(y["a"])(t)}function F(e){var t={url:"/wms/guest/warehouse/list",method:"post",data:e};return Object(y["a"])(t)}function N(e){var t={url:"/express/web/expressorder/downloadZipFile",responseType:"blob",method:"post",params:e};return Object(y["a"])(t)}function $(e){var t={url:"express/web/expressorder/downLoadPdfFile",method:"post",params:e,responseType:"blob"};return Object(y["a"])(t)}function R(e){var t={url:"/express/web/expressorder/customerPdfFile",method:"post",params:e,responseType:"blob"};return Object(y["a"])(t)}function B(e){var t={url:"/orders/pallet/getPallet",method:"post",data:e};return Object(y["a"])(t)}function A(e){var t={url:"/orders/worder/exportWinOrder",method:"post",responseType:"blob",data:e};return Object(y["a"])(t)}var z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.detailLoading,expression:"detailLoading"}]},[r("div",{staticClass:"detail-back"},[r("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$emit("back")}}},[r("i",{staticClass:"el-icon-back"}),r("span",[e._v("返回")])])]),r("div",{staticClass:"app-panel order-detail"},[r("el-form",{ref:"detail",staticClass:"detail-form",attrs:{model:e.form,"label-width":"130px","label-position":"right"}},[r("div",{staticClass:"form-title"},[r("el-row",[r("el-col",{attrs:{span:4}},[e._v("\n            基础信息\n          ")]),r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},["3"===e.custType?r("el-dropdown",{attrs:{trigger:"hover"},on:{command:e.handlePrintDetail}},[r("el-button",{attrs:{type:"primary",size:"mini"}},[e._v("\n                打印唛头\n                "),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:"m1015"}},[e._v("\n                  打印唛头10*15\n                ")]),r("el-dropdown-item",{attrs:{command:"m1010"}},[e._v("\n                  打印唛头10*10\n                ")]),r("el-dropdown-item",{attrs:{command:"m1015new"}},[e._v("\n                  打印唛头10*15(新版)\n                ")]),r("el-dropdown-item",{attrs:{command:"m1010new"}},[e._v("\n                  打印唛头10*10(新版)\n                ")]),r("el-dropdown-item",{attrs:{command:"mA4-4"}},[e._v("\n                  打印唛头A4-4\n                ")])],1)],1):e._e(),"3"===e.custType?r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handlePrintDetail("wr")}}},[e._v("\n              打印入仓单\n            ")]):e._e()],1)],1)],1),r("div",{staticStyle:{display:"flex","flex-direction":"row",padding:"0 20px"}},[r("div",{staticStyle:{flex:"1"}},[r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"下单仓库："}},[e._v("\n            "+e._s(e.form.warehouseName)+"\n          ")]),1===e.form.type?r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"仓储周期："}},["0"===e.form.attribute?r("span",[e._v("\n              短期\n            ")]):"1"===e.form.attribute?r("span",[e._v("\n              长期\n            ")]):e._e()]):e._e(),2===e.form.type?r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"拼货方式："}},["line"===e.form.from?r("span",[e._v("\n              全程\n            ")]):"1"===e.form.attribute?r("span",[e._v("\n              自拼货\n            ")]):e._e()]):e._e(),3===e.form.type?r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"打托方式："}},["0"===e.form.attribute?r("span",[e._v("\n              按目的仓\n            ")]):e._e(),"1"===e.form.attribute?r("span",[e._v("\n              按分货唛头\n            ")]):"2"===e.form.attribute?r("span",[e._v("\n              按预约号\n            ")]):e._e()]):e._e(),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"出库/入库："}},["O"===e.form.io?r("span",[e._v("\n              出库\n            ")]):"I"===e.form.io?r("span",[e._v("\n              入库\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"入库类型："}},["0"===e.form.source?r("span",[e._v("\n              普通入库\n            ")]):"1"===e.form.source?r("span",[e._v("\n              退件入库\n            ")]):"2"===e.form.source?r("span",[e._v("\n              调拨入库\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"出入库模式："}},["0"===e.form.mode?r("span",[e._v("\n              整车\n            ")]):"1"===e.form.mode?r("span",[e._v("\n              整柜\n            ")]):"2"===e.form.mode?r("span",[e._v("\n              快递\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"装货方式："}},["0"===e.form.loading?r("span",[e._v("\n              托盘\n            ")]):"1"===e.form.loading?r("span",[e._v("\n              箱子\n            ")]):"2"===e.form.loading?r("span",[e._v("\n              家具等超大件\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"最大重量："}},[e._v("\n            "+e._s(e.$volumeConversion(e.form.weight,e.form.umWeight,"KGS")+"kg")+"\n          ")]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"最大尺寸："}},[e._v("\n            "+e._s(e.$volumeConversion(e.form.volume,e.form.umLength,"CM")+"cm")+"\n          ")]),r("el-form-item",{staticStyle:{display:"block",width:"100%"},attrs:{label:"备注："}},[e._v("\n            "+e._s(e.form.remark)+"\n          ")])],1),r("div",{staticStyle:{width:"2px","background-color":"#ccc",margin:"0 10px"}}),r("div",{staticStyle:{width:"400px"}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"计划入库日期："}},[e._v("\n            "+e._s(e.timeSplice(e.form.inTime,"1"))+"\n          ")]),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"计划入库时间："}},[e._v("\n            "+e._s(e.timeSplice(e.form.inTime,"2"))+"\n          ")]),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"包装及件数描述："}},[e._v("\n            "+e._s(e.form.description)+"\n          ")])],1)]),r("div",{staticClass:"form-title"},[e._v("\n        出入库信息\n      ")]),r("div",{staticStyle:{padding:"0 20px"}},["0"===e.form.mode?r("el-form-item",{attrs:{label:"车牌号："}},[e._v("\n          "+e._s(e.form.modeNo)+"\n        ")]):"1"===e.form.mode?r("el-form-item",{attrs:{label:"柜号："}},[e._v("\n          "+e._s(e.form.modeNo)+"\n        ")]):"2"===e.form.mode?r("el-form-item",{attrs:{label:"快递单号："}},[e._v("\n          "+e._s(e.form.modeNo)+"\n        ")]):e._e(),"2"===e.form.mode?r("el-form-item",{attrs:{label:"快递公司："}},[e._v("\n          "+e._s(e.form.expressName)+"\n        ")]):e._e(),"2"!==e.form.mode?r("el-form-item",{attrs:{label:"司机姓名："}},[e._v("\n          "+e._s(e.form.driver)+"\n        ")]):e._e(),"2"!==e.form.mode?r("el-form-item",{attrs:{label:"证件号码："}},["0"===e.form.certType?r("span",[e._v("身份证")]):"1"===e.form.certType?r("span",[e._v("护照")]):"2"===e.form.certType?r("span",[e._v("港澳通行证")]):e._e(),e._v("\n           | \n          "),r("span",[e._v(e._s(e.form.certNo))])]):e._e(),"2"!==e.form.mode?r("el-form-item",{attrs:{label:"联系电话："}},[e._v("\n          "+e._s(e.form.phone)+"\n        ")]):e._e()],1),r("div",{staticClass:"form-title"},[e._v("\n        货物信息\n      ")]),r("div",{staticStyle:{padding:"0 20px"}},[r("el-form-item",{attrs:{label:"理论总箱数："}},[e._v("\n          "+e._s(e.form.packages)+"\n        ")]),r("el-form-item",{attrs:{label:"理论总重量："}},[r("span",[e._v(e._s(e.$volumeConversion(e.form.weights,e.$getVolumeUnitByLengthUnit(e.form.umWeight),"KGS"))+" KGS")])]),r("el-form-item",{attrs:{label:"理论总体积："}},[r("span",[e._v(e._s(e.$volumeConversion(e.form.volumes,e.$getVolumeUnitByLengthUnit(e.form.umLength),"CBM"))+" CBM")])])],1),r("div",{staticStyle:{padding:"0 20px"}},[r("el-form-item",{attrs:{label:"实际总箱数："}},[e._v("\n          "+e._s((e.form.measure||{}).packages)+"\n        ")]),r("el-form-item",{attrs:{label:"实际总重量："}},[r("span",[e._v(e._s((e.form.measure||{}).totalWeight)+" KGS")])]),r("el-form-item",{attrs:{label:"实际总体积："}},[r("span",[e._v(e._s(e.$volumeConversion((e.form.measure||{}).totalVolume,"CBCM","CBM"))+" CBM")])])],1),e._e()])],1),r("print",{ref:"print"})],1)},P=[],E=(r("a481"),r("6762"),r("2fdb"),r("5a0c")),M=r.n(E),Y=r("5317");function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(r,!0).forEach(function(t){Object(s["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var W=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(m["a"])(t).apply(this,arguments)),e.detailLoading=!1,e.form={},e.otherData=[],e}return Object(p["a"])(t,e),Object(u["a"])(t,[{key:"setData",value:function(e){var t=e.id;this.getDetail(t)}},{key:"getDetail",value:function(e){var t=this;this.detailLoading=!0,S({id:e}).then(function(e){var r=e.data||{},n=r.order,a=(n.batches,n.services,n.worder),i=n.measure;t.form=V({},a,{measure:i}),t.detailLoading=!1}).catch(function(e){return t.detailLoading=!1,[null,e]})}},{key:"timeSplice",value:function(e,t){return"1"===t?e?M()(e).format("YYYY-MM-DD"):"":"2"===t?e?M()(e).format("HH:mm:ss"):"":void 0}},{key:"volumesFilter",value:function(e,t){return"CBCM"===t?(1e-6*e).toFixed(3):"CBM"===t?e.toFixed(3):"CUIN"===t?(164e-7*e).toFixed(3):"CUFT"===t?(.0283168*e).toFixed(3):void 0}},{key:"handlePrintDetail",value:function(e){var t=this;if(["m1015new","m1010new"].includes(e)){var r=this.$refs.print;r.printInit(this.form.code,e.replace("new",""))}else if("wr"!==e)j({tag:e}).then(function(e){var r=e.data||{},n=r.ip+t.form.code;window.open(n)}).catch(function(e){return[e,null]});else{var n=this.$router.resolve({path:"/order-file",query:{code:this.form.code}}),a=n.href;window.open(a,"_blank")}}},{key:"custType",get:function(){var e=v["a"].info||{},t=e.custType;return t}}]),t}(h["e"]);W=f["a"]([Object(h["a"])({name:"detail",components:{print:Y["a"]},props:{}})],W);var q=W,H=q,G=(r("8115"),r("2877")),J=Object(G["a"])(H,z,P,!1,null,"7ad87dd9",null),K=J.exports,Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"detail-back"},[r("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){return e.$emit("back")}}},[r("i",{staticClass:"el-icon-back"}),r("span",[e._v("返回")])])]),r("div",{staticClass:"app-panel order-detail"},[r("el-form",{ref:"detail",staticClass:"detail-form",attrs:{model:e.form,"label-width":"130px","label-position":"right"}},[r("div",{staticClass:"form-title"},[r("el-row",[r("el-col",{attrs:{span:4}},[e._v("\n            基础信息\n          ")])],1)],1),r("div",{staticStyle:{display:"flex","flex-direction":"row",padding:"0 20px"}},[r("div",{staticStyle:{flex:"1"}},[r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"下单仓库："}},[e._v("\n            "+e._s((e.form.warehouse||{}).name)+"\n          ")]),"2"!==e.form.deliverType?r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"打托方式："}},[e.form.palletType+""==="0"?r("span",[e._v("\n              按目的仓\n            ")]):e._e(),e.form.palletType+""==="1"?r("span",[e._v("\n              按分货唛头\n            ")]):e.form.palletType+""==="2"?r("span",[e._v("\n              按预约号\n            ")]):e._e()]):e._e(),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"出库/入库："}},[r("span",[e._v("\n              入库\n            ")])]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"入库类型："}},[0===e.form.warehouseType?r("span",[e._v("\n              普通入库\n            ")]):1===e.form.warehouseType?r("span",[e._v("\n              退件入库\n            ")]):2===e.form.warehouseType?r("span",[e._v("\n              调拨入库\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"出入库模式："}},[r("span",[e._v("\n              整柜\n            ")])]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"装货方式："}},[e.form.loadingType+""==="1"?r("span",[e._v("\n              托盘\n            ")]):e.form.loadingType+""==="0"?r("span",[e._v("\n              箱子\n            ")]):e.form.loadingType+""==="2"?r("span",[e._v("\n              家具等超大件\n            ")]):e._e()]),r("el-form-item",{staticStyle:{width:"33.33%"},attrs:{label:"最大重量："}},[e._v("\n            "+e._s(e.form.weightMax)+" "+e._s(e.form.weightMaxUnit)+"\n          ")]),r("el-form-item",{staticStyle:{display:"block",width:"100%"},attrs:{label:"备注："}},[e._v("\n            "+e._s(e.form.remark)+"\n          ")])],1),r("div",{staticStyle:{width:"2px","background-color":"#ccc",margin:"0 10px"}}),r("div",{staticStyle:{width:"400px"}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"计划入库时间："}},[e._v("\n            "+e._s(e.form.warehousingTime)+"\n          ")]),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"备注："}},[e._v("\n            "+e._s(e.form.remarks)+"\n          ")])],1)]),r("div",{staticClass:"form-title"},[e._v("\n        出入库信息\n      ")]),r("div",{staticStyle:{padding:"0 20px"}},[r("el-form-item",{attrs:{label:"柜号："}},[e._v("\n          "+e._s(e.form.cabinetNumber)+"\n        ")]),r("el-form-item",{attrs:{label:"司机姓名："}},[e._v("\n          "+e._s(e.form.driverName)+"\n        ")]),r("el-form-item",{attrs:{label:"证件号码："}},[e.form.certificateType+""==="0"?r("span",[e._v("身份证")]):e.form.certificateType+""==="1"?r("span",[e._v("护照")]):e.form.certificateType+""==="2"?r("span",[e._v("港澳通行证")]):e._e(),e._v("\n           | \n          "),r("span",[e._v(e._s(e.form.driverCertificate))])]),r("el-form-item",{attrs:{label:"联系电话："}},[e._v("\n          "+e._s(e.form.phone)+"\n        ")])],1),r("div",{staticClass:"form-title"},[e._v("\n        货物信息\n      ")]),r("div",{staticStyle:{padding:"0 20px"}},[r("el-form-item",{attrs:{label:"总箱数："}},[e._v("\n          "+e._s(e.form.totalBox)+"\n        ")]),r("el-form-item",{attrs:{label:"总重量："}},[r("span",[e._v(e._s(e.form.totalWeight)+" "+e._s((e.form.um||{}).umWeight))])]),r("el-form-item",{attrs:{label:"总体积："}},[r("span",[e._v(e._s(e.form.totalVolume)+" "+e._s((e.form.um||{}).umVolume))])])],1)])],1)])},Q=[],X=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(m["a"])(t).apply(this,arguments)),e.form={},e}return Object(p["a"])(t,e),Object(u["a"])(t,[{key:"setData",value:function(e){this.form=e}},{key:"custType",get:function(){var e=v["a"].info||{},t=e.custType;return t}}]),t}(h["e"]);X=f["a"]([Object(h["a"])({name:"detail",components:{},props:{}})],X);var ee=X,te=ee,re=(r("1c0c"),Object(G["a"])(te,Z,Q,!1,null,"93ab4562",null)),ne=re.exports,ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"invoice-order-info"},[r("div",{staticClass:"top-option",staticStyle:{overflow:"hidden"}},[r("el-link",{directives:[{name:"permission",rawName:"v-permission",value:["warehouseOrderFinancialAdd"],expression:"['warehouseOrderFinancialAdd']"}],staticStyle:{float:"left"},attrs:{underline:!1,type:"primary"},on:{click:e.addInvoice}},[e._v("\n      "+e._s(e.custId===e.orderCustomerInfo.parentId?"新增应收款":"新增应付款")+"\n    ")]),r("el-link",{staticStyle:{float:"right"},attrs:{underline:!1,type:"primary"},on:{click:e.goBack}},[e._v("\n      返回\n    ")])],1),r("div",{staticClass:"my-scrollbar",staticStyle:{height:"calc(100vh - 180px)","overflow-y":"auto"}},[e._l(e.invoiceList,function(t,n){return r("div",{key:t.code,staticClass:"invoice-item",style:{"margin-top":0===n?0:"16px"}},[r("el-row",{staticClass:"invoice-title",nativeOn:{click:function(r){return e.showDetails(t)}}},[r("el-col",{attrs:{span:16}},["0"===t.status?r("span",{staticClass:"invoice-audit",staticStyle:{background:"#2291E6"}}):e._e(),"1"===t.status?r("span",{staticClass:"invoice-audit",staticStyle:{background:"#189800"}}):e._e(),"2"===t.status?r("span",{staticClass:"invoice-audit",staticStyle:{background:"#E12E2E"}}):e._e(),"3"===t.status?r("span",{staticClass:"invoice-audit",staticStyle:{background:"#FF7D19"}}):e._e(),r("span",{staticStyle:{"font-size":"14px"}},[e._v("\n            发票号："+e._s(t.code)+"\n          ")]),1===t.ifVerify?r("span",{staticClass:"invoice-type"},[e._v("\n            已核销\n          ")]):e._e(),e.formatterCutoffTime(t)?r("span",{staticClass:"invoice-day"},[e._v("\n            逾期"+e._s(e.formatterCutoffTime(t))+"天\n          ")]):e._e()]),t.isOpen?r("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},["1"!==t.status&&!t.isEdit&&e.$checkPermission(["warehouseOrderFinancialAudit"])?r("el-button",{attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.auditInvoice(t)}}},[e._v("\n            审核\n          ")]):e._e(),t.isEdit||t.isAdd||0!==t.ifVerify||"3"===t.status||!e.$checkPermission(["warehouseOrderFinancialEdit"])?e._e():r("el-button",{attrs:{type:"text"},on:{click:function(r){return r.stopPropagation(),e.editRowClick(t)}}},[e._v("\n            编辑\n          ")]),t.isEdit||t.isAdd?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return r.stopPropagation(),e.cancelInvoice(t)}}},[e._v("\n            取消\n          ")]):e._e(),t.isEdit||t.isAdd?r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){return r.stopPropagation(),e.saveInvoice(t)}}},[e._v("\n            保存\n          ")]):e._e()],1):e._e()],1),r("el-row",{staticClass:"img-flex"},[r("el-col",{attrs:{span:4}},[r("div",{staticClass:"img-word"},[r("span",{staticStyle:{color:"#909399"}},[e._v("账单金额:")]),r("br"),r("span",{staticClass:"img-number"},[e._v(e._s(t.amount))]),r("span",{staticClass:"img-unit"},[e._v(e._s(""+(t.currencyName||"")+(t.currencyId||"")))])])]),r("el-col",{attrs:{span:4}},[r("div",{staticClass:"img-word"},[r("span",{staticStyle:{color:"#909399"}},[e._v("本币金额：")]),r("br"),r("span",{staticClass:"img-number"},[e._v(e._s(t.selfAmount))]),r("span",{staticClass:"img-unit"},[e._v(e._s(""+(t.selfName||"")+(t.selfId||"")))])])]),r("el-col",{attrs:{span:5}},[r("div",{staticClass:"img-word"},[r("span",{staticStyle:{color:"#909399"}},[e._v("创建时间：")]),r("br"),r("span",{staticClass:"img-unit"},[e._v(e._s(t.createTime))]),r("span",{staticClass:"img-number"},[e._v(" ")])])]),r("el-col",{attrs:{span:5}},[r("div",{staticClass:"img-word"},[r("span",{staticStyle:{color:"#909399"}},[e._v("审核时间：")]),r("br"),r("span",{staticClass:"img-unit"},[e._v(e._s(t.auditTime||"--"))]),r("span",{staticClass:"img-number"},[e._v(" ")])])]),r("el-col",{attrs:{span:5}},[r("div",{staticClass:"img-word"},[r("span",{staticStyle:{color:"#909399"}},[e._v("截止付款：")]),r("br"),r("span",{staticClass:"img-unit"},[e._v(e._s(t.cutoffTime||"--"))]),r("span",{staticClass:"img-number"},[e._v(" ")])])])],1),r("el-collapse-transition",[r("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"itemV.isOpen"}]},[r("el-form",{staticStyle:{padding:"16px 16px 0"},attrs:{"label-width":"85px",size:"small"}},[t.isEdit?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"发票日期",prop:"invDate"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择"},model:{value:t.invDate,callback:function(r){e.$set(t,"invDate",r)},expression:"itemV.invDate"}})],1),r("el-form-item",{attrs:{label:"发票类型",prop:"invoiceType"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",filterable:""},model:{value:t.invoiceType,callback:function(r){e.$set(t,"invoiceType",r)},expression:"itemV.invoiceType"}},e._l(e.invoiceTypeList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),r("el-form-item",{attrs:{label:"发票货币",prop:"currencyId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",filterable:""},on:{focus:e.getCurrencyList,change:function(r){return e.currencyChange(r,t)}},model:{value:t.currencyId,callback:function(r){e.$set(t,"currencyId",r)},expression:"itemV.currencyId"}},e._l(e.currencyList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name+"-"+e.sign,value:e.id}})}),1)],1),r("el-form-item",{attrs:{label:"汇率",prop:"exRate"}},[r("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",size:"small",min:0,max:9999},on:{change:function(r){return e.calculateTotalPrice(t)}},model:{value:t.exRate,callback:function(r){e.$set(t,"exRate",r)},expression:"itemV.exRate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea",rows:2,size:"small",placeholder:"请输入",clearable:""},model:{value:t.remark,callback:function(r){e.$set(t,"remark",r)},expression:"itemV.remark"}})],1)],1)],1):r("el-row",{staticStyle:{"font-size":"12px","padding-bottom":"16px"}},[r("el-col",{attrs:{span:12}},[r("el-row",{staticStyle:{"font-size":"12px"}},[r("el-col",{attrs:{span:12}},[r("span",{staticStyle:{color:"#909399"}},[e._v("发票日期：")]),r("span",[e._v(e._s(t.invDate))])]),r("el-col",{attrs:{span:12}},[r("span",{staticStyle:{color:"#909399"}},[e._v("发票类型：")]),r("span",[e._v(e._s((e.invoiceTypeList.find(function(e){return e.value===t.invoiceType})||{}).label))])]),r("el-col",{staticStyle:{"padding-top":"10px"},attrs:{span:12}},[r("span",{staticStyle:{color:"#909399"}},[e._v("发票货币：")]),r("span",[e._v(e._s(t.currencyId))])]),r("el-col",{staticStyle:{"padding-top":"10px"},attrs:{span:12}},[r("span",{staticStyle:{color:"#909399"}},[e._v("汇率：")]),r("span",[e._v(e._s(t.exRate))])])],1)],1),r("el-col",{attrs:{span:12}},[r("el-row",{staticStyle:{"font-size":"12px"}},[r("el-col",{attrs:{span:24}},[r("span",{staticStyle:{color:"#909399"}},[e._v("备注：")]),r("span",[e._v(e._s(t.remark))])])],1)],1)],1)],1),r("div",{staticStyle:{"border-top":"1px solid #e8e8e8",padding:"0 16px"}},[r("div",{staticStyle:{"line-height":"44px","font-size":"14px","font-weight":"600"}},[e._v("\n              明细行\n            ")]),r("div",{staticStyle:{"font-size":"14px"}},[r("span",{staticStyle:{color:"#324770"}},[e._v("开票总金额：")]),r("span",[e._v(e._s(t.amount))]),r("span",[e._v(e._s(""+(t.currencyName||"")+(t.currencyId||"")))]),r("span",{staticStyle:{color:"#324770","margin-left":"72px"}},[e._v("账单本币总金额：")]),r("span",[e._v(e._s(t.selfAmount))]),r("span",[e._v(e._s(""+(t.selfName||"")+(t.selfId||"")))])])]),t.isEdit?r("div",{staticStyle:{width:"100%",padding:"10px 16px"}},[r("div",{staticStyle:{display:"flex","flex-flow":"row nowrap"}},[r("div",{staticStyle:{flex:"1"}},[r("el-row",{staticClass:"details-table-header details-row",attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[e._v("\n                    成本项目\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    数量\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    单价\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    金额\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    本币金额\n                  ")])],1)],1),r("div",{staticStyle:{width:"60px"}},[r("div",{staticClass:"details-table-header"},[e._v("\n                  操作\n                ")])])]),r("div",e._l(t.items,function(n,a){return r("div",{key:n.id,staticClass:"details-table-body"},[r("div",{staticStyle:{flex:"1"}},[r("el-row",{staticClass:"details-row",attrs:{gutter:10}},[r("el-col",{attrs:{span:12}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",filterable:""},on:{focus:e.getCostitemList,change:function(t){return e.costitemChange(t,n)}},model:{value:n.costitemId,callback:function(t){e.$set(n,"costitemId",t)},expression:"itemD.costitemId"}},e._l(e.projectData,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),r("el-col",{attrs:{span:3}},[r("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",size:"small",min:-99999999,max:99999999},on:{change:function(r){return e.handleChange(t,n,a)}},model:{value:n.quantity,callback:function(t){e.$set(n,"quantity",t)},expression:"itemD.quantity"}})],1),r("el-col",{attrs:{span:3}},[r("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",size:"small",min:-99999999,max:99999999},on:{change:function(r){return e.handleChange(t,n,a)}},model:{value:n.price,callback:function(t){e.$set(n,"price",t)},expression:"itemD.price"}})],1),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.amount||"--")+"\n                      ")])]),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.selfAmount||"--")+"\n                      ")])])],1),r("el-row",{staticClass:"details-row",attrs:{gutter:10}},[r("el-col",{staticStyle:{"padding-top":"4px"},attrs:{span:18}},[r("el-input",{attrs:{type:"textarea",rows:2,size:"small",placeholder:"说明",clearable:""},model:{value:n.itemDesc,callback:function(t){e.$set(n,"itemDesc",t)},expression:"itemD.itemDesc"}})],1)],1)],1),r("div",{staticStyle:{width:"60px"}},[t.isEdit?r("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text"},on:{click:function(r){return e.handleDelete(t,n)}}},[e._v("\n                    删除\n                  ")]):e._e()],1)])}),0)]):r("div",{staticStyle:{width:"100%",padding:"10px 16px"}},[r("div",{staticStyle:{display:"flex","flex-flow":"row nowrap"}},[r("div",{staticStyle:{flex:"1"}},[r("el-row",{staticClass:"details-table-header details-row",attrs:{gutter:10}},[r("el-col",{attrs:{span:6}},[e._v("\n                    成本项目\n                  ")]),r("el-col",{attrs:{span:6}},[e._v("\n                    说明\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    数量\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    单价\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    金额\n                  ")]),r("el-col",{attrs:{span:3}},[e._v("\n                    本币金额\n                  ")])],1)],1),r("div",{staticStyle:{width:"60px"}},[r("div",{staticClass:"details-table-header"},[e._v("\n                  操作\n                ")])])]),r("div",e._l(t.items,function(n){return r("div",{key:n.id,staticClass:"details-table-body"},[r("div",{staticStyle:{flex:"1"}},[r("el-row",{staticClass:"details-row",attrs:{gutter:10}},[r("el-col",{attrs:{span:6}},[r("span",[e._v("\n                        "+e._s(n.costitemName)+"\n                      ")])]),r("el-col",{attrs:{span:6}},[r("div",{staticStyle:{"font-size":"12px",color:"#303133",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},[e._v("\n                        "+e._s(n.itemDesc)+"\n                      ")])]),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.quantity)+"\n                      ")])]),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.price)+"\n                      ")])]),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.amount)+"\n                      ")])]),r("el-col",{attrs:{span:3}},[r("span",[e._v("\n                        "+e._s(n.selfAmount)+"\n                      ")])])],1)],1),r("div",{staticStyle:{width:"60px"}},[t.isEdit?r("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text"},on:{click:function(r){return e.handleDelete(t,n)}}},[e._v("\n                    删除\n                  ")]):e._e()],1)])}),0)]),t.isEdit?r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"small"},on:{click:function(r){return e.addCostitem(t)}}},[e._v("\n            新增明细行\n          ")]):e._e()],1)])],1)}),0===e.invoiceList.length?r("div",{staticStyle:{"font-size":"14px",color:"#5e6d82","text-align":"center",padding:"10px"}},[e._v("\n      暂无数据\n    ")]):e._e()],2),r("el-dialog",{attrs:{title:"发票审核",visible:e.visible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){e.visible=t}}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[r("el-form",{ref:"auditForm",attrs:{model:e.auditForm,"label-width":"50px",size:"small"}},[r("el-form-item",{attrs:{label:"审核",prop:"status"}},[r("el-radio-group",{model:{value:e.auditForm.status,callback:function(t){e.$set(e.auditForm,"status",t)},expression:"auditForm.status"}},[r("el-radio",{attrs:{label:"1"}},[e._v("\n              通过\n            ")]),r("el-radio",{attrs:{label:"2"}},[e._v("\n              拒绝\n            ")])],1)],1)],1),r("div",{staticStyle:{"text-align":"right","padding-top":"10px"}},[r("el-button",{attrs:{size:"small",disabled:e.dialogLoading},on:{click:e.cancelAudit}},[e._v("\n          取 消\n        ")]),r("el-button",{attrs:{type:"primary",size:"small",disabled:e.dialogLoading},on:{click:e.confirmAudit}},[e._v("\n          确 定\n        ")])],1)],1)])],1)},ie=[],oe=(r("ac4d"),r("8a81"),r("55dd"),r("75fc")),se=(r("6b54"),r("7dfc"));function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(r,!0).forEach(function(t){Object(s["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ue=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(m["a"])(t).apply(this,arguments)),e.service={id:"04",name:"仓储"},e.rowDetail={},e.orderCustomer={},e.orderCustomerInfo={},e.loading=!1,e.visible=!1,e.dialogLoading=!1,e.invoiceList=[],e.invoiceTypeList=[{label:"订单发票",value:"1"},{label:"冲红发票",value:"2"}],e.currencyList=[],e.projectData=[],e.whiteCountryList=[{countryId:"CN",currencyId:"RMB"}],e.editRow={},e.auditForm={id:"",status:"",note:""},e.selfCurrency={currencyId:"",currencyName:""},e}return Object(p["a"])(t,e),Object(u["a"])(t,[{key:"goBack",value:function(){this.orderCustomer={},this.orderCustomerInfo={},this.rowDetail={},this.invoiceList=[],this.currencyList=[],this.projectData=[],this.editRow={},this.auditForm={id:"",status:"",note:""},this.selfCurrency={currencyId:"",currencyName:""},this.$emit("back")}},{key:"show",value:function(e,t){var r=this;if(this.rowDetail=e,this.getCurrencyList(),this.getCostitemList(),this.getSelfCurrency(),"3"===e.type){var n=this.rowDetail.seller||{},a=this.rowDetail.buyer||{};this.orderCustomerInfo={custId:a.id,custName:a.name,parentId:n.id,parentName:n.name},this.getInvoiceList(),this.getCustType()}else this.loading=!0,g({code:e.code,orderType:t}).then(function(e){r.loading=!1,r.orderCustomerInfo=e.data,r.getInvoiceList(),r.getCustType()}).catch(function(){r.loading=!1,r.orderCustomerInfo={}})}},{key:"getCustType",value:function(){var e=this;Object(se["u"])([this.orderCustomerInfo.custId]).then(function(t){var r=t.data||[];e.orderCustomer=r[0]||{}}).catch(function(){e.orderCustomer={}})}},{key:"cancelInvoice",value:function(e){var t=this;e.isAdd?this.invoiceList=this.invoiceList.filter(function(e){return!e.isAdd}):this.invoiceList=this.invoiceList.filter(function(e){return!e.isAdd}).map(function(e){var r=le({},e);return r.isEdit=!1,r.isOpen=!1,r.items=[],t.editRow.id===r.id&&(r=le({},t.editRow),r.isEdit=!1,r.isOpen=!0),r})}},{key:"addInvoice",value:function(){var e=this;if(this.invoiceList.some(function(e){return e.isEdit}))this.$confirm("您有修改未保存请问是否保存？","提示",{cancelButtonText:"否",confirmButtonText:"是"}).then(function(){var t=e.invoiceList.find(function(e){return e.isEdit});t?e.saveInvoice(t):(e.invoiceList=e.invoiceList.filter(function(e){return!e.isAdd}).map(function(t){var r=le({},t);return e.editRow.id===r.id&&(r=le({},e.editRow)),r.isEdit=!1,r.isOpen=!1,r.items=[],r}),e.editRow={})}).catch(function(){e.invoiceList=e.invoiceList.filter(function(e){return!e.isAdd}).map(function(t){var r=le({},t);return e.editRow.id===r.id&&(r=le({},e.editRow)),r.isEdit=!1,r.isOpen=!1,r.items=[],r}),e.editRow={};var t=e.getInvoiceItem();e.invoiceList.push(t),e.currencyChange("RMB",t)});else{this.invoiceList=this.invoiceList.filter(function(e){return!e.isAdd}).map(function(e){return e.isEdit=!1,e.isOpen=!1,e.items=[],e});var t=this.getInvoiceItem();this.invoiceList.push(t),this.currencyChange("RMB",t),this.editRow={}}}},{key:"getUId",value:function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substr(t.lastIndexOf("/")+1)}},{key:"validateData",value:function(e){if(!e.invDate)return this.$message.error("发票日期不能为空"),!1;if(!e.invoiceType)return this.$message.error("发票类型不能为空"),!1;if(!e.currencyId)return this.$message.error("发票货币不能为空"),!1;if(!e.exRate)return this.$message.error("汇率不能为空"),!1;if(0===e.items.length)return this.$message.error("发票明细行不能为空"),!1;for(var t=!0,r=0;r<e.items.length;r++){var n=e.items[r];if(!n.costitemId){this.$message.error("第".concat(r+1,"明细行项目不能为空")),t=!1;break}if(!n.itemDesc){this.$message.error("第".concat(r+1,"明细行说明不能为空")),t=!1;break}if(!n.quantity&&0!==n.quantity){this.$message.error("第".concat(r+1,"明细行数量不能为空")),t=!1;break}if(!n.price&&0!==n.price){this.$message.error("第".concat(r+1,"明细行单价不能为空")),t=!1;break}}return t}},{key:"saveInvoice",value:function(e){var t=this;if(this.validateData(e)){var r=le({},e);delete r.isOpen,delete r.isEdit,delete r.isAdd,this.editRow.id||delete r.id,r.items=r.items.map(function(e){return t.editRow.id||(delete e.id,delete e.invoiceId),e.isAdd&&delete e.id,delete e.isAdd,e}),this.loading=!0,this.editRow.id?Object(se["Y"])(r).then(function(){t.loading=!1,t.getInvoiceList(e.id),t.$message.success("添加成功"),t.editRow={}}).catch(function(){t.loading=!1}):Object(se["X"])(r).then(function(){t.loading=!1,t.getInvoiceList(e.id),t.$message.success("添加成功"),t.editRow={}}).catch(function(){t.loading=!1})}}},{key:"addCostitem",value:function(e){var t=this;this.invoiceList=this.invoiceList.map(function(r){return r.id===e.id&&(r.items=[].concat(Object(oe["a"])(r.items),[t.getCostitem(e)])),r})}},{key:"getCostitem",value:function(e){return{id:this.getUId(),invoiceId:e.id,costitemId:"",costitemName:"",itemDesc:"",quantity:"",price:"",amount:"",selfAmount:"",isAdd:!0}}},{key:"getInvoiceItem",value:function(){var e={serviceSubtypeId:this.rowDetail.type,currencyId:"RMB",currencyName:"人民币",selfId:this.selfCurrency.currencyId,selfName:this.selfCurrency.currencyName,selfAmount:"",exRate:"",amount:"",agentId:this.orderCustomerInfo.parentId,agentName:this.orderCustomerInfo.parentName,clientId:this.orderCustomerInfo.custId,clientName:this.orderCustomerInfo.custName,serviceTypeId:this.service.id,serviceTypeName:this.service.name,invoiceType:"",orderId:this.rowDetail.id,orderCode:this.rowDetail.code,invDate:M()().format("YYYY-MM-DD HH:mm:ss"),remark:"",clientProperty:this.orderCustomer.type+(this.orderCustomer.subtype?"-"+this.orderCustomer.subtype:""),status:"0",items:[],isOpen:!0,isEdit:!0,isAdd:!0};return e.items=[this.getCostitem(e)],e}},{key:"handleDelete",value:function(e,t){this.invoiceList=this.invoiceList.map(function(r){return r.id===e.id&&(r.items=r.items.filter(function(e){return e.id!==t.id}),r.amount=r.items.reduce(function(e,t){return parseFloat((e+t.amount).toFixed(2))},0),r.selfAmount=r.items.reduce(function(e,t){return parseFloat((e+t.selfAmount).toFixed(2))},0)),r})}},{key:"handleChange",value:function(e,t,r){var n=this;this.invoiceList=this.invoiceList.map(function(a){return a.id===e.id&&(a.items=a.items.map(function(a,i){return i===r&&(a.amount=parseFloat(((t.quantity||0)*(t.price||0)).toFixed(2)),a.selfAmount=n.calculateSelfTotalPrice(e.currencyId,e.selfId,a.amount,e.exRate)),a}),a.amount=a.items.reduce(function(e,t){return parseFloat((e+t.amount).toFixed(2))},0),a.selfAmount=a.items.reduce(function(e,t){return parseFloat((e+t.selfAmount).toFixed(2))},0)),a})}},{key:"costitemChange",value:function(e,t){t.costitemName="";var r=this.projectData.find(function(t){return t.id===e});r&&(t.costitemName=r.name)}},{key:"calculateTotalPrice",value:function(e){var t=this;this.invoiceList=this.invoiceList.map(function(r){return r.id===e.id&&(r.items=r.items.map(function(e,n){return e.selfAmount=t.calculateSelfTotalPrice(r.currencyId,r.selfId,e.amount,r.exRate),e}),r.selfAmount=t.calculateSelfTotalPrice(e.currencyId,e.selfId,e.amount,e.exRate)),r})}},{key:"calculateSelfTotalPrice",value:function(e,t,r,n){return e===t?r:n?parseFloat((r*n).toFixed(2)):r}},{key:"currencyChange",value:function(e,t){var r=this,n=this.currencyList.find(function(t){return t.id===e});if(n)if(t.currencyName=n.name,t.selfId===e)t.exRate=1,this.calculateTotalPrice(t);else{var a={c1:t.selfId,c2:e};t.exRate="",Object(se["x"])(a).then(function(n){var a=(n.data||[]).filter(function(r){return r.lcId===e&&r.fcId===t.selfId}).sort(function(e,t){return M()(t.updateTime).diff(M()(e.updateTime),"second")});if(a.length){var i=!0,o=!1,s=void 0;try{for(var c,l=a[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var u=c.value;if(M()().diff(M()(u.effective),"second")>0){t.exRate=u.rate;break}}}catch(d){o=!0,s=d}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}t.exRate?r.calculateTotalPrice(t):r.$message.error("系统暂无汇率，请联系管理员或手动输入")}else r.$message.error("系统暂无汇率，请联系管理员或手动输入")}).catch(function(e){return e})}else t.currencyName="",t.exRate="",this.calculateTotalPrice(t)}},{key:"getSelfCurrency",value:function(){this.selfCurrency={currencyId:"RMB",currencyName:"人民币"}}},{key:"cancelAudit",value:function(){this.visible=!1,this.auditForm={id:"",status:"",note:""}}},{key:"confirmAudit",value:function(){var e=this,t=le({},this.auditForm);this.dialogLoading=!0,Object(se["f"])(t).then(function(){e.$message.success("操作成功"),e.dialogLoading=!1,e.getInvoiceList(e.auditForm.id),e.cancelAudit()}).catch(function(){e.dialogLoading=!1})}},{key:"auditInvoice",value:function(e){var t=this;if("0"===e.status){var r={id:e.id,status:"3",note:""};this.loading=!0,Object(se["f"])(r).then(function(){t.loading=!1,e.status="3",t.visible=!0,t.auditForm={id:e.id,status:"1",note:""}}).catch(function(e){return t.loading=!1,e})}else this.visible=!0,this.auditForm={id:e.id,status:"1",note:""}}},{key:"editRowClick",value:function(e){this.editRow=JSON.parse(JSON.stringify(e)),e.isEdit=!0}},{key:"getCurrencyList",value:function(){var e=this;this.currencyList.length||Object(se["t"])().then(function(t){var r=t.data||{};e.currencyList=r.result||[]}).catch(function(t){return e.currencyList=[],t})}},{key:"getCostitemList",value:function(){var e=this;if(!this.projectData.length){var t={name:"",serviceTypeId:this.service.id,typeId:this.rowDetail.type,page:1,size:9999};Object(se["s"])(t).then(function(t){var r=t.data||{};e.projectData=r.result||[]}).catch(function(t){return e.projectData=[],t})}}},{key:"showDetails",value:function(e){var t=this;this.invoiceList.some(function(e){return e.isEdit})?this.$confirm("您有修改未保存请问是否保存？","提示",{cancelButtonText:"否",confirmButtonText:"是"}).then(function(){t.saveInvoice(e)}).catch(function(){t.getInvoiceById(e)}):this.getInvoiceById(e)}},{key:"getInvoiceById",value:function(e){var t=this,r=e.isOpen;if(r)return this.invoiceList=this.invoiceList.filter(function(e){return!e.isAdd}).map(function(e){var r=le({},e);return t.editRow.id===r.id&&(r=le({},t.editRow)),r.isEdit=!1,r.isOpen=!1,r.items=[],r}),void(this.editRow={});this.loading=!0,Object(se["A"])({id:e.id}).then(function(r){t.loading=!1;var n=r.data||{};t.invoiceList=t.invoiceList.filter(function(e){return!e.isAdd}).map(function(r){var a=le({},r);return t.editRow.id===a.id&&(a=le({},t.editRow)),a.isEdit=!1,a.isOpen=!1,a.items=[],a.id===e.id&&(a.isOpen=!0,a.items=(n.items||[]).map(function(e){return le({},e,{isAdd:!1})})),a}),t.editRow={}}).catch(function(){t.loading=!1})}},{key:"getInvoiceList",value:function(e){var t=this,r={orderId:this.rowDetail.id,enterpriseId:[this.orderCustomerInfo.parentId],serviceTypeId:this.service.id};this.loading=!0,Object(se["E"])(r).then(function(r){t.loading=!1,t.invoiceList=(r.data||[]).map(function(r){var n=le({items:[]},r,{isOpen:!1,isEdit:!1,isAdd:!1});return n.id===e&&t.getInvoiceById(n),n})}).catch(function(){t.loading=!1})}},{key:"formatterCutoffTime",value:function(e){var t=e.cutoffTime;if(!t)return 0;if(M()(t).format("YYYY-MM-DD")===M()().format("YYYY-MM-DD"))return 0;var r=M()().diff(t,"day")+1;return r>0&&0===e.ifVerify?r:0}},{key:"userCountryId",get:function(){var e=v["a"].info||{};return e.countryId}},{key:"custType",get:function(){var e=v["a"].info||{};return e.custType}},{key:"custId",get:function(){var e=v["a"].info||{};return e.custId}}]),t}(h["e"]);ue=f["a"]([Object(h["a"])({name:"order-financial",components:{}})],ue);var de=ue,me=de,pe=(r("fa89"),Object(G["a"])(me,ae,ie,!1,null,"92ac91fe",null)),fe=pe.exports,he=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"导入下单",width:"600px","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.cancel}},[r("p",[e._v("下载模板导入箱号，或输入原单号，从1.0系统导入订单")]),r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"importForm",attrs:{model:e.form,rules:e.formRules,"label-width":"80px",size:"small"}},[r("el-form-item",{attrs:{label:"原单号",prop:"code"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),r("el-form-item",{attrs:{label:"仓库",prop:"warehouse"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",loading:e.selectLoading},on:{focus:e.getWarehouseList},model:{value:e.form.warehouse,callback:function(t){e.$set(e.form,"warehouse",t)},expression:"form.warehouse"}},e._l(e.warehouseList,function(e){return r("el-option",{key:e.warehouseId,attrs:{label:e.name,value:e.warehouseId}})}),1)],1),r("el-form-item",{attrs:{label:"订单导入"}},[r("div",{staticStyle:{display:"flex"}},[r("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"text"},on:{click:e.downloadFile}},[e._v("\n          模板下载\n        ")]),r("el-upload",{attrs:{action:"",multiple:!1,limit:1,"show-file-list":!1,"http-request":e.uploadFile,"file-list":e.fileList}},[r("el-button",{attrs:{size:"small",type:"text"}},[e._v("\n            导入excel\n          ")])],1),r("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"text"},on:{click:e.importBySys1}},[e._v("\n          从1.0系统导入\n        ")])],1)]),e.importBoxs.length?r("el-form-item",{attrs:{label:"导入结果"}},[r("span",[e._v("\n        共导入"+e._s(e.importBoxs.length)+"个批次，累计箱子数量为 "+e._s(e.boxNum)+"\n      ")]),r("el-button",{attrs:{size:"small",type:"text"},on:{click:e.clearImport}},[e._v("\n        清空\n      ")])],1):e._e(),r("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n        取 消\n      ")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSubmit}},[e._v("\n        保 存\n      ")])],1)],1)],1)},ve=[],ye=(r("34ef"),r("254e")),be=r("1146"),ge=r.n(be),we=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(m["a"])(t).apply(this,arguments)),e.loading=!1,e.visible=!1,e.selectLoading=!1,e.form={code:"",supplier:"",warehouse:""},e.formRules={code:[{required:!0,message:"请输入原单号",trigger:"change"},{validator:function(e,t,r){var n=/^([\w | -]){8,20}$/;n.test(t)?r():r(new Error("原单号必须8-20个字母、数字、下划线、中划线，不能输入特殊字符"))},trigger:"blur"}],supplier:[{required:!0,message:"请选择供应商",trigger:"change"}],warehouse:[{required:!0,message:"请选择仓库",trigger:"change"}]},e.orderServiceData={},e.fileList=[],e.importBoxs=[],e.supplierList=[],e.warehouseList=[],e}return Object(p["a"])(t,e),Object(u["a"])(t,[{key:"cancel",value:function(){this.visible=!1,this.$emit("load")}},{key:"show",value:function(){var e=this;this.visible=!0,this.fileList=[],this.importBoxs=[],this.getServiceInfoByType(),this.$nextTick(function(){var t=e.$refs.importForm;t.resetFields()})}},{key:"clearImport",value:function(){this.fileList=[],this.importBoxs=[]}},{key:"uploadFile",value:function(e){var t=Math.round(e.file.size/1024/1024*100)/100;if(t>10)this.$message.warning("文件大小超出最大上传限制！");else{var r=e.file,n=this,a=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var t,r,a="",i=new FileReader;i.onload=function(e){for(var o=i.result,s=new Uint8Array(o),c=s.byteLength,l=0;l<c;l++)a+=String.fromCharCode(s[l]);if(t=ge.a.read(a,{type:"binary"}),"批次号"===t.Sheets.Sheet1.A1.h)if("箱号"===t.Sheets.Sheet1.B1.h){r=ge.a.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]);var u=[],d="批次号",m="箱号";r.map(function(e){u.push({batchNo:e[d],boxNo:e[m]})});for(var p=!0,f=0;f<u.length;f++){var h=u[f];if(!h.batchNo){p=!1,n.$message.error("文件第".concat(f+2,"行批次号为空"));break}if(!h.boxNo){p=!1,n.$message.error("文件第".concat(f+2,"行箱号为空"));break}}p&&(n.importBoxs=u.reduce(function(e,t){var r=e.find(function(e){return e.batchNo===t.batchNo});if(r)r.boxs.push(t.boxNo);else{var n={batchNo:t.batchNo,boxs:[]};n.boxs.push(t.boxNo),e.push(n)}return e},[]))}else n.$message.error("文件表头[".concat(t.Sheets.Sheet1.B1.h,"]不正确，请下载模板检查"));else n.$message.error("文件表头[".concat(t.Sheets.Sheet1.A1.h,"]不正确，请下载模板检查"))},i.onerror=function(){n.$message.error("文件错误,请检查文件重新导入")},i.readAsArrayBuffer(e)},a.readAsBinaryString(r)}}},{key:"handleSubmit",value:function(){var e=this,t=this.$refs.importForm;0!==this.importBoxs.length?t.validate(function(t){if(t){var r=e.warehouseList.find(function(t){return t.warehouseId===e.form.warehouse}),n={attribute:"1",code:e.form.code,express:{expressId:"",expressName:"",no:""},io:"I",loading:"1",mode:"0",source:"0",supplement:{certNo:"",certType:"",driver:"",modeNo:"",phone:""},type:"2",volume:r.maximum,warehouse:{custId:r.custId,custName:r.custName,address:r.address,cityId:r.cityId,contact:r.principal,countryId:r.countryId,countyId:r.countyId,id:r.warehouseId,name:r.name,stateId:r.stateId,tel:r.phoneNo,cityName:r.cityName,countryName:r.countryName,stateName:r.stateName},weight:r.weight,batches:e.importBoxs.map(function(t,r){return{code:e.form.code+"-"+(r+1),height:10,length:10,packages:(t.boxs||[]).length,weight:10,width:10,boxes:(t.boxs||[]).map(function(e){return{code:e}}),wgoods:[{}].map(function(e){return{goodsAlias:"system product",goodsName:"系统商品",picture:"",price:1,quantity:1}})}}),description:"",examine:e.orderServiceData.examine,examineRatio:e.orderServiceData.examineRatio?e.orderServiceData.examineRatio/100:0,examineType:e.orderServiceData.examineType,examineId:e.orderServiceData.examineId,examineName:e.orderServiceData.examineName,examingTag:!1,inTime:M()().add(1,"h").format("YYYY-MM-DD HH:mm:ss"),remark:"",service:{key:e.orderServiceData.id,value:e.orderServiceData.name},um:{currencyId:r.currencyId,currencyName:r.currencyName,umLength:r.unitOfLength,umPackage:"0",umWeight:r.unitOfWeight}};e.loading=!0,I(n).then(function(){e.loading=!1,e.$message.success("导入下单成功"),e.visible=!1,e.$emit("load")}).catch(function(){e.loading=!1})}}):this.$message.warning("请导入箱号信息")}},{key:"getServiceInfoByType",value:function(){var e=this;T({type:"2"}).then(function(t){e.orderServiceData=t.data}).catch(function(){e.orderServiceData={}})}},{key:"importBySys1",value:function(){var e=this,t=this.form.code;if(!t)return this.$message.error("请输入原单号");this.loading=!0,D({code:t}).then(function(r){var n=r.data||{},a=n.data||[],i=a.map(function(e){return e.fba_code}),o=[{batchNo:"".concat(t,"-1"),boxs:i}];e.importBoxs=o,e.loading=!1}).catch(function(t){return e.loading=!1,t})}},{key:"downloadFile",value:function(){var e=document.createElement("a");document.body.appendChild(e),e.href="http://file.jhtinfo.net/A0/box_id_templete.xlsx",e.click(),document.body.removeChild(e)}},{key:"getSupplierList",value:function(){var e=this,t={page:1,size:999,status:1,subtypeId:"02"};this.selectLoading=!0,Object(ye["B"])(t).then(function(t){e.selectLoading=!1;var r=t.data||{};e.supplierList=r.result||[]}).catch(function(){e.selectLoading=!1,e.supplierList=[]})}},{key:"getWarehouseList",value:function(){var e=this,t={model:{key:"www",keyType:"1",subtypeId:"2",typeId:"04"},page:1,size:999};this.selectLoading=!0,F(t).then(function(t){e.selectLoading=!1;var r=t.data||{};e.warehouseList=r.result||[]}).catch(function(){e.selectLoading=!1,e.warehouseList=[]})}},{key:"boxNum",get:function(){return this.importBoxs.reduce(function(e,t){var r=t.boxs||[];return e+=r.length,e},0)}}]),t}(h["e"]);we=f["a"]([Object(h["a"])({name:"ImportOrder"})],we);var _e=we,xe=_e,Oe=Object(G["a"])(xe,he,ve,!1,null,"9bf88104",null),ke=Oe.exports,Se=r("35b2"),je=r("bef3"),Ce=r("72ae");function Le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Le(r,!0).forEach(function(t){Object(s["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Le(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Ie=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(m["a"])(t).apply(this,arguments)),e.detailShow="i",e.loading=!1,e.isCustomerVisible=!1,e.isWarehouseVisible=!1,e.isLogVisible=!1,e.selectLoading=!1,e.excelLoading=!1,e.isEdit=!1,e.printShow=!1,e.selectType="1",e.printCode="",e.printType="",e.moreObj={},e.companyTypeList=[{id:"1",name:"客户"},{id:"2",name:"二级代理商"}],e.orderTypeList=[{name:"销售订单",id:"0"},{name:"采购订单",id:"1"}],e.tableData=[],e.tableList=[],e.orderStatusList2=[{name:"未拆柜",id:"0"},{name:"拆柜中",id:"1"},{name:"继续拆柜",id:"2"},{name:"已完成",id:"3"}],e.searchForm={status:void 0,from:void 0,type:"2",loading:void 0,custId:void 0,code:void 0,countryId:void 0,warehouseId:void 0,comId:void 0,comType:"",orderType:"0",orderTime:[]},e.title="仓库信息",e.selectForm={},e.page=1,e.size=10,e.total=0,e.typeList=[{name:"仓储",id:"1"},{name:"散收拼货",id:"2"},{name:"拆柜打托",id:"3"}],e.statusList=[],e.loadList=[{name:"托盘",id:"0"},{name:"箱子",id:"1"},{name:"家具等超大件",id:"2"}],e.warehouseList=[],e.customerList=[],e.supplierList=[],e.agentList=[],e.companyList=[],e.countryList=[],e}return Object(p["a"])(t,e),Object(u["a"])(t,[{key:"showFinancial",value:function(e){this.detailShow="f";var t=this.$refs.financial;t.show(e,this.searchForm.orderType)}},{key:"showPrint",value:function(e){this.printType=e,this.printShow=!0,this.printCode=""}},{key:"printClickNew",value:function(){if(this.printCode.trim()){var e=this.$refs.print;e.printInit(this.printCode,"m1015")}else this.$message.warning("请输入原单号")}},{key:"printClick",value:function(){if(this.printCode.trim())if(this.printShow=!1,"1"===this.printType){var e=this.$router.resolve({path:"/order-file",query:{code:this.printCode.trim()}}),t=e.href;window.open(t,"_blank")}else window.open("http://120.24.86.36:6868/demo/reportJsp/showReport.jsp?rpx=report/%E9%80%81%E8%B4%A7%E5%94%9B%E5%A4%B410-15.rpx&ikey="+this.printCode.trim());else this.$message.warning("请输入原单号")}},{key:"addRemoval",value:function(e){var t=this;this.$confirm("您确认要生成拆柜任务单吗","提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){var r={code:e.id};t.loading=!0,Object(Ce["a"])(r).then(function(){t.loading=!1,t.$message.success("拆柜任务单生成成功"),t.getTableData(1)}).catch(function(){t.loading=!1})}).catch(function(){return!1})}},{key:"typeChange",value:function(){var e=this;this.tableData=[],this.tableList=[],this.searchForm.from=void 0,this.$nextTick(function(){e.getTableData(1)})}},{key:"showDownDialog",value:function(){var e=this.moreObj.express||{},t=this.$refs.expressExport;t.show(e.trackingNos||"")}},{key:"handleMore",value:function(e){this.moreObj=e}},{key:"handleCommand",value:function(e){switch(e){case"1":this.downZipData(this.moreObj);break;case"2":this.downPdfData(this.moreObj,"2");break;case"6":this.downPdfData(this.moreObj,"6");break;case"3":this.showDownDialog();break;default:break}}},{key:"downZipData",value:function(e){var t=this;e.code?N({orderNo:e.code}).then(function(e){if(e.type&&-1!==e.type.indexOf("octet-stream")){var r=window.URL.createObjectURL(e),n=document.createElement("a");document.body.appendChild(n),n.href=r,n.download="快递订单"+M()().format("YYYY-MM-DD_HH-mm-ss")+".zip",n.click(),window.URL.revokeObjectURL(r),document.body.removeChild(n)}else t.$message.error("暂无快递标签")}).catch(function(e){e.data.text().then(function(e){try{var r=JSON.parse(e);200!==r.code&&t.$message.error(r.msg||"文件下载失败")}catch(n){return n}})}):this.$message.error("原单号不存在")}},{key:"downPdfData",value:function(e,t){var r=this;if(e.code){var n=null;if("2"===t)n=$;else{if("6"!==t)return;n=R}n({orderNo:e.code}).then(function(e){var t=window.URL.createObjectURL(e),r=document.createElement("a");document.body.appendChild(r),r.href=t,r.download="快递订单"+M()().format("YYYY-MM-DD_HH-mm-ss")+".pdf",r.click(),window.URL.revokeObjectURL(t),document.body.removeChild(r)}).catch(function(e){e.data.text().then(function(e){try{var t=JSON.parse(e);200!==t.code&&r.$message.error(t.msg||"文件下载失败")}catch(n){return n}})})}else this.$message.error("原单号不存在")}},{key:"showImportOrder",value:function(){this.$refs.ImportOrder.show()}},{key:"handleExport",value:function(){var e=this;if("2"===this.searchForm.type){this.excelLoading=!0;var t=this.custType;"1"===t?this.searchForm.orderType="1":"3"===t&&(this.searchForm.orderType="0");var r=this.searchForm,n=(r.comType,r.orderTime),a=Object(c["a"])(r,["comType","orderTime"]),i=Te({},a);Array.isArray(n)&&n.length>0&&(i.startTime=n[0],i.endTime=n[1]),"2"===this.selectType&&(i.so=i.code,delete i.code),A(Te({},i)).then(function(t){e.excelLoading=!1;var r=document.createElement("a");document.body.appendChild(r);var n=new Blob([t],{type:"application/vnd.ms-excel"}),a=URL.createObjectURL(n);r.href=a,r.download="仓库订单"+M()().format("YYYY-MM-DD_HH-mm-ss")+".xls",r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}).catch(function(t){e.excelLoading=!1,t.data.text().then(function(t){try{var r=JSON.parse(t);200!==r.code&&e.$message.error(r.msg||"文件下载失败")}catch(n){return n}})})}else this.$message.error("仅支持散收拼货")}},{key:"getStatusList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(je["c"])().then(function(e){t.statusList=(e.data||[]).map(function(e){return{name:e.name,id:e.key,type:e.type}}).filter(function(e){return"WS_IN"===e.type})}).catch(function(){t.statusList=[]});case 2:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"volumesFilter",value:function(e,t){return"CBCM"===t?(1e-6*e).toFixed(3):"CBM"===t?e.toFixed(3):"CUIN"===t?(164e-7*e).toFixed(3):"CUFT"===t?(.0283168*e).toFixed(3):void 0}},{key:"onOrderType",value:function(){this.tableData=[],this.tableList=[],"1"===this.searchForm.orderType&&(this.searchForm.comType="",this.searchForm.comId="",this.companyList=[]),"0"===this.custType&&this.getTableData(1)}},{key:"onComType",value:function(){this.searchForm.comId="",this.companyList=[],this.tableData=[],this.tableList=[]}},{key:"onCompany",value:function(){this.tableData=[],this.tableList=[],this.getTableData(1)}},{key:"getCompanyList",value:function(){var e=this,t={page:1,size:9999},r=this.custType,n=this.custSubtype,a=null;if("2"!==r||"1"!==this.searchForm.comType&&"2"!==n)if("2"===r&&"2"===this.searchForm.comType)t.parentId=this.custId,t.subtype="2",t.types="04",a=_;else{if("0"!==r)return void(this.companyList=[]);t.parentId=this.custId,t.subtype="1",t.types="04",a=_}else t.custIds=[this.custId],a=x;this.selectLoading=!0,a(t).then(function(t){if("2"!==r||"1"!==e.searchForm.comType&&"2"!==n){var a=t.data||{};e.companyList=a.result||[]}else{var i=t.data||[];e.companyList=i}e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"getWarehouseList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectLoading=!0,t=this.custType,"3"!==t){e.next=8;break}return r={model:{custId:this.custId},page:1,size:9999},e.next=6,b(r).then(function(e){var t=e.data||{};n.warehouseList=t.result||[],n.selectLoading=!1}).catch(function(e){return n.selectLoading=!1,e});case 6:e.next=9;break;case 8:w().then(function(e){var t=e.data||[];n.warehouseList=t,n.selectLoading=!1}).catch(function(e){return n.selectLoading=!1,e});case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"formmatStatus",value:function(e){var t=this.statusList.find(function(t){return t.id===e.status.WS_IN})||{};return t.name||"--"}},{key:"formmatStatus2",value:function(e){var t=this.orderStatusList2.find(function(t){return Number(t.id)===Number(e.status)})||{};return t.name||"--"}},{key:"formmatCode",value:function(e){var t=e.batchBox||{},r=t.batchNumber||[];return r.map(function(e){return e.code}).filter(function(e){return e}).join(",")}},{key:"formmatType",value:function(e){var t=this.typeList.find(function(t){return Number(t.id)===Number(e.type)})||{};return t.name||"--"}},{key:"formmatLoading",value:function(e){var t=e.loading||e.loadingType,r=this.loadList.find(function(e){return Number(e.id)===Number(t)})||{};return r.name||"--"}},{key:"moveOrder",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a,o,s,c,l,u,d,m,p=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将流转该订单，是否继续？","提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(e){return[null,e]}).catch(function(e){return[e,null]});case 2:if(r=e.sent,n=Object(i["a"])(r,2),a=n[0],n[1],!a){e.next=8;break}return e.abrupt("return");case 8:this.loading=!0,o=this.custType,s=this.custSubtype,"0"===o?c="3":"1"===o&&(c="0"),"2"===o&&"1"===s?c="1":"2"===o&&"2"===s&&(c="2"),"0"===o?this.warehouseList.map(function(e){t.warehouseId===e.id&&(l=e.custId,u=e.custName)}):(l=this.parentId,u=this.parentName),d=t.id,m={buyerType:c,orderId:d,sellerId:l,sellerName:u},k(m).then(function(e){p.$message({type:"success",message:"流转订单成功"}),p.getTableData()}).catch(function(e){return p.loading=!1,e});case 17:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"resetForm",value:function(){this.selectForm={}}},{key:"viewLog",value:function(){this.isEdit=!1,this.isLogVisible=!0}},{key:"cancel",value:function(){this.isCustomerVisible=!1,this.isWarehouseVisible=!1,this.isLogVisible=!1,this.resetForm()}},{key:"onCustomer",value:function(e){this.isCustomerVisible=!0}},{key:"onWarehouse",value:function(e){this.isWarehouseVisible=!0}},{key:"viewData",value:function(e){this.detailShow="d";var t=this.$refs.detailForm;t.setData(e)}},{key:"deleteData",value:function(e){var t=this,r={id:e.id};this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){var n=null;n="3"===e.type?L:C,n&&n(r).then(function(e){t.$message({type:"success",message:"删除成功"}),t.getTableData()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"getTableData",value:function(e){var t=this;this.loading=!0;var r=this.custType;"1"===r?this.searchForm.orderType="1":"3"===r&&(this.searchForm.orderType="0");var n=this.searchForm,a=(n.comType,n.orderTime),i=Object(c["a"])(n,["comType","orderTime"]);e&&(this.page=e);var o={page:this.page,size:this.size,model:Te({},i)};Array.isArray(a)&&a.length>0&&(o.model.startDate=a[0],o.model.endDate=a[1]),this.$nextTick(function(){"3"===t.searchForm.type?(o.model.loadingType=o.model.loading,o.model.startTime=a[0],o.model.endTime=a[1],"2"===t.selectType&&(o.model.so=o.model.code,delete o.model.code),B(o).then(function(e){t.loading=!1;var r=e.data||{};t.tableList=r.result||[],t.total=r.total}).catch(function(e){return t.loading=!1,e})):O(o).then(function(e){t.loading=!1;var r=e.data||{};t.tableData=r.result||[],t.total=r.total}).catch(function(e){return t.loading=!1,e})})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.getTableData()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.getTableData()}},{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.custType,this.custSubtype,this.searchForm.orderTime=[M()().subtract(30,"d").format("YYYY-MM-DD"),M()().format("YYYY-MM-DD")],this.loading=!0,e.next=6,this.getStatusList();case 6:return e.next=8,this.getWarehouseList();case 8:this.getTableData();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"custId",get:function(){var e=v["a"].info||{},t=e.custId;return t}},{key:"custType",get:function(){var e=v["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=v["a"].info||{},t=e.custSubtype;return t}},{key:"parentId",get:function(){var e=v["a"].info||{},t=e.parentId;return t}},{key:"parentName",get:function(){var e=v["a"].info||{},t=e.parentName;return t}}]),t}(h["e"]);Ie=f["a"]([Object(h["a"])({name:"",components:{detail:K,ImportOrder:ke,detail2:ne,expressExport:Se["a"],print:Y["a"],orderFinancial:fe},props:{}})],Ie);var De=Ie,Fe=De,Ne=(r("6a57"),Object(G["a"])(Fe,n,a,!1,null,"4b41c2c4",null));t["default"]=Ne.exports},"40ea":function(e,t,r){},"6a57":function(e,t,r){"use strict";var n=r("9147"),a=r.n(n);a.a},"72ae":function(e,t,r){"use strict";r.d(t,"d",function(){return a}),r.d(t,"c",function(){return i}),r.d(t,"e",function(){return o}),r.d(t,"a",function(){return s}),r.d(t,"b",function(){return c});var n=r("b32d");function a(e){var t={url:"/orders/removal/task_page",method:"post",data:e};return Object(n["a"])(t)}function i(e){var t={url:"/orders/removal/task_page_details",method:"post",data:e};return Object(n["a"])(t)}function o(e){var t={url:"/orders/removal/details_save",method:"post",data:e};return Object(n["a"])(t)}function s(e){var t={url:"/orders/removal/scan_add",method:"get",params:e};return Object(n["a"])(t)}function c(e){var t={url:"/orders/removal/details_audit",method:"post",data:e};return Object(n["a"])(t)}},"7dfc":function(e,t,r){"use strict";r.d(t,"Q",function(){return s}),r.d(t,"o",function(){return c}),r.d(t,"p",function(){return l}),r.d(t,"U",function(){return u}),r.d(t,"W",function(){return d}),r.d(t,"V",function(){return m}),r.d(t,"s",function(){return p}),r.d(t,"t",function(){return f}),r.d(t,"D",function(){return h}),r.d(t,"E",function(){return v}),r.d(t,"A",function(){return y}),r.d(t,"h",function(){return b}),r.d(t,"X",function(){return g}),r.d(t,"Y",function(){return w}),r.d(t,"B",function(){return _}),r.d(t,"C",function(){return x}),r.d(t,"H",function(){return O}),r.d(t,"G",function(){return k}),r.d(t,"i",function(){return S}),r.d(t,"a",function(){return j}),r.d(t,"l",function(){return C}),r.d(t,"x",function(){return L}),r.d(t,"M",function(){return T}),r.d(t,"J",function(){return I}),r.d(t,"I",function(){return D}),r.d(t,"K",function(){return F}),r.d(t,"b",function(){return N}),r.d(t,"m",function(){return $}),r.d(t,"j",function(){return R}),r.d(t,"q",function(){return B}),r.d(t,"L",function(){return A}),r.d(t,"P",function(){return z}),r.d(t,"N",function(){return P}),r.d(t,"O",function(){return E}),r.d(t,"k",function(){return M}),r.d(t,"c",function(){return Y}),r.d(t,"n",function(){return U}),r.d(t,"v",function(){return V}),r.d(t,"f",function(){return W}),r.d(t,"e",function(){return q}),r.d(t,"d",function(){return H}),r.d(t,"g",function(){return G}),r.d(t,"z",function(){return J}),r.d(t,"w",function(){return K}),r.d(t,"r",function(){return Z}),r.d(t,"R",function(){return Q}),r.d(t,"y",function(){return X}),r.d(t,"S",function(){return ee}),r.d(t,"F",function(){return te}),r.d(t,"T",function(){return re}),r.d(t,"u",function(){return ne});r("8e6e"),r("ac6a"),r("456d");var n=r("bd86"),a=r("b32d");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(r,!0).forEach(function(t){Object(n["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function s(e){var t={url:"/auth/supplier/getSupplierList",method:"get",params:e};return Object(a["a"])(t)}function c(e){var t={url:"/auth/agent/getAgentList",method:"get",params:e};return Object(a["a"])(t)}function l(e){var t={url:"/cfg/type/getServiceTypeList",method:"get",params:e};return Object(a["a"])(t)}function u(e){var t={url:"/auth/custtype/getServerType",method:"get",params:e};return Object(a["a"])(t)}function d(e){var t={url:"/finance/account/rollback",method:"get",params:e};return Object(a["a"])(t)}function m(e){var t={url:"/orders/worder/getOrderList",method:"post",data:e};return Object(a["a"])(t)}function p(e){var t={url:"/finance/costitem/getCostitemList",method:"get",params:e};return Object(a["a"])(t)}function f(e){var t={url:"/setting/currency/getCurrencyList",method:"get",params:o({page:1,size:999},e)};return Object(a["a"])(t)}function h(e){var t={url:"/finance/account/page",method:"post",data:e};return Object(a["a"])(t)}function v(e){var t={url:"finance/account/order_invoice",method:"post",data:e};return Object(a["a"])(t)}function y(e){var t={url:"/finance/account/getInvoice",method:"get",params:e};return Object(a["a"])(t)}function b(e){var t={url:"/finance/account/deleteInvoice",method:"post",params:e};return Object(a["a"])(t)}function g(e){var t={url:"/finance/account/saveInvoice",method:"post",data:e};return Object(a["a"])(t)}function w(e){var t={url:"/finance/account/updateInvoice",method:"post",data:e};return Object(a["a"])(t)}function _(e){var t={url:"/finance/account/exportAll",method:"post",responseType:"blob",data:e};return Object(a["a"])(t)}function x(e){var t={url:"/finance/account/export2",method:"post",responseType:"blob",data:e};return Object(a["a"])(t)}function O(e){var t={url:"/finance/p/page",method:"post",data:e};return Object(a["a"])(t)}function k(e){var t={url:"/finance/p/get",method:"get",params:e};return Object(a["a"])(t)}function S(e){var t={url:"/auth/p/del",method:"delete",params:e};return Object(a["a"])(t)}function j(e){var t={url:"/finance/p/add",method:"post",data:e};return Object(a["a"])(t)}function C(e){var t={url:"/finance/p/edit",method:"post",data:e};return Object(a["a"])(t)}function L(e){var t={url:"/setting/exchange/rate",method:"get",params:e};return Object(a["a"])(t)}function T(e){var t={url:"/finance/r/page",method:"post",data:e};return Object(a["a"])(t)}function I(e){var t={url:"/finance/account/query",method:"post",data:e};return Object(a["a"])(t)}function D(e){var t={url:"/finance/r/payback",method:"get",params:e};return Object(a["a"])(t)}function F(e){var t={url:"/finance/r/info",method:"get",params:e};return Object(a["a"])(t)}function N(e){var t={url:"/finance/r/add",method:"post",data:e};return Object(a["a"])(t)}function $(e){var t={url:"/finance/r/edit",method:"post",data:e};return Object(a["a"])(t)}function R(e){var t={url:"/auth/r/del",method:"delete",params:e};return Object(a["a"])(t)}function B(e){var t={url:"/auth/acct/getAcctList",method:"get",params:e};return Object(a["a"])(t)}function A(e){var t={url:"/finance/r/export",method:"post",responseType:"blob",data:e};return Object(a["a"])(t)}function z(e){var t={url:"/finance/apply/page",method:"post",data:e};return Object(a["a"])(t)}function P(e){var t={url:"/finance/account/handel",method:"post",data:e};return Object(a["a"])(t)}function E(e){var t={url:"/finance/apply/get",method:"get",params:e};return Object(a["a"])(t)}function M(e){var t={url:"/auth/apply/del",method:"delete",params:e};return Object(a["a"])(t)}function Y(e){var t={url:"/finance/apply/add",method:"post",data:e};return Object(a["a"])(t)}function U(e){var t={url:"/finance/apply/edit",method:"post",data:e};return Object(a["a"])(t)}function V(e){var t={url:"/auth/customer/customer",method:"post",data:e};return Object(a["a"])(t)}function W(e){var t={url:"/finance/account/audit",method:"get",params:e};return Object(a["a"])(t)}function q(e){var t={url:"/finance/r/audit",method:"get",params:e};return Object(a["a"])(t)}function H(e){var t={url:"/auth/apply/audit",method:"post",params:e};return Object(a["a"])(t)}function G(e){var t={url:"/auth/p/audit",method:"post",params:e};return Object(a["a"])(t)}function J(e){var t={url:"/orders/fullorder/getOrderList",method:"post",data:e};return Object(a["a"])(t)}function K(e){var t={url:"/orders/declare_order/get_declare_data",method:"post",data:e};return Object(a["a"])(t)}function Z(e){var t={url:"/orders/card/get_data",method:"post",data:e};return Object(a["a"])(t)}function Q(e){var t={url:"/orders/trailer/page",method:"post",data:e};return Object(a["a"])(t)}function X(e){var t={url:"/express/web/expressorder/list",method:"post",data:e};return Object(a["a"])(t)}function ee(){var e={url:"/auth/agent/customer_finance",method:"get"};return Object(a["a"])(e)}function te(e){var t={url:"/finance/bill/billPage",method:"post",data:e};return Object(a["a"])(t)}function re(e){var t={url:"/finance/account/unverified",method:"post",data:e};return Object(a["a"])(t)}function ne(e){var t={url:"/auth/supplier/custType",method:"post",data:e};return Object(a["a"])(t)}},8115:function(e,t,r){"use strict";var n=r("cd01"),a=r.n(n);a.a},9147:function(e,t,r){},c4dc:function(e,t,r){},cd01:function(e,t,r){},fa89:function(e,t,r){"use strict";var n=r("40ea"),a=r.n(n);a.a}}]);