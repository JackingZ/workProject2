(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["car-management"],{"097e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("head-info",{attrs:{title:"车辆管理",info:""}}),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-panel"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["addVehicle"],expression:"['addVehicle']"}],attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.addCar}},[e._v("\n          新增车辆\n        ")])],1),a("el-col",{attrs:{span:21}},[a("div",{staticStyle:{"text-align":"right"}},[a("el-select",{directives:[{name:"show",rawName:"v-show",value:"0"===e.custId,expression:"custId === '0'"}],staticStyle:{width:"200px","margin-right":"5px"},attrs:{placeholder:"所属公司",size:"small",filterable:""},on:{change:e.onSupplier},model:{value:e.searchForm.custId,callback:function(t){e.$set(e.searchForm,"custId",t)},expression:"searchForm.custId"}},e._l(e.supplierList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),a("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"车牌号",size:"small"},model:{value:e.searchForm.plateNumber,callback:function(t){e.$set(e.searchForm,"plateNumber",t)},expression:"searchForm.plateNumber"}}),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["queryVehicle"],expression:"['queryVehicle']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getTableList(1)}}},[e._v("\n            查询\n          ")])],1)])],1),a("el-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,border:"",height:"calc(100vh - 313px)"}},[a("el-table-column",{attrs:{prop:"plateNumber",label:"车牌号"}}),a("el-table-column",{attrs:{prop:"vehicleTypeName",label:"车型"}}),a("el-table-column",{attrs:{prop:"plateDate",label:"上牌时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.dayjs(t.row.plateDate).format("YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"grade",label:"车况"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.grade?a("span",[e._v("良好")]):"1"===t.row.grade?a("span",[e._v("维修")]):"2"===t.row.grade?a("span",[e._v("其他")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"expire",label:"保险到期日"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.dayjs(t.row.expire).format("YYYY-MM-DD")))])]}}])}),a("el-table-column",{attrs:{prop:"insurance",label:"三者险保额"}}),a("el-table-column",{attrs:{prop:"tailboard",label:"是否有尾板"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.tailboard?a("span",[e._v("√")]):t.row.tailboard?e._e():a("span",[e._v("×")])]}}])}),a("el-table-column",{attrs:{prop:"gps",label:"是否有GPS"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.gps?a("span",[e._v("√")]):t.row.gps?e._e():a("span",[e._v("×")])]}}])}),a("el-table-column",{attrs:{prop:"custName",label:"所属公司"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["editVehicle"],expression:"['editVehicle']"}],attrs:{type:"text",size:"small"},on:{click:function(a){return e.editCar(t.row)}}},[e._v("\n            编辑\n          ")]),e._v("\n           \n          "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["deleteVehicle"],expression:"['deleteVehicle']"}],attrs:{type:"text",size:"small"},on:{click:function(a){return e.deletRow(t.row.id)}}},[e._v("\n            删除\n          ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.pageNumber,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.isEdit?"编辑车辆":"新增车辆",width:"600px",visible:e.isShowUpdate,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isShowUpdate=t},closed:e.close}},[a("add-edit-form",{ref:"editForm",attrs:{"is-edit":e.isEdit},on:{close:e.close,getTableList:function(t){return e.getTableList(1)}}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.close}},[e._v("\n          取 消\n        ")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("\n          确 定\n        ")])],1)],1)],1)],1)},r=[],l=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),s=a("d225"),n=a("b0b4"),o=a("308d"),c=a("6bb5"),u=a("4e2b"),p=a("9ab4"),d=a("60a3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{ref:"userRoot",staticStyle:{padding:"0 40px 0 20px"},attrs:{model:e.form,rules:e.formRules,"label-position":"right","label-width":"100px",size:"small"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"0"===e.custId,expression:"custId === '0'"}],attrs:{label:"所属公司",prop:"custId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"所属公司",size:"small",loading:e.selectLoading,disabled:e.isEdit},on:{focus:e.getSupplierList},model:{value:e.form.custId,callback:function(t){e.$set(e.form,"custId",t)},expression:"form.custId"}},e._l(e.supplierList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"车牌号",prop:"plateNumber"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",disabled:e.isEdit},model:{value:e.form.plateNumber,callback:function(t){e.$set(e.form,"plateNumber",t)},expression:"form.plateNumber"}})],1),a("el-form-item",{attrs:{label:"上牌时间",prop:"plateDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"年/月/日","picker-options":{disabledDate:e.disabledDate}},model:{value:e.form.plateDate,callback:function(t){e.$set(e.form,"plateDate",t)},expression:"form.plateDate"}})],1),a("el-form-item",{attrs:{label:"关联车型",prop:"vehicleTypeId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",loading:e.loadVehicleTypeList},on:{focus:e.getVehicleTypeList},model:{value:e.form.vehicleTypeId,callback:function(t){e.$set(e.form,"vehicleTypeId",t)},expression:"form.vehicleTypeId"}},e._l(e.vehicleTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"车况",prop:"grade"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}},[a("el-option",{attrs:{label:"良好",value:"0"}}),a("el-option",{attrs:{label:"维修",value:"1"}}),a("el-option",{attrs:{label:"其他",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"保险到期日",prop:"expire"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"年/月/日"},model:{value:e.form.expire,callback:function(t){e.$set(e.form,"expire",t)},expression:"form.expire"}})],1),a("el-form-item",{attrs:{label:"三者险保额",prop:"insurance"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",size:"small",min:0,precision:2},model:{value:e.form.insurance,callback:function(t){e.$set(e.form,"insurance",t)},expression:"form.insurance"}})],1),a("el-form-item",{attrs:{label:"是否有尾板",prop:"tailboard"}},[a("el-radio-group",{model:{value:e.form.tailboard,callback:function(t){e.$set(e.form,"tailboard",t)},expression:"form.tailboard"}},[a("el-radio",{attrs:{label:!0}},[e._v("\n          是\n        ")]),a("el-radio",{attrs:{label:!1}},[e._v("\n          否\n        ")])],1)],1),a("el-form-item",{attrs:{label:"是否有GPS",prop:"gps"}},[a("el-radio-group",{model:{value:e.form.gps,callback:function(t){e.$set(e.form,"gps",t)},expression:"form.gps"}},[a("el-radio",{attrs:{label:!0}},[e._v("\n          是\n        ")]),a("el-radio",{attrs:{label:!1}},[e._v("\n          否\n        ")])],1)],1)],1)],1)},f=[],h=(a("7f7f"),a("9dba")),v=a("ac1a"),g=a("b32d");function b(e){var t={url:"/setting/vehicle/getVehicleList",method:"get",params:e};return Object(g["a"])(t)}function y(e){var t={url:"/setting/vehicle/deleteVehicle",method:"delete",params:{id:e}};return Object(g["a"])(t)}function k(e){var t={url:"/setting/vehicle/saveVehicle",method:"post",data:e};return Object(g["a"])(t)}function w(e){var t={url:"/auth/supplier/getSupplierList",method:"get",params:e};return Object(g["a"])(t)}function x(e){var t={url:"/setting/vehicletype/getVehicleTypeList",method:"get",params:e};return Object(g["a"])(t)}var O=a("5a0c"),S=a.n(O);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(a,!0).forEach(function(t){Object(l["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var N=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.loading=!1,e.selectLoading=!1,e.loadVehicleTypeList=!1,e.form={id:void 0,custId:void 0,custName:void 0,expire:void 0,gps:!0,grade:void 0,insurance:void 0,plateDate:void 0,plateNumber:void 0,tailboard:!0,vehicleTypeId:void 0,vehicleTypeName:void 0},e.vehicleTypeList=[],e.supplierList=[],e.formRules={custId:[{required:!0,message:"请选择所属公司",trigger:"change"}],plateNumber:[{required:!0,message:"车牌号不能为空",trigger:"blur"},{validator:e.validatorPlateNumber,trigger:"change"}],plateDate:[{required:!0,message:"请选择上牌时间",trigger:"change"}],vehicleTypeId:[{required:!0,message:"请选择关联车型",trigger:"change"}],grade:[{required:!0,message:"请选择车况",trigger:"change"}],expire:[{required:!0,message:"请选择保险到期日",trigger:"change"}],insurance:[{required:!0,message:"三者险保额不能为空",trigger:"blur"}],tailboard:[{required:!0,message:"请选择是否有尾板",trigger:"change"}],gps:[{required:!0,message:"请选择是否有GPS",trigger:"change"}]},e}return Object(u["a"])(t,e),Object(n["a"])(t,[{key:"setCust",value:function(){this.reset(),"0"!==this.custId&&(this.form.custId=this.custId,this.form.custName=this.custName,this.getSupplierList())}},{key:"validatorPlateNumber",value:function(e,t,a){if(t){var i=/([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}(([0-9]{5}[DF])|([DF]([A-HJ-NP-Z0-9])[0-9]{4}))$)|([京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-HJ-NP-Z0-9]{4}[A-HJ-NP-Z0-9挂学警港澳]{1}$)/;i.test(t)?a():a(new Error("请输入正确的车牌号"))}}},{key:"disabledDate",value:function(e){return e>S()()}},{key:"setData",value:function(e){this.reset(),this.getSupplierList(),this.getVehicleTypeList(),this.form=e}},{key:"getSupplierList",value:function(){var e=this;this.selectLoading=!0;var t=this.custId,a={page:1,size:99999,parentId:t};w(a).then(function(t){var a=t.data||{};e.supplierList=a.result||[],e.supplierList.unshift({id:"0",name:"聚货通"}),e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"getVehicleTypeList",value:function(){var e=this,t={page:1,size:99999};this.loadVehicleTypeList=!0,x(t).then(function(t){if(e.loadVehicleTypeList=!1,t.success){var a=t.data||{},i=a.result||[];e.vehicleTypeList=i}}).catch(function(t){return e.loadVehicleTypeList=!1,t})}},{key:"saveUser",value:function(){var e=this,t=this.$refs.userRoot;t.validate(function(t){if(t){e.loading=!0;var a=j({},e.form);e.supplierList.map(function(e){e.id===a.custId&&(a.custName=e.name)}),e.vehicleTypeList.map(function(e){e.id===a.vehicleTypeId&&(a.vehicleTypeName=e.name)}),k(a).then(function(t){e.loading=!1,e.$message({type:"success",message:"保存成功!"}),e.$emit("getTableList"),e.reset(),e.$emit("close")}).catch(function(t){return e.loading=!1,t})}})}},{key:"reset",value:function(){var e=this,t={id:void 0,custId:void 0,custName:void 0,expire:void 0,gps:!0,grade:void 0,insurance:void 0,plateDate:void 0,plateNumber:void 0,tailboard:!0,vehicleTypeId:void 0,vehicleTypeName:void 0};this.form=t,this.$nextTick(function(){var t=e.$refs.userRoot;t.clearValidate()})}},{key:"lang",get:function(){var e=v["a"].language;return e||"en"}},{key:"custId",get:function(){var e=h["a"].info||{},t=e.custId;return t}},{key:"custName",get:function(){var e=h["a"].info||{},t=e.custName;return t}}]),t}(d["e"]);N=p["a"]([Object(d["a"])({name:"AddEditForm",components:{},props:{isEdit:{type:Boolean,default:!1}}})],N);var T=N,_=T,I=(a("e162"),a("2877")),D=Object(I["a"])(_,m,f,!1,null,"64a004ad",null),$=D.exports;function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach(function(t){Object(l["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var z=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(o["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.dayjs=S.a,e.tableData=[],e.supplierList=[],e.searchForm={custId:e.custId,plateNumber:void 0},e.isShowUpdate=!1,e.pageSize=10,e.pageNumber=1,e.totalCount=0,e.isEdit=!1,e.loading=!1,e}return Object(u["a"])(t,e),Object(n["a"])(t,[{key:"created",value:function(){"0"===this.custId&&this.getSupplierList(),this.getTableList()}},{key:"getSupplierList",value:function(){var e=this,t=this.custId,a={page:1,size:99999,parentId:t};w(a).then(function(t){var a=t.data||{};e.supplierList=a.result||[],e.supplierList.unshift({id:"0",name:"聚货通"})}).catch(function(e){return e})}},{key:"onSupplier",value:function(){this.tableData=[],this.getTableList()}},{key:"getTableList",value:function(e){var t=this;1===e&&(this.pageNumber=1);var a=V({page:this.pageNumber,size:this.pageSize},this.searchForm);this.loading=!0,b(a).then(function(e){t.loading=!1;var a=e.data;t.totalCount=a.total,t.tableData=a.result||[]}).catch(function(){t.loading=!1})}},{key:"deletRow",value:function(e){var t=this;this.$confirm("删除车辆将导致无法继续使用，确定要删除吗?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){y(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getTableList()}).catch(function(e){return e})}).catch(function(){})}},{key:"handleSizeChange",value:function(e){this.pageSize=e,this.getTableList()}},{key:"handleCurrentChange",value:function(e){this.pageNumber=e,this.getTableList()}},{key:"addCar",value:function(e){var t=this;this.isShowUpdate=!0,this.isEdit=!1,this.$nextTick(function(){var e=t.$refs.editForm;e.setCust()})}},{key:"editCar",value:function(e){var t=this;this.isShowUpdate=!0,this.isEdit=!0,this.$nextTick(function(){var a=t.$refs.editForm;a.setData(e)})}},{key:"close",value:function(){this.isShowUpdate=!1}},{key:"reset",value:function(){var e=this.$refs.editForm,t=e.$refs.userRoot;this.$nextTick(function(){t.clearValidate()})}},{key:"confirm",value:function(){var e=this;this.$nextTick(function(){var t=e.$refs.editForm;t.saveUser()})}},{key:"custId",get:function(){var e=h["a"].info||{},t=e.custId;return t}}]),t}(d["e"]);z=p["a"]([Object(d["a"])({name:"Vehicle",components:{AddEditForm:$}})],z);var C=z,E=C,F=Object(I["a"])(E,i,r,!1,null,"7fc21d9b",null);t["default"]=F.exports},"216a4":function(e,t,a){},e162:function(e,t,a){"use strict";var i=a("216a4"),r=a.n(i);r.a}}]);