(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["role-management"],{"0dcb":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roles-container"},[r("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[r("div",{staticClass:"app-container"},[r("head-info",{attrs:{title:"权限设置",info:""}}),r("div",{staticClass:"app-panel"},[r("el-row",{staticStyle:{"margin-bottom":"10px"}},[r("el-col",{attrs:{span:12}},["0"===e.custId?r("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.addRole}},[e._v("\n              新增权限\n            ")]):e._e()],1)],1),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"roles-set"},[r("div",{staticClass:"roles-name"},[e._m(0),r("div",{staticStyle:{"margin-left":"210px"}},[r("el-row",[r("el-col",{attrs:{xs:12,sm:6,lg:4}},[r("div",{staticStyle:{color:"#666","padding-left":"10px"}},[e._v("\n                    菜单页面\n                  ")])]),r("el-col",{attrs:{xs:12,sm:18,lg:20}},[r("div",{staticStyle:{color:"#666","padding-left":"20px","text-align":"right"}},[r("span",{staticStyle:{float:"left"}},[e._v("操作权限")]),r("el-select",{staticStyle:{width:"120px","margin-right":"20px"},attrs:{size:"small",placeholder:"公司类型"},on:{change:e.onCompanyType},model:{value:e.selectValue.custType,callback:function(t){e.$set(e.selectValue,"custType",t)},expression:"selectValue.custType"}},[r("el-option",{attrs:{label:"聚货通",value:"0"}}),r("el-option",{attrs:{label:"客户",value:"1"}}),r("el-option",{attrs:{label:"代理商",value:"2"}}),r("el-option",{attrs:{label:"供应商",value:"3"}})],1),"0"!==e.selectValue.custType?r("el-select",{staticStyle:{width:"120px","margin-right":"20px"},attrs:{loading:e.selectLoading,size:"small",filterable:"",placeholder:"服务大类"},on:{change:e.onServiceType,focus:e.getServiceTypeList},model:{value:e.selectValue.typeId,callback:function(t){e.$set(e.selectValue,"typeId",t)},expression:"selectValue.typeId"}},e._l(e.serviceTypeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e()],1)])],1)],1)]),r("div",{staticClass:"roles-list"},[r("el-menu",{staticStyle:{"border-right":"none"},attrs:{"default-active":e.selectRoleId,"background-color":"#f0f2f5"},on:{select:e.getRolePermission}},[e._l(e.rolesOptions,function(t,i){return r("el-menu-item",{key:t.id,staticClass:"role-menu-item",attrs:{index:String(t.id)}},[r("div",{staticStyle:{"text-overflow":"ellipsis",overflow:"hidden"},attrs:{slot:"title"},slot:"title"},[e.isEdit===i?r("div",{staticClass:"el-input el-input--small"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.roleForm.name,expression:"roleForm.name"}],ref:"inputEdit",refInFor:!0,staticClass:"el-input__inner",attrs:{type:"text",maxlength:20,placeholder:"请输入名称"},domProps:{value:e.roleForm.name},on:{click:function(e){return e.stopPropagation()},blur:function(t){return e.handleRoleName("edit")},input:function(t){t.target.composing||e.$set(e.roleForm,"name",t.target.value)}}})]):r("div",[r("i",{staticClass:"el-icon-user-solid"}),r("span",[e._v(e._s(t.name))])]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.selectRoleId===t.id,expression:"selectRoleId === item.id"}],staticClass:"role-menu-icon",attrs:{slot:"reference"},on:{click:function(t){t.stopPropagation(),e.isShow=!0},mouseleave:function(t){e.isShow=!1}},slot:"reference"},[r("i",{staticClass:"el-icon-caret-bottom"}),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow&&e.selectRoleId===t.id,expression:"isShow && selectRoleId === item.id"}],staticClass:"role-popover-box"},[r("div",{directives:[{name:"permission",rawName:"v-permission",value:["editPermit"],expression:"['editPermit']"}],staticClass:"role-popover-div",on:{click:function(r){return r.stopPropagation(),e.handleRoleName("input",t,i)}}},[e._v("\n                        编辑\n                      ")]),r("div",{directives:[{name:"permission",rawName:"v-permission",value:["deletePermit"],expression:"['deletePermit']"}],staticClass:"role-popover-div",on:{click:function(r){return r.stopPropagation(),e.handleRoleName("delete",t)}}},[e._v("\n                        删除\n                      ")])])])])])}),r("el-menu-item",{staticStyle:{height:"auto",padding:"0"},attrs:{index:"addRole"}},[r("template",{slot:"title"},[e.isAdd?r("div",{staticStyle:{padding:"10px 20px 0px 20px"}},[r("el-input",{staticStyle:{display:"block","line-height":"32px",height:"32px"},attrs:{maxlength:20,placeholder:"请输入名称",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleRoleName("add")}},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}}),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleRoleName("add")}}},[e._v("\n                      确定\n                    ")]),r("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleRoleName("cancle")}}},[e._v("\n                      取消\n                    ")])],1):r("div",{directives:[{name:"permission",rawName:"v-permission",value:["addPermit"],expression:"['addPermit']"}],staticStyle:{padding:"0 20px"},on:{click:e.handleRoleAdd}},[r("el-button",{staticClass:"role-menu-add",staticStyle:{"font-size":"14px",color:"#303133"},attrs:{type:"text",size:"small"}},[r("i",{staticClass:"el-icon-circle-plus-outline"}),e._v("新增\n                    ")])],1)])],2)],2)],1),r("div",{staticClass:"roles-level"},[r("el-form",{staticClass:"role-item-line",staticStyle:{"min-width":"1000px","overflow-x":"auto",height:"calc(100vh - 400px)","padding-left":"10px"}},e._l(e.permissData.render,function(t,i){return r("el-form-item",{key:i},[r("el-row",{class:t.children&&t.children.length>0?"":"is-item-line"},[r("el-col",{class:t.children&&t.children.length>0?"is-item-line":"",staticStyle:{"padding-left":"10px"},attrs:{xs:24,sm:6,lg:4}},[r("el-checkbox",{attrs:{indeterminate:t.selected,disabled:t.disabled,label:t.id},on:{change:function(r){return e.setCheckedOne(t)}},nativeOn:{contextmenu:function(r){return r.preventDefault(),e.editRole(t)}},model:{value:t.checked,callback:function(r){e.$set(t,"checked",r)},expression:"itemOne.checked"}},[e._v("\n                      "+e._s(t.name)+"\n                    ")])],1),t.children?r("el-col",{staticStyle:{"border-left":"1px solid #eee"},attrs:{xs:24,sm:18,lg:20}},e._l(t.children,function(i,n){return r("el-row",{key:n,staticStyle:{"border-top":"1px solid #eee"}},[r("el-col",{staticStyle:{"padding-left":"10px"},attrs:{xs:24,sm:7,md:5,lg:5}},[r("el-checkbox",{attrs:{indeterminate:i.selected,disabled:i.disabled,label:i.id},on:{change:function(r){return e.setCheckedTwo(i,t)}},nativeOn:{contextmenu:function(r){return r.preventDefault(),e.editRole(i,t)}},model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"itemTwo.checked"}},[e._v("\n                          "+e._s(i.name)+"\n                        ")])],1),r("el-col",{staticStyle:{"border-left":"1px solid #eee"},attrs:{xs:20,sm:17,md:19,lg:19}},[i&&i.children?r("el-row",{staticStyle:{"padding-left":"10px"}},e._l(i.children,function(n,a){return r("el-col",{key:a,attrs:{xs:12,sm:12,md:6,xl:4}},[r("el-checkbox",{attrs:{disabled:n.disabled,label:n.id},on:{change:function(r){return e.setCheckedThree(n,i,t)}},nativeOn:{contextmenu:function(r){return r.preventDefault(),e.editRole(n,i,t)}},model:{value:n.checked,callback:function(t){e.$set(n,"checked",t)},expression:"itemThree.checked"}},[e._v("\n                              "+e._s(n.name)+"\n                            ")])],1)}),1):e._e()],1)],1)}),1):e._e()],1)],1)}),1),r("div",{staticStyle:{"text-align":"right",padding:"15px 30px 0 0","border-top":"1px solid #ccc"}},[r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["updatePermit"],expression:"['updatePermit']"}],staticStyle:{padding:"10px 30px"},attrs:{type:"primary",size:"mini"},on:{click:e.handleUpdatePermit}},[e._v("\n                更新\n              ")])],1)],1)])],1)],1)]),r("add-form",{ref:"addForm",attrs:{"role-list":e.roleList},on:{load:e.getTreeOrglist}})],1)},n=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{width:"210px",float:"left"}},[r("span",{staticStyle:{"padding-left":"20px"}},[e._v("角色组")])])}],a=(r("7f7f"),r("ac6a"),r("7514"),r("96cf"),r("3b8d")),l=r("d225"),s=r("b0b4"),c=r("308d"),o=r("6bb5"),d=r("4e2b"),u=r("9ab4"),h=r("60a3"),m=r("9dba"),p=r("ac1a"),f=r("e0a1"),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"新增权限",visible:e.visible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"right","label-width":"80px"}},[r("el-form-item",{attrs:{label:"权限类型",prop:"level"}},[r("el-radio-group",{on:{change:e.levelChange},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},[r("el-radio",{attrs:{label:"0"}},[e._v("\n            一级菜单\n          ")]),r("el-radio",{attrs:{label:"1"}},[e._v("\n            二级菜单\n          ")]),r("el-radio",{attrs:{label:"2"}},[e._v("\n            按钮权限\n          ")])],1)],1),"0"!==e.form.level?r("el-form-item",{attrs:{label:"一级菜单",prop:"parentId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.parentChange},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}},e._l(e.roleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):e._e(),"2"===e.form.level?r("el-form-item",{attrs:{label:"二级菜单",prop:"parentId2"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.form.parentId,placeholder:"请选择"},model:{value:e.form.parentId2,callback:function(t){e.$set(e.form,"parentId2",t)},expression:"form.parentId2"}},e._l(e.parentRoleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1):e._e(),r("el-form-item",{attrs:{label:"权限名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"权限点",prop:"alias"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),r("el-form-item",{attrs:{label:"请求接口",prop:"urls"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.urls,callback:function(t){e.$set(e.form,"urls",t)},expression:"form.urls"}})],1),r("el-form-item",{attrs:{label:"请求方式",prop:"mode"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.mode,callback:function(t){e.$set(e.form,"mode",t)},expression:"form.mode"}},e._l(e.modeList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),r("div",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("\n        取 消\n      ")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("\n        保 存\n      ")])],1)],1)])},g=[],b=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(c["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.visible=!1,e.loading=!1,e.editId="",e.form={name:"",alias:"",parentId:"",parentId2:"",level:"",route:"",urls:"",mode:""},e.rules={level:[{required:!0,message:"请选择权限类型",trigger:"change"}],parentId:[{required:!0,message:"请选择一级菜单",trigger:"change"}],parentId2:[{required:!0,message:"请选择二级菜单",trigger:"change"}],name:[{required:!0,message:"请输入权限名称",trigger:"change"}],alias:[{required:!0,message:"请输入权限点",trigger:"change"},{validator:function(e,t,r){var i=/[\u4E00-\u9FA5]/g;t?i.test(t)?r(new Error("权限点不能有中文及特殊字符")):r():r(new Error("权限点不能为空"))},trigger:"blur"}]},e.modeList=[{id:"GET",name:"GET"},{id:"POST",name:"POST"},{id:"DELETE",name:"DELETE"},{id:"PUT",name:"PUT"},{id:"OPTION",name:"OPTION"}],e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"close",value:function(){this.visible=!1}},{key:"save",value:function(){var e=this,t=this.$refs.form;t.validate(function(t){if(t){var r={name:e.form.name.trim(),alias:e.form.alias.trim(),parentId:"2"===e.form.level?e.form.parentId2:e.form.parentId,level:e.form.level,route:e.form.route,urls:e.form.urls,mode:e.form.mode};e.editId&&(r.id=e.editId),e.loading=!0,Object(f["a"])(r).then(function(t){e.loading=!1,t.success?(e.$message.success("权限添加成功"),e.$emit("load"),e.visible=!1):e.$message.error("权限添加失败")}).catch(function(t){return e.loading=!1,t})}})}},{key:"edit",value:function(e,t,r){var i=this;this.editId=e.id,this.visible=!0,this.form={name:e.name,alias:e.alias,parentId:"",parentId2:"",level:e.level+"",route:e.route,urls:e.urls,mode:e.mode},t&&(this.form.parentId=(t||{}).id,this.form.parentId2=(r||{}).id),r&&(this.form.parentId=(r||{}).id,this.form.parentId2=(t||{}).id),this.$nextTick(function(){var e=i.$refs.form;e.clearValidate()})}},{key:"show",value:function(){var e=this;this.editId="",this.visible=!0,this.form={name:"",alias:"",parentId:"",parentId2:"",level:"0",route:"",urls:"",mode:""},this.$nextTick(function(){var t=e.$refs.form;t.clearValidate()})}},{key:"levelChange",value:function(){this.form.parentId="",this.form.parentId2=""}},{key:"parentChange",value:function(){this.form.parentId2=""}},{key:"parentRoleList",get:function(){var e=this,t=this.roleList,r=t.find(function(t){return t.id===e.form.parentId})||[];return r.children||[]}}]),t}(h["e"]);b=u["a"]([Object(h["a"])({name:"",props:{roleList:{type:Array,default:function(){return[]}}}})],b);var y=b,k=y,x=r("2877"),I=Object(x["a"])(k,v,g,!1,null,"454ef93a",null),O=I.exports,R=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(c["a"])(this,Object(o["a"])(t).apply(this,arguments)),e.rolesOptions=[],e.isAdd=!1,e.tableLoading=!1,e.permissData={render:[],genesis:[],disabled:[]},e.currentSelectItem=null,e.isShow=!1,e.isEdit="",e.selectRoleId="",e.inputName="",e.roleForm={name:void 0,id:void 0,custType:void 0,typeId:void 0,typeName:void 0},e.rolesData=[],e.roleList=[],e.orgProps={label:"name",children:"children"},e.selectValue={custType:"0",typeId:void 0},e.serviceTypeList=[],e.selectLoading=!1,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"created",value:function(){this.getTreeOrglist()}},{key:"editRole",value:function(e,t,r){this.$refs.addForm.edit(e,t,r)}},{key:"addRole",value:function(){this.$refs.addForm.show()}},{key:"onCompanyType",value:function(){this.selectRoleId="","0"===this.selectValue.custType?(this.selectValue.typeId=void 0,this.getRolesList()):(this.selectValue.typeId=void 0,this.rolesOptions=[],this.permissData.render=[])}},{key:"onServiceType",value:function(){this.selectRoleId="",this.selectValue.typeId?this.getRolesList():(this.rolesOptions=[],this.permissData.render=[])}},{key:"getServiceTypeList",value:function(){var e=this;this.selectLoading=!0;var t=this.selectValue.custType,r={custType:t};Object(f["f"])(r).then(function(t){var r=t.data||[];"1"===e.selectValue.custType?e.serviceTypeList=r.filter(function(e){return e.customer}):"2"===e.selectValue.custType?e.serviceTypeList=r.filter(function(e){return e.agent}):"3"===e.selectValue.custType&&(e.serviceTypeList=r.filter(function(e){return e.supplier})),e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"getTreeOrglist",value:function(){var e=this;this.tableLoading=!0,Object(f["d"])().then(function(t){var r=t.data||[],i=JSON.parse(JSON.stringify(r));e.roleList=i,e.permissData.genesis=e.recursionFalse(r,!1),e.getRolesList()}).catch(function(t){return e.tableLoading=!1,[t,null]})}},{key:"getRolesList",value:function(){var e=this;Object(f["e"])({custType:this.selectValue.custType,typeIds:this.selectValue.typeId?[this.selectValue.typeId]:[]}).then(function(t){var r=t.data||[];e.rolesOptions=r,e.rolesOptions.length>0?e.getRolePermission(e.rolesOptions[0].id).catch(function(e){return e}):e.permissData.render=[]}).catch(function(t){return e.tableLoading=!1,t})}},{key:"getRolePermission",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var r,i,n,a,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectRoleId=t,"addRole"!==t){e.next=5;break}return e.abrupt("return");case 5:this.isAdd=!1;case 6:return this.tableLoading=!0,r=this.rolesOptions.find(function(e){return e.id===t}),this.currentSelectItem=r,this.permissData.render=JSON.parse(JSON.stringify(this.permissData.genesis)),e.prev=10,e.next=13,Object(f["c"])(t);case 13:i=e.sent,this.rolesData=i.data,this.tableLoading=!1,e.next=22;break;case 18:return e.prev=18,e.t0=e["catch"](10),this.tableLoading=!1,e.abrupt("return",e.t0);case 22:if(this.rolesData&&!(this.rolesData&&this.rolesData.length<=0)){e.next=24;break}return e.abrupt("return");case 24:for(n=this.rolesData,a=n.length,l=0;l<a;l++)this.recursionRender(n[l],this.permissData.render);this.checkboxRender(this.permissData.render);case 28:case"end":return e.stop()}},e,this,[[10,18]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"checkboxRender",value:function(e){e.forEach(function(e){if(e.checked){if(!e.children||e.children.length<=0)return;var t=e.children.filter(function(e){return!0===e.checked});t.length<e.children.length&&(e.checked=!1,e.selected=!0),e.children.forEach(function(t,r){if(t.checked){if(!t.children||t.children.length<=0)return;var i=t.children.filter(function(e){return!0===e.checked});i.length<t.children.length&&(t.checked=!1,t.selected=!0,e.checked=!1,e.selected=!0)}})}})}},{key:"handleRoleAdd",value:function(){"0"===this.selectValue.custType||this.selectValue.typeId?(this.isAdd=!0,this.roleForm.name=""):this.$message.error("请先选择服务大类")}},{key:"handleRoleName",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,r,i){var n,a,l=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.t0=t,e.next="add"===e.t0?3:"input"===e.t0?5:"edit"===e.t0?11:"delete"===e.t0?13:"cancle"===e.t0?25:28;break;case 3:return this.addEditRole("add"),e.abrupt("break",29);case 5:return this.isEdit=i,this.inputName=r.name,this.roleForm.name=r.name,this.$nextTick(function(){var e=l.$refs.inputEdit;e[0].focus()}),this.isShow=!1,e.abrupt("break",29);case 11:return this.addEditRole("edit"),e.abrupt("break",29);case 13:return e.prev=13,n="此操作将永久删除该角色, 是否继续?",a="提示",e.next=18,this.$confirm(n,a,{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"});case 18:Object(f["b"])(r.id).then(function(e){e.success?(l.$message({type:"success",message:"删除成功!"}),l.isAdd=!1,l.refrehRoleList("first")):l.$message({type:"error",message:e.msg})}).catch(function(e){return e}),e.next=24;break;case 21:return e.prev=21,e.t1=e["catch"](13),e.abrupt("return",e.t1);case 24:return e.abrupt("break",29);case 25:return this.isAdd=!1,this.refrehRoleList("first"),e.abrupt("break",29);case 28:return e.abrupt("break",29);case 29:case"end":return e.stop()}},e,this,[[13,21]])}));function t(t,r,i){return e.apply(this,arguments)}return t}()},{key:"addEditRole",value:function(e){var t=this,r=/[`~!@#$%^&*()+=<>?:"{}|,.\\/;'\\[\]·~！@#￥%……&*（）+={}|《》？：“”【】、；‘’，。、]/im;if(this.roleForm.name)if(""!==this.roleForm.name.trim())if(r.test(this.roleForm.name))this.$message.error("姓名不能为(-)(_)(——)( )之外的特殊字符");else{switch(this.roleForm.custType=this.selectValue.custType,this.roleForm.typeId=this.selectValue.typeId,this.serviceTypeList.map(function(e){e.id===t.roleForm.typeId&&(t.roleForm.typeName=e.name)}),e){case"add":this.roleForm.id="";break;case"edit":if(this.isEdit="",this.inputName===this.roleForm.name)return null;this.roleForm.id=this.selectRoleId;break;default:break}try{Object(f["g"])(this.roleForm).then(function(r){if(r.success)switch(e){case"add":t.isAdd=!1,t.$message({type:"success",message:"新增成功!"}),t.refrehRoleList("add",r.data);break;case"edit":t.$message({type:"success",message:"编辑成功!"}),t.refrehRoleList("current");break;default:break}else t.$message({type:"error",message:r.msg})}).catch(function(e){return e})}catch(i){this.$message.error(i)}}else this.$message.error("姓名不能全为空");else this.$message.error("请输入角色姓名")}},{key:"refrehRoleList",value:function(e,t){var r=this;this.custId;Object(f["e"])({custType:this.selectValue.custType,typeIds:this.selectValue.typeId?[this.selectValue.typeId]:[]}).then(function(i){switch(r.rolesOptions=i.data||[],e){case"add":r.getRolePermission(t).catch(function(e){return e});break;case"first":r.rolesOptions.length>0?r.getRolePermission(r.rolesOptions[0].id).catch(function(e){return e}):r.permissData.render=[];break;case"current":r.getRolePermission(r.selectRoleId).catch(function(e){return e});break;default:break}}).catch(function(e){return e})}},{key:"handleUpdatePermit",value:function(){var e=this;if(""!==this.selectRoleId&&"addRole"!==this.selectRoleId){this.tableLoading=!0,this.rolesData=this.recursionArr(this.permissData.render);var t=this.rolesData.map(function(e){return e.permissionId}),r={permitId:t,roleId:this.selectRoleId};Object(f["h"])(r).then(function(t){e.tableLoading=!1,t.success?e.$message({type:"success",message:"更新成功!"}):e.$message({type:"error",message:t.msg})}).catch(function(t){return e.tableLoading=!1,t})}}},{key:"recursionFalse",value:function(e,t){var r=function e(r){r.length<=0||r.forEach(function(r){r.checked=!1,r.selected=!1,r.disabled=!!t,r.children&&r.children.length>0&&e(r.children)})};return r(e),e}},{key:"recursionRender",value:function(e,t){var r=function t(r){r.forEach(function(r){e===r.id?r.checked=!0:r.children&&r.children.length>0&&t(r.children)})};r(t)}},{key:"recursionArr",value:function(e){var t=[],r=function e(r){r.forEach(function(r){(r.checked||r.selected)&&t.push({permissionId:r.id}),r.children&&r.children.length>0&&e(r.children)})};return r(e),t}},{key:"recursionChildFalse",value:function(e){var t=function e(t){t.length<=0||t.forEach(function(t){t.checked=!1,t.selected=!1,t.children&&t.children.length>0&&e(t.children)})};t(e)}},{key:"recursionChild",value:function(e){var t=function e(t){t.length<=0||t.forEach(function(t){t.checked=!0,t.selected=!1,t.children&&t.children.length>0&&e(t.children)})};t(e)}},{key:"setCheckedOne",value:function(e){e.selected&&(e.selected=!1,e.checked=!0),e.checked?this.recursionChild(e.children||[]):this.recursionChildFalse(e.children||[])}},{key:"setCheckedTwo",value:function(e,t){e.selected&&(e.selected=!1,e.checked=!0),e.checked?this.recursionChild(e.children||[]):this.recursionChildFalse(e.children||[]);var r=t.children.filter(function(e){return!0===e.checked}),i=t.children.filter(function(e){return!0===e.selected});r.length<=0&&i.length<=0&&(t.checked=!1,t.selected=!1),(r.length>0&&r.length<t.children.length||i.length>0)&&(t.checked=!1,t.selected=!0),r.length>=t.children.length&&(t.checked=!0,t.selected=!1)}},{key:"setCheckedThree",value:function(e,t,r){e.checked?this.recursionChild(e.children||[]):this.recursionChildFalse(e.children||[]);var i=t.children.filter(function(e){return!0===e.checked});i.length<=0&&(t.checked=!1,t.selected=!1),i.length>0&&i.length<t.children.length&&(t.checked=!1,t.selected=!0),i.length>=t.children.length&&(t.checked=!0,t.selected=!1);var n=r.children.filter(function(e){return!0===e.checked}),a=r.children.filter(function(e){return!0===e.selected});n.length<=0&&a.length<=0&&(r.checked=!1,r.selected=!1),(n.length>0&&n.length<t.children.length||a.length>0)&&(r.checked=!1,r.selected=!0),n.length>=r.children.length&&(r.checked=!0,r.selected=!1)}},{key:"custId",get:function(){var e=m["a"].info||{},t=e.custId;return t}},{key:"custType",get:function(){var e=m["a"].info||{},t=e.custType;return t}},{key:"deptId",get:function(){var e=m["a"].info||{},t=e.deptId;return t}},{key:"custName",get:function(){var e=m["a"].info||{},t=e.custName;return t}},{key:"deptName",get:function(){var e=m["a"].info||{},t=e.deptName;return t}},{key:"lang",get:function(){var e=p["a"].language;return e||"en"}}]),t}(h["e"]);R=u["a"]([Object(h["a"])({name:"Role",components:{addForm:O},props:{}})],R);var w=R,T=w,S=(r("1c1e"),Object(x["a"])(T,i,n,!1,null,"13bced96",null));t["default"]=S.exports},"1c1e":function(e,t,r){"use strict";var i=r("dc43"),n=r.n(i);n.a},dc43:function(e,t,r){},e0a1:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"d",function(){return a}),r.d(t,"c",function(){return l}),r.d(t,"h",function(){return s}),r.d(t,"b",function(){return c}),r.d(t,"g",function(){return o}),r.d(t,"a",function(){return d}),r.d(t,"f",function(){return u});var i=r("b32d");function n(e){var t={url:"/auth/permit/getRoles",method:"post",data:e};return Object(i["a"])(t)}function a(){var e={url:"/auth/permit/getPermits",method:"get"};return Object(i["a"])(e)}function l(e){var t={url:"/auth/permit/getPermitByRole",method:"get",params:{id:e}};return Object(i["a"])(t)}function s(e){var t={url:"/auth/permit/saveRolePermit",method:"post",data:e};return Object(i["a"])(t)}function c(e){var t={url:"/auth/permit/deleteRole",method:"post",params:{roleId:e}};return Object(i["a"])(t)}function o(e){var t={url:"/auth/permit/saveRole",method:"post",data:e};return Object(i["a"])(t)}function d(e){var t={url:"auth/permit/add",method:"post",data:e};return Object(i["a"])(t)}function u(e){var t={url:"/cfg/type/getServiceTypeList",method:"get",params:e};return Object(i["a"])(t)}}}]);