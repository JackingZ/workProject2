(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["invoice-out"],{"02f9":function(e,t,n){},"0853":function(e,t,n){"use strict";var a=n("1eae"),i=n.n(a);i.a},"0e5a":function(e,t,n){"use strict";var a=n("02f9"),i=n.n(a);i.a},"1eae":function(e,t,n){},"3d85":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[n("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.detailShow,expression:"!detailShow"}],staticClass:"app-container"},[n("div",{staticClass:"finance-header"},[n("div",{staticStyle:{width:"100px",color:"#909399","font-weight":"400","font-size":"16px"}},[e._v("\n          开票\n        ")]),n("div",{staticStyle:{width:"130px"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{loading:e.selectLoading,placeholder:"服务大类",size:"small",filterable:""},on:{change:e.handleService},model:{value:e.searchForm.serviceTypeId,callback:function(t){e.$set(e.searchForm,"serviceTypeId",t)},expression:"searchForm.serviceTypeId"}},e._l(e.serviceList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)]),n("div",{staticClass:"app-panel"},[n("el-row",[n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["invoiceOutAdd"],expression:"['invoiceOutAdd']"}],staticStyle:{float:"left"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.handleAdd}},[e._v("\n              新增开票\n            ")]),"2"===e.custType&&"1"===e.custSubtype||"3"===e.custType?n("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"公司类型"},on:{change:e.onComType},model:{value:e.searchForm.comType,callback:function(t){e.$set(e.searchForm,"comType",t)},expression:"searchForm.comType"}},e._l(e.companyTypeList,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):e._e(),"2"===e.searchForm.comType||"4"===e.searchForm.comType?n("el-select",{staticStyle:{width:"170px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.searchForm.comId,callback:function(t){e.$set(e.searchForm,"comId",t)},expression:"searchForm.comId"}},e._l(e.companyList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),n("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{placeholder:"审核状态",size:"small",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.statusList,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),n("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"是否税务开票",size:"small",clearable:""},model:{value:e.searchForm.ifBill,callback:function(t){e.$set(e.searchForm,"ifBill",t)},expression:"searchForm.ifBill"}},[n("el-option",{attrs:{label:"否",value:0}}),n("el-option",{attrs:{label:"是",value:1}})],1),n("el-date-picker",{staticStyle:{width:"240px","margin-right":"5px"},attrs:{type:"daterange","unlink-panels":"",align:"right",size:"small","range-separator":"~","value-format":"yyyy-MM-dd","start-placeholder":"起始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),n("el-input",{staticClass:"input-with-select",staticStyle:{width:"250px","margin-right":"10px"},attrs:{placeholder:"请输入内容",size:"small",clearable:""},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",size:"small",placeholder:"请选择"},slot:"prepend",model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}},[n("el-option",{attrs:{label:"原单号",value:"1"}}),n("el-option",{attrs:{label:"客户名称",value:"2"}})],1)],1),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["invoiceOutSearch"],expression:"['invoiceOutSearch']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearch(1)}}},[e._v("\n              查询\n            ")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 313px)",border:""}},[n("el-table-column",{attrs:{prop:"clientName",label:"客户名称","min-width":"200"}}),n("el-table-column",{attrs:{prop:"invDate",label:"开票日期",width:"180"}}),n("el-table-column",{attrs:{prop:"",label:"审核状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s((e.statusList.find(function(e){return e.id===t.row.status})||{}).name)+"\n            ")]}}])}),n("el-table-column",{attrs:{prop:"auditTime",label:"审核时间",width:"180"}}),n("el-table-column",{attrs:{prop:"amount",width:"180",label:"本币总金额"}}),n("el-table-column",{attrs:{width:"140",label:"是否税务开票"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(1===t.row.ifBill?"是":"否")+"\n            ")]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["3"!==t.row.status&&e.$checkPermission(["invoiceOutEdit"])?n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleEdit(t.row)}}},[e._v("\n                编辑\n              ")]):e._e(),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["invoiceOutView"],expression:"['invoiceOutView']"}],attrs:{type:"text"},on:{click:function(n){return e.handleDetail(t.row)}}},[e._v("\n                查看\n              ")]),"1"!==t.row.status&&e.$checkPermission(["invoiceOutAudit"])?n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleAudit(t.row,t.$index)}}},[e._v("\n                审核\n              ")]):e._e(),"05"===e.searchForm.serviceTypeId&&e.$checkPermission(["invoiceOutExport"])?n("el-button",{attrs:{type:"text"},on:{click:function(n){return e.handleExport(t.row)}}},[e._v("\n                导出\n              ")]):e._e()]}}])})],1),n("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.detailShow,expression:"detailShow"}],staticClass:"app-container"},[n("detail",{ref:"detailForm",attrs:{"is-add":e.isAdd,"is-view":e.isView,"is-edit":e.isEdit,"is-once":e.isOnce,"status-list":e.statusList},on:{back:function(t){e.detailShow=!1},getTableData:e.handleSearch}})],1),n("el-dialog",{attrs:{title:"开票审核",visible:e.visible,"close-on-click-modal":!1,width:"700px"},on:{"update:visible":function(t){e.visible=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[n("el-form",{ref:"auditForm",staticStyle:{"padding-top":"20px"},attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"110px",size:"small"}},[n("el-form-item",{attrs:{label:"审核",prop:"status"}},[n("el-radio-group",{model:{value:e.auditForm.status,callback:function(t){e.$set(e.auditForm,"status",t)},expression:"auditForm.status"}},[n("el-radio",{attrs:{label:"1"}},[e._v("\n                通过\n              ")]),n("el-radio",{attrs:{label:"2"}},[e._v("\n                拒绝\n              ")])],1)],1)],1),n("div",{staticStyle:{"text-align":"right","padding-top":"10px"}},[n("el-button",{attrs:{size:"small"},on:{click:e.cancelAudit}},[e._v("\n            取 消\n          ")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmAudit}},[e._v("\n            确 定\n          ")])],1)],1)])],1)])},i=[],r=(n("8e6e"),n("ac6a"),n("456d"),n("a8db")),s=n("bd86"),o=(n("96cf"),n("3b8d")),c=n("d225"),l=n("b0b4"),u=n("308d"),d=n("6bb5"),p=n("4e2b"),f=n("9ab4"),m=n("60a3"),h=n("9dba"),v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.detailLoading,expression:"detailLoading"}],staticStyle:{"background-color":"#ffffff"}},[n("div",{staticStyle:{padding:"0 20px","line-height":"50px","border-bottom":"1px solid #e8e8e8"}},[n("div",{staticStyle:{"text-align":"right"}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:e.handleBack}},[n("i",{staticClass:"el-icon-back"}),n("span",[e._v("返回")])])])]),n("div",{staticClass:"app-panel order-detail"},[n("el-row",{staticStyle:{padding:"10px"}},[n("el-col",{staticStyle:{"font-weight":"700","font-size":"18px","line-height":"30px"},attrs:{span:4}},[e._v("\n        开票信息\n      ")]),n("el-col",{staticStyle:{"text-align":"right"},attrs:{span:20}},[e.isView?n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleExport}},[e._v("\n          导出\n        ")]):n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleSave}},[e._v("\n          "+e._s(e.isOnce?"提交":"重新提交")+"\n        ")])],1)],1),n("el-form",{ref:"editForm",class:e.isView?"view-item":"",attrs:{model:e.form,rules:e.formRules,"label-width":"120px",size:"small"}},[n("el-form-item",{attrs:{label:"客户",prop:"clientName"}},[e.isView?n("span",[e._v("\n          "+e._s(e.form.clientName)+"\n        ")]):n("el-input",{attrs:{size:"small",placeholder:"请输入",disabled:""},model:{value:e.form.clientName,callback:function(t){e.$set(e.form,"clientName",t)},expression:"form.clientName"}},[e.isOnce?n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleCustomer},slot:"append"}):e._e()],1)],1),n("el-form-item",{attrs:{label:"服务类型",prop:"serviceTypeId"}},[e.isView?n("span",[e._v("\n          "+e._s(e.form.serviceTypeName)+"\n        ")]):n("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.form.clientId,loading:e.selectLoading,placeholder:"请选择",clearable:"",filterable:""},on:{change:e.onServiceType,focus:e.getServiceType},model:{value:e.form.serviceTypeId,callback:function(t){e.$set(e.form,"serviceTypeId",t)},expression:"form.serviceTypeId"}},e._l(e.serviceTypeList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),n("el-form-item",{attrs:{label:"开票日期",prop:"invDate"}},[e.isView?n("span",[e._v("\n          "+e._s(e.form.invDate)+"\n        ")]):n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"请选择"},model:{value:e.form.invDate,callback:function(t){e.$set(e.form,"invDate",t)},expression:"form.invDate"}})],1),e.isView?n("el-form-item",{attrs:{label:"审核时间"}},[n("span",[e._v("\n          "+e._s(e.form.auditTime)+"\n        ")])]):e._e(),n("el-form-item",{attrs:{label:"是否税务开票",prop:"ifBill"}},[e.isView?n("span",[e._v("\n          "+e._s(1===e.form.ifBill?"是":"否")+"\n        ")]):n("el-radio-group",{attrs:{size:"small"},model:{value:e.form.ifBill,callback:function(t){e.$set(e.form,"ifBill",t)},expression:"form.ifBill"}},[n("el-radio",{attrs:{label:0}},[e._v("\n            否\n          ")]),n("el-radio",{attrs:{label:1}},[e._v("\n            是\n          ")])],1)],1),n("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"备注"}},[e.isView?n("span",[e._v("\n          "+e._s(e.form.remark)+"\n        ")]):n("el-input",{attrs:{type:"textarea",rows:3,size:"small",placeholder:"请输入",clearable:""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),n("div",[n("span",{staticStyle:{"font-size":"16px",color:"#303133","line-height":"32px","padding-right":"20px"}},[e._v("明细行")]),e.isView?e._e():n("el-radio-group",{attrs:{size:"small"},on:{change:e.onSelected},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}},[n("el-radio-button",{attrs:{label:"all"}},[e._v("\n          全部\n        ")]),n("el-radio-button",{attrs:{label:"selected"}},[e._v("\n          已选择\n        ")])],1)],1),"all"===e.selectVal&&e.tableData.length?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("vxe-table",{ref:"tables",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,"auto-resize":!0,height:"450","header-align":"center",align:"center",border:"",resizable:"",size:"small"},on:{"checkbox-change":e.handleSelected,"checkbox-all":e.handleSelectAll}},[n("vxe-table-column",{attrs:{visible:!e.isView,fixed:"left",type:"checkbox",width:"55"}}),n("vxe-table-column",{attrs:{visible:"02"!==e.form.serviceTypeId&&"06"!==e.form.serviceTypeId,fixed:"left",width:"160",title:"原单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.orderCode))])]}}],null,!1,2549254981)}),n("vxe-table-column",{attrs:{fixed:"left",visible:"02"===e.form.serviceTypeId||"06"===e.form.serviceTypeId,width:"160",title:"SO号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.soNoList||[]).join(",")))])]}}],null,!1,2108195871)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"提单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.billNoList||[]).join(",")))])]}}],null,!1,528558280)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"航空单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.airNoList||[]).join(",")))])]}}],null,!1,3875341849)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"柜号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.containerNoList||[]).join(",")))])]}}],null,!1,3174292868)}),n("vxe-table-column",{attrs:{title:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((e.statusList.find(function(e){return e.id===t.row.status})||{}).name))])]}}],null,!1,641954429)}),n("vxe-table-column",{attrs:{title:"核销状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.ifVerify?n("span",[e._v("已核销")]):e._e(),0===t.row.ifVerify?n("span",[e._v("未核销")]):e._e()]}}],null,!1,1233879789)}),n("vxe-table-column",{attrs:{title:"发票日期",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.invDate))])]}}],null,!1,2385324867)}),n("vxe-table-column",{attrs:{title:"客户名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.clientName))])]}}],null,!1,549671992)}),n("vxe-table-column",{attrs:{title:"客户属性",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.clientProperty?n("span",[e._v("聚货通")]):"2-1"===t.row.clientProperty?n("span",[e._v("一级代理")]):"2-2"===t.row.clientProperty?n("span",[e._v("二级代理")]):"1-0"===t.row.clientProperty?n("span",[e._v("直客")]):"1-1"===t.row.clientProperty?n("span",[e._v("同行")]):n("span",[e._v("--")])]}}],null,!1,113077360)}),n("vxe-table-column",{attrs:{title:"货币",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(""+(t.row.currencyName||"")+(t.row.currencyId||"")))])]}}],null,!1,2595197676)}),n("vxe-table-column",{attrs:{"min-width":"100",title:"金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.amount))])]}}],null,!1,1167497322)}),n("vxe-table-column",{attrs:{"min-width":"100",title:"本币金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.selfAmount))])]}}],null,!1,3043539318)}),n("vxe-table-column",{attrs:{width:"180",title:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.createTime))])]}}],null,!1,2774630583)}),n("vxe-table-column",{attrs:{width:"180",title:"审核时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.auditTime))])]}}],null,!1,202786590)})],1),n("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":function(t){return e.handleCurrentChange(t,"project")}}})],1):e._e(),"selected"===e.selectVal&&e.selectedData.length?n("div",[n("div",{staticStyle:{padding:"10px 10px 0 0","text-align":"right"}},[n("span",{staticStyle:{"font-size":"12px"}},[e._v("本币总金额：")]),n("span",[e._v(e._s(e.selfAmount)+"  ")]),e._l(e.amountList,function(t){return n("span",{key:t.key},[n("span",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.label)+"：")]),n("span",{},[e._v(e._s(t.value)+"  ")])])})],2),n("vxe-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.selectedData,"auto-resize":!0,height:"450","header-align":"center",align:"center",border:"",size:"small"}},[n("vxe-table-column",{attrs:{visible:"02"!==e.form.serviceTypeId&&"06"!==e.form.serviceTypeId,fixed:"left",width:"160",title:"原单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.orderCode))])]}}],null,!1,2549254981)}),n("vxe-table-column",{attrs:{fixed:"left",visible:"02"===e.form.serviceTypeId||"06"===e.form.serviceTypeId,width:"160",title:"SO号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.soNoList||[]).join(",")))])]}}],null,!1,2108195871)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"提单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.billNoList||[]).join(",")))])]}}],null,!1,528558280)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"航空单号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.airNoList||[]).join(",")))])]}}],null,!1,3875341849)}),n("vxe-table-column",{attrs:{visible:"02"===e.form.serviceTypeId,width:"160",title:"柜号"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((t.row.containerNoList||[]).join(",")))])]}}],null,!1,3174292868)}),n("vxe-table-column",{attrs:{prop:"status",title:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s((e.statusList.find(function(e){return e.id===t.row.status})||{}).name))])]}}],null,!1,641954429)}),n("vxe-table-column",{attrs:{title:"核销状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.ifVerify?n("span",[e._v("已核销")]):e._e(),0===t.row.ifVerify?n("span",[e._v("未核销")]):e._e()]}}],null,!1,1233879789)}),n("vxe-table-column",{attrs:{title:"发票日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.invDate))])]}}],null,!1,2385324867)}),n("vxe-table-column",{attrs:{title:"客户名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.clientName))])]}}],null,!1,549671992)}),n("vxe-table-column",{attrs:{prop:"",title:"客户属性",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.clientProperty?n("span",[e._v("聚货通")]):"2-1"===t.row.clientProperty?n("span",[e._v("一级代理")]):"2-2"===t.row.clientProperty?n("span",[e._v("二级代理")]):"1-0"===t.row.clientProperty?n("span",[e._v("直客")]):"1-1"===t.row.clientProperty?n("span",[e._v("同行")]):n("span",[e._v("--")])]}}],null,!1,113077360)}),n("vxe-table-column",{attrs:{prop:"currencyName",title:"货币",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(""+(t.row.currencyName||"")+(t.row.currencyId||"")))])]}}],null,!1,2595197676)}),n("vxe-table-column",{attrs:{"min-width":"100",title:"金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.amount))])]}}],null,!1,1167497322)}),n("vxe-table-column",{attrs:{"min-width":"100",title:"本币金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.selfAmount))])]}}],null,!1,3043539318)}),n("vxe-table-column",{attrs:{width:"180",title:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.createTime))])]}}],null,!1,2774630583)}),n("vxe-table-column",{attrs:{prop:"auditTime",width:"180",title:"审核时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.auditTime))])]}}],null,!1,202786590)}),n("vxe-table-column",{attrs:{title:"操作",fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isView?e._e():n("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(n){return e.deleteRow(t.$index)}}},[e._v("\n              删除\n            ")])]}}],null,!1,1806500401)})],1)],1):e._e(),n("el-dialog",{attrs:{title:"选择客户",visible:e.isCustomer,"close-on-click-modal":!1,width:"1000px"},on:{"update:visible":function(t){e.isCustomer=t},closed:function(t){e.isCustomer=!1}}},[n("div",{staticStyle:{"text-align":"right"}},["2"===e.custType&&"1"===e.custSubtype?n("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{size:"small",filterable:"",clearable:"",placeholder:"公司类型"},on:{change:e.onComType},model:{value:e.form.custTag,callback:function(t){e.$set(e.form,"custTag",t)},expression:"form.custTag"}},[n("el-option",{attrs:{label:"本公司",value:"1"}}),n("el-option",{attrs:{label:"分公司",value:"2"}})],1):e._e(),"2"===e.custType&&"1"===e.custSubtype&&"2"===e.form.custTag?n("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.form.agentId,callback:function(t){e.$set(e.form,"agentId",t)},expression:"form.agentId"}},e._l(e.companyList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),n("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"客户类型",size:"small",filterable:""},on:{change:e.onClientType},model:{value:e.form.clientType,callback:function(t){e.$set(e.form,"clientType",t)},expression:"form.clientType"}},e._l(e.custTypeList,function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1),"3"!==e.custType||"0"!==e.form.clientType?n("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"客户",size:"small",clearable:""},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}}):e._e(),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onCustomer}},[e._v("\n          查询\n        ")])],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.customerList,border:"",height:"375px"},on:{"row-click":function(t){return e.onTableRowClick(t,"customer")}}},[n("el-table-column",{attrs:{prop:"name",label:"客户名称"}}),n("el-table-column",{attrs:{prop:"",label:"客户属性"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.type?n("span",[e._v("聚货通")]):"3"===t.row.type?n("span",[e._v("供应商")]):"2"===t.row.type&&"1"===t.row.subtype?n("span",[e._v("一级代理")]):"2"===t.row.type&&"2"===t.row.subtype?n("span",[e._v("二级代理")]):"1"===t.row.type&&"0"===t.row.subtype?n("span",[e._v("直客")]):"1"===t.row.type&&"1"===t.row.subtype?n("span",[e._v("同行")]):n("span",[e._v("--")])]}}])}),n("el-table-column",{attrs:{prop:"parentName",label:"所属上级"}})],1),n("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next",total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"page",t)},"update:current-page":function(t){return e.$set(e.pagination,"page",t)},"current-change":e.handlePageChange}})],1)],1)])},y=[],g=(n("7f7f"),n("75fc")),b=(n("7514"),n("42f8")),w=n("5a0c"),k=n.n(w);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(){return{ifBill:0,clientId:void 0,clientName:void 0,clientType:void 0,custTag:void 0,agentId:void 0,agentName:void 0,invDate:k()().format("YYYY-MM-DD HH:mm:ss"),serviceTypeId:void 0,serviceTypeName:void 0,remark:void 0,amount:void 0,currencyMap:void 0,currencyId:void 0}}var O=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.dayjs=k.a,e.form=T(),e.selectVal="",e.searchForm={name:""},e.pagination={page:1,size:10,total:0},e.formRules={agentId:[{required:!0,message:"请选择所属公司",trigger:"change"}],serviceTypeId:[{required:!0,message:"请选择服务类型",trigger:"change"}],ifBill:[{required:!0,message:"请选择是否开票",trigger:"change"}],clientName:[{required:!0,message:"客户不能为空",trigger:"change"}],invDate:[{required:!0,message:"请选择日期",trigger:"change"}]},e.detailLoading=!1,e.dialogLoading=!1,e.selectLoading=!1,e.loading=!1,e.isCustomer=!1,e.serviceTypeList=[],e.tableData=[],e.selectedData=[],e.customerData=[],e.currencyList=[],e.companyList=[],e.custTypeList=[],e.total=0,e.page=1,e.size=10,e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"handleBack",value:function(){this.tableData=[],this.selectedData=[],this.customerData=[],this.searchForm.name="",this.selectVal="",this.$emit("back")}},{key:"validateData",value:function(e){var t=!0,n=this.$refs.editForm;n.validate(function(e){t=e}),e(t)}},{key:"handleSave",value:function(){var e=this;this.validateData(function(t){if(!t)return!1;if(e.selectedData.length<=0)e.$message.error("请选择明细行");else{var n=e.selectedData.filter(function(e){return e.currencyId}),a=n.filter(function(e){return e.currencyId!==n[0].currencyId});if(1===e.form.ifBill&&a.length>0)e.$message.error("税务开票不能选择多个币种！");else{var i=e.selectedData.map(function(e){return{invoiceId:(e||{}).id}}),r=_({},e.form,{status:"0",amount:e.selfAmount,currencyId:(e.selectedData[0]||{}).selfName,currencyMap:e.amountObj,custType:e.form.clientProperty,clientProperty:void 0,clientType:void 0,custTag:void 0,operatorCustId:e.custId,operatorCustName:e.custName,itemList:i});e.detailLoading=!0,e.isEdit?Object(b["e"])(r).then(function(){e.detailLoading=!1,e.handleBack(),e.$emit("getTableData")}).catch(function(){e.detailLoading=!1}):e.isAdd&&Object(b["a"])(r).then(function(){e.detailLoading=!1,e.handleBack(),e.$emit("getTableData")}).catch(function(){e.detailLoading=!1})}}})}},{key:"handleExport",value:function(){var e=this;this.loading=!0;var t={billingId:this.form.id};Object(b["g"])(t).then(function(t){e.loading=!1;var n=document.createElement("a");document.body.appendChild(n);var a=new Blob([t],{type:"application/vnd.ms-excel"}),i=URL.createObjectURL(a);n.href=i,n.download=e.form.clientName+"开票数据"+k()().format("YYYY-MM-DD_HH-mm-ss")+".xls",n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}).catch(function(t){e.loading=!1,t.data.text().then(function(t){try{var n=JSON.parse(t);200!==n.code&&e.$message.error(n.msg||"文件下载失败")}catch(a){return a}})})}},{key:"onSelected",value:function(){var e=this;if("all"===this.selectVal){var t=this.tableData.filter(function(t){return e.selectedData.find(function(e){return e.id===t.id})});this.$nextTick(function(){e.toggleSelection(t)})}}},{key:"deleteRow",value:function(e){var t=this;this.selectedData.splice(e,1);var n=this.tableData.filter(function(e){return t.selectedData.find(function(t){return t.id===e.id})});this.$nextTick(function(){t.toggleSelection(n)})}},{key:"onRowSelectable",value:function(e,t){return!this.isView}},{key:"handleSelected",value:function(e){e.checked?this.selectedData.push(e.row):this.selectedData=this.selectedData.filter(function(t){return t.id!==e.row.id})}},{key:"handleSelectAll",value:function(e){var t=this;this.isView||(e.checked?this.selectedData=[].concat(Object(g["a"])(this.selectedData),Object(g["a"])(this.tableData)).reduce(function(e,t){return e.find(function(e){return e.id===t.id})||e.push(t),e},[]):this.selectedData=this.selectedData.filter(function(e){return!t.tableData.find(function(t){return t.id===e.id})}))}},{key:"toggleSelection",value:function(e){var t=this,n=this.$refs.tables;n.clearCheckboxRow(),e.length>0&&e.map(function(e){var n=t.$refs.tables;n.toggleCheckboxRow(e)})}},{key:"resetDialog",value:function(){this.pagination={page:1,size:10,total:0},this.searchForm={name:""}}},{key:"onComType",value:function(){this.form.agentId="",this.form.agentName="",this.form.clientName="",this.form.clientId="",this.form.clientType="",this.form.clientProperty="",this.form.serviceTypeId="",this.form.serviceTypeName="",this.tableData=[],this.customerData=[],this.setCustomerType(),"2"!==this.form.custTag&&(this.form.agentId=this.custId,this.form.agentName=this.custName)}},{key:"onCompany",value:function(){var e=this;this.form.agentName="",this.form.clientName="",this.form.clientId="",this.form.clientType="",this.form.clientProperty="",this.form.serviceTypeId="",this.form.serviceTypeName="",this.tableData=[],this.customerData=[];var t=this.companyList.find(function(t){return t.id===e.form.agentId});t&&(this.form.agentName=t.name)}},{key:"getCompanyList",value:function(){var e=this;this.selectLoading=!0,Object(b["w"])().then(function(t){var n=t.data||[];e.companyList=n,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"onClientType",value:function(){this.form.clientName="",this.form.clientId="",this.form.clientProperty="",this.form.serviceTypeId="",this.form.serviceTypeName="",this.tableData=[],this.customerData=[]}},{key:"getServiceType",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={cas:"",custId:this.form.clientId},"1"===this.form.clientType&&(t.cas="C"),"2"===this.form.clientType&&(t.cas="A"),this.selectLoading=!0,e.next=6,Object(b["x"])(t).then(function(e){n.selectLoading=!1;var t=e.data||[];n.serviceTypeList=t.map(function(e){return{id:e.typeId,name:e.typeName}})}).catch(function(){n.serviceTypeList=[],n.selectLoading=!1});case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getCurrencyList",value:function(){var e=this;Object(b["l"])().then(function(t){var n=t.data||{};e.currencyList=n.result||[]}).catch(function(e){return e})}},{key:"handleCustomer",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.resetDialog(),this.isCustomer=!0;case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"onCustomer",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.custType,n=this.custSubtype,this.form.clientType){e.next=7;break}return this.$message.error("请选择客户类型"),e.abrupt("return",!1);case 7:if("3"!==t||"0"!==this.form.clientType){e.next=12;break}this.customerData=[{id:"0",name:"聚货通",type:"0",subtype:"",countryId:"CN",parentName:this.custName}],this.pagination.total=this.customerData.length,e.next=24;break;case 12:if("3"!==t||"2"!==this.form.clientType){e.next=17;break}return e.next=15,this.getAgentList("0");case 15:e.next=24;break;case 17:if("2"!==t||"1"!==n||"2"!==this.form.clientType){e.next=22;break}return e.next=20,this.getAgentList();case 20:e.next=24;break;case 22:return e.next=24,this.getCustomerData();case 24:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getCustomerData",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.dialogLoading=!0,t={custIds:[this.form.agentId],name:this.searchForm.name},e.next=4,Object(b["m"])(t).then(function(e){n.dialogLoading=!1;var t=e.data||[],a=t;n.customerData=a,n.pagination.total=n.customerData.length}).catch(function(){n.dialogLoading=!1});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getAgentList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.dialogLoading=!0,n={page:this.pagination.page,size:9999,name:this.searchForm.name,parentId:t||this.form.agentId},e.next=4,Object(b["h"])(n).then(function(e){var t=e.data||{},n=t.result||[];a.customerData=n.map(function(e){return e.type="2",e}),a.pagination.total=t.total,a.dialogLoading=!1}).catch(function(e){return a.dialogLoading=!1,e});case 4:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"handlePageChange",value:function(e){this.pagination.page=e}},{key:"onServiceType",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.serviceTypeList.find(function(e){return e.id===t})||{},this.form.serviceTypeName=n.name,this.selectedData=[],this.tableData=[],this.form.serviceTypeId&&this.form.clientId){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.getOutInvoiceByCustomer();case 8:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"onTableRowClick",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){var a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if("customer"!==n){e.next=15;break}if(a=t.type,i=t.subtype,this.form.clientName=t.name,this.form.clientId=t.id,this.form.serviceTypeId="",this.form.serviceTypeName="",this.form.clientProperty=a+(i?"-".concat(i):""),this.isCustomer=!1,this.selectedData=[],this.tableData=[],this.form.serviceTypeId&&this.form.clientId){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,this.getOutInvoiceByCustomer();case 15:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getOutInvoiceByCustomer",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={clientIds:[this.form.clientId],enterpriseId:[this.form.agentId],serviceTypeId:this.form.serviceTypeId,type:"R",ifVerify:0,status:"1",page:this.page,size:this.size},n=this.custType,t.custTag="3"===n?"0"===this.form.clientType?"3":"1"===this.form.clientType?"4":"":this.form.custTag,e.next=6,Object(b["o"])(t).then(function(e){var t=e.data||{};a.tableData=t.result||[];var n=a.tableData.filter(function(e){return a.selectedData.find(function(t){return t.id===e.id})});a.$nextTick(function(){a.toggleSelection(n)}),a.total=t.total,a.loading=!1}).catch(function(e){return a.loading=!1,a.detailLoading=!1,e});case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCurrentChange",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.page=t,e.next=3,this.getOutInvoiceByCustomer();case 3:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getDetailsById",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={model:this.form.id,page:1,size:999},e.next=3,Object(b["q"])(t).then(function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a=t.data,i=a.result||[],n.selectedData=i;case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){n.detailLoading=!1});case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"show",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,a,i,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.isView,this.selectVal=n?"selected":"all",this.detailLoading=!0,this.getCurrencyList(),a=this.$refs.editForm,this.$nextTick(function(){a.clearValidate()}),!t){e.next=27;break}return this.form=_({},t,{custType:void 0,clientProperty:t.custType,clientType:t.custType?t.custType.substring(0,1):"1"}),this.setCustomerType(),e.prev=9,e.next=12,this.getDetailsById();case 12:return e.next=14,this.getServiceType();case 14:if(i=this.serviceTypeList.find(function(e){return e.id===r.form.serviceTypeId})||{},this.form.serviceTypeName=i.name,e.t0=!n,!e.t0){e.next=20;break}return e.next=20,this.getOutInvoiceByCustomer();case 20:e.next=25;break;case 22:e.prev=22,e.t1=e["catch"](9),this.detailLoading=!1;case 25:e.next=34;break;case 27:this.form=T(),this.form.agentId=this.custId,this.form.agentName=this.custName,this.setCustomerType(),this.tableData=[],this.selectedData=[],this.resetDialog();case 34:this.detailLoading=!1;case 35:case"end":return e.stop()}},e,this,[[9,22]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"setCustomerType",value:function(){var e=this.custType,t=this.custSubtype;"0"===e?this.custTypeList=[{id:"2",name:"代理商"}]:"2"===e&&"1"===t&&"1"===this.form.custTag?this.custTypeList=[{id:"2",name:"二级代理商"},{id:"1",name:"客户"}]:"2"===e&&"1"===t&&"2"===this.form.custTag?this.custTypeList=[{id:"1",name:"客户"}]:"2"===e&&"2"===t?this.custTypeList=[{id:"1",name:"客户"}]:"3"===e?this.custTypeList=[{id:"0",name:"聚货通"},{id:"2",name:"代理商"},{id:"1",name:"客户"}]:(this.custTypeList=[],this.form.clientType=void 0)}},{key:"custId",get:function(){var e=h["a"].info||{},t=e.custId;return t}},{key:"custName",get:function(){var e=h["a"].info||{},t=e.custName;return t}},{key:"custType",get:function(){var e=h["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=h["a"].info||{},t=e.custSubtype;return t}},{key:"customerList",get:function(){return this.customerData.slice((this.pagination.page-1)*this.pagination.size,this.pagination.page*this.pagination.size)}},{key:"selfAmount",get:function(){var e=0;return e=this.selectedData.reduce(function(e,t){var n=t.selfAmount;return e+=parseFloat(n.toFixed(2)),e},0),parseFloat(e.toFixed(2))}},{key:"amountList",get:function(){var e=this,t=[],n=this.amountObj;return Object.keys(n).map(function(a){var i=e.currencyList.find(function(e){return e.id===a});i&&t.push({label:(i||{}).name+"总金额",key:a,value:n[a]})}),t}},{key:"amountObj",get:function(){var e=this,t={};return this.currencyList.map(function(n){var a=e.selectedData.filter(function(e){return e.currencyId===n.id});a.length>0&&(t[n.id]=a.reduce(function(e,t){var n=t.amount;return e+=parseFloat(n.toFixed(2)),e},0))}),t}}]),t}(m["e"]);O=f["a"]([Object(m["a"])({name:"detail",components:{},props:{isAdd:{type:Boolean,default:!1},isView:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},isOnce:{type:Boolean,default:!1},statusList:{type:Array,default:function(){return[]}}}})],O);var S=O,j=S,L=(n("0853"),n("2877")),D=Object(L["a"])(j,v,y,!1,null,"03c683b2",null),I=D.exports;function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach(function(t){Object(s["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var z=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.searchForm={serviceTypeId:"02",comType:void 0,comId:void 0,code:void 0,clientName:void 0,endDate:void 0,orderCode:void 0,startDate:void 0,status:void 0,ifVerify:void 0},e.auditForm={id:"",status:"1"},e.auditFormRules={status:[{required:!0,message:"请选择审核状态",trigger:"change"}],note:[{required:!0,message:"请填写拒绝原因",trigger:"change"}]},e.time=[],e.tableData=[],e.companyList=[],e.serviceList=[],e.total=0,e.page=1,e.size=10,e.selectType="1",e.keyWord="",e.loading=!1,e.dialogLoading=!1,e.selectLoading=!1,e.visible=!1,e.isEdit=!1,e.isAdd=!1,e.isView=!1,e.isOnce=!1,e.moreShow=!1,e.detailShow=!1,e.dialogAdjust=!1,e.dialogDeduct=!1,e.statusList=[{name:"待审核",id:"0"},{name:"已通过",id:"1"},{name:"已拒绝",id:"2"},{name:"审核中",id:"3"}],e.companyTypeList=[],e.typeList=[],e.orderForm={},e}return Object(p["a"])(t,e),Object(l["a"])(t,[{key:"onComType",value:function(){this.tableData=[],this.searchForm.comId="",this.companyList=[],this.handleSearch(1)}},{key:"onCompany",value:function(){this.tableData=[],this.handleSearch(1)}},{key:"getCompanyList",value:function(){var e=this;if(this.selectLoading=!0,"2"===this.searchForm.comType)Object(b["w"])().then(function(t){var n=t.data||[];e.companyList=n,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t});else if("4"===this.searchForm.comType){var t={custIds:[this.custId]};Object(b["m"])(t).then(function(t){var n=t.data||[];e.companyList=n,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}}},{key:"getServiceList",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.selectLoading=!0,t={custType:"1"},e.next=4,Object(b["i"])(t).then(function(e){n.serviceList=e.data||[],n.selectLoading=!1}).catch(function(e){return n.selectLoading=!1,e});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"handleService",value:function(){this.handleSearch(1)}},{key:"cancelAudit",value:function(){this.visible=!1,this.auditForm={id:"",status:"1"}}},{key:"handleAudit",value:function(e,t){var n=this;if("0"===e.status){var a={id:e.id,status:"3"};Object(b["b"])(a).then(function(){n.tableData[t].status="3"}).catch(function(e){return e})}this.visible=!0,this.auditForm={id:e.id,status:"1"}}},{key:"confirmAudit",value:function(){var e=this,t=N({},this.auditForm);this.dialogLoading=!0,Object(b["b"])(t).then(function(){e.$message.success("操作成功"),e.dialogLoading=!1,e.cancelAudit(),e.handleSearch()}).catch(function(){e.dialogLoading=!1})}},{key:"handleAdd",value:function(){this.detailShow=!0,this.isEdit=!1,this.isAdd=!0,this.isView=!1,this.isOnce=!0;var e=this.$refs.detailForm;this.$nextTick(function(){e.show()})}},{key:"handleEdit",value:function(e){this.detailShow=!0,this.isEdit=!0,this.isAdd=!1,this.isView=!1,this.isOnce=!1;var t=this.$refs.detailForm;this.$nextTick(function(){t.show(e)})}},{key:"handleDetail",value:function(e){this.detailShow=!0,this.isEdit=!1,this.isAdd=!1,this.isView=!0,this.isOnce=!1;var t=this.$refs.detailForm;this.$nextTick(function(){t.show(e)})}},{key:"handleExport",value:function(e){var t=this;this.loading=!0;var n={billingId:e.id};Object(b["g"])(n).then(function(n){t.loading=!1;var a=document.createElement("a");document.body.appendChild(a);var i=new Blob([n],{type:"application/vnd.ms-excel"}),r=URL.createObjectURL(i);a.href=r,a.download=e.clientName+"开票数据"+k()().format("YYYY-MM-DD_HH-mm-ss")+".xls",a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}).catch(function(e){t.loading=!1,e.data.text().then(function(e){try{var n=JSON.parse(e);200!==n.code&&t.$message.error(n.msg||"文件下载失败")}catch(a){return a}})})}},{key:"handleDelete",value:function(e){var t=this,n={id:e};this.$confirm("请确认是否删除该条数据?","温馨提示",{confirmButtonText:"确定",closeOnClickModal:!1,cancelButtonText:"取消",type:"warning"}).then(function(){Object(b["d"])(n).then(function(e){t.$message({type:"success",message:"删除成功"}),t.handleSearch()}).catch(function(e){return e})}).catch(function(){return!1})}},{key:"handleSearch",value:function(e){var t=this;e&&(this.page=e);var n=this.searchForm,a=n.comType,i=n.comId,s=Object(r["a"])(n,["comType","comId"]),o=this.custId,c={model:N({},s,{custTag:a,orderCode:"1"===this.selectType?this.keyWord:void 0,clientName:"2"===this.selectType?this.keyWord:void 0,agentId:"1"===a||"3"===a?[o]:i?[i]:[]}),size:this.size,page:this.page};Array.isArray(this.time)&&this.time.length>0&&(c.model.start=this.time[0],c.model.end=this.time[1]),this.loading=!0,Object(b["r"])(c).then(function(e){var n=e.data||{};t.tableData=n.result||[],t.total=n.total,t.loading=!1}).catch(function(e){return t.loading=!1,[null,e]})}},{key:"handleSizeChange",value:function(e){this.size=e,this.handleSearch()}},{key:"handleCurrentChange",value:function(e){this.page=e,this.handleSearch()}},{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.time=[k()().subtract(30,"d").format("YYYY-MM-DD"),k()().format("YYYY-MM-DD")],t=this.custType,n=this.custSubtype,this.searchForm.comType="1","2"===t&&"1"===n?(this.companyTypeList=[{id:"1",name:"本公司"},{id:"2",name:"分公司"}],this.searchForm.comType="2"):"3"===t&&(this.companyTypeList=[{id:"3",name:"聚货通"},{id:"4",name:"客户"},{id:"5",name:"代理商"}],this.searchForm.comType="3"),e.next=7,this.getServiceList();case 7:this.handleSearch();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"custId",get:function(){var e=h["a"].info||{},t=e.custId;return t}},{key:"custName",get:function(){var e=h["a"].info||{},t=e.custName;return t}},{key:"custType",get:function(){var e=h["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=h["a"].info||{},t=e.custSubtype;return t}}]),t}(m["e"]);z=f["a"]([Object(m["a"])({name:"",components:{detail:I},props:{}})],z);var F=z,R=F,P=(n("0e5a"),Object(L["a"])(R,a,i,!1,null,"6804ab2b",null));t["default"]=P.exports},"42f8":function(e,t,n){"use strict";n.d(t,"h",function(){return o}),n.d(t,"w",function(){return c}),n.d(t,"r",function(){return l}),n.d(t,"q",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"e",function(){return p}),n.d(t,"g",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"d",function(){return h}),n.d(t,"x",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"l",function(){return g}),n.d(t,"o",function(){return b}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return k}),n.d(t,"k",function(){return x}),n.d(t,"B",function(){return _}),n.d(t,"y",function(){return T}),n.d(t,"p",function(){return O}),n.d(t,"u",function(){return S}),n.d(t,"j",function(){return j}),n.d(t,"v",function(){return L}),n.d(t,"A",function(){return D}),n.d(t,"f",function(){return I}),n.d(t,"n",function(){return C}),n.d(t,"z",function(){return N}),n.d(t,"c",function(){return z}),n.d(t,"i",function(){return F});n("8e6e"),n("ac6a"),n("456d");var a=n("bd86"),i=n("b32d");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach(function(t){Object(a["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e){var t={url:"/auth/agent/getAgentList",method:"get",params:e};return Object(i["a"])(t)}function c(){var e={url:"/auth/agent/customer_finance",method:"get"};return Object(i["a"])(e)}function l(e){var t={url:"/finance/bill/page",method:"post",data:e};return Object(i["a"])(t)}function u(e){var t={url:"/finance/bill/item",method:"post",data:e};return Object(i["a"])(t)}function d(e){var t={url:"/finance/bill/add",method:"post",data:e};return Object(i["a"])(t)}function p(e){var t={url:"/finance/bill/edit",method:"post",data:e};return Object(i["a"])(t)}function f(e){var t={url:"/finance/account/export",method:"post",responseType:"blob",params:e};return Object(i["a"])(t)}function m(e){var t={url:"/finance/bill/audit",method:"get",params:e};return Object(i["a"])(t)}function h(e){var t={url:"",method:"post",params:e};return Object(i["a"])(t)}function v(e){var t={url:"/auth/custtype/getServerType",method:"get",params:e};return Object(i["a"])(t)}function y(e){var t={url:"/auth/customer/customer",method:"post",data:e};return Object(i["a"])(t)}function g(e){var t={url:"/setting/currency/getCurrencyList",method:"get",params:s({page:1,size:999},e)};return Object(i["a"])(t)}function b(e){var t={url:"/finance/account/page",method:"post",data:e};return Object(i["a"])(t)}function w(e){var t={url:"/finance/p/page",method:"post",data:e};return Object(i["a"])(t)}function k(e){var t={url:"/finance/r/page",method:"post",data:e};return Object(i["a"])(t)}function x(e){var t={url:"/finance/reconciliation/page",method:"post",data:e};return Object(i["a"])(t)}function _(e){var t={url:"/finance/reconciliation/close",method:"post",data:e};return Object(i["a"])(t)}function T(e){var t={url:"/finance/reconciliation/save",method:"post",data:e};return Object(i["a"])(t)}function O(e){var t={url:"/finance/reconciliation/pageImport",method:"post",data:e};return Object(i["a"])(t)}function S(e){var t={url:"/finance/reconciliation/relation",method:"post",data:e};return Object(i["a"])(t)}function j(e){var t={url:"finance/reconciliation/states",method:"post",data:e};return Object(i["a"])(t)}function L(e){var t={url:"/finance/reconciliation/manualRelation",method:"post",data:e};return Object(i["a"])(t)}function D(e){var t={url:"/finance/reconciliation/automaticRelation",method:"post",data:e};return Object(i["a"])(t)}function I(e){var t={url:"/finance/reconciliation/d",method:"post",responseType:"blob",data:e};return Object(i["a"])(t)}function C(e){var t={url:"/finance/fisCal/get",method:"post",data:e};return Object(i["a"])(t)}function N(e){var t={url:"/finance/fisCal/addOrUpdate",method:"post",data:e};return Object(i["a"])(t)}function z(e){var t={url:"/finance/fisCal/delete",method:"get",params:e};return Object(i["a"])(t)}function F(e){var t={url:"/cfg/type/getServiceTypeList",method:"get",params:e};return Object(i["a"])(t)}}}]);