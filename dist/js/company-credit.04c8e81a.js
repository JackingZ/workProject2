(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["company-credit"],{"0e47":function(e,t,a){},"16f7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"flex","flex-flow":"row nowrap","min-height":"inherit"}},[a("div",{staticClass:"dashboard-container",staticStyle:{flex:"1",overflow:"auto"}},[a("div",{staticClass:"app-container"},[a("head-info",{attrs:{info:"",title:"公司信用"}}),a("div",{staticClass:"app-panel"},[a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["companySetemplate"],expression:"['companySetemplate']"}],staticStyle:{float:"left"},attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.handleDefaultTemplate}},[e._v("\n              设置模板\n            ")]),"2"===e.custType&&"1"===e.custSubtype?a("el-select",{staticStyle:{width:"100px","margin-right":"5px"},attrs:{size:"small",placeholder:"公司类型"},on:{change:e.onComType},model:{value:e.selectValue.custTag,callback:function(t){e.$set(e.selectValue,"custTag",t)},expression:"selectValue.custTag"}},e._l(e.companyTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1):e._e(),"2"===e.custType&&"1"===e.custSubtype&&"2"===e.selectValue.custTag?a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,size:"small",placeholder:"所属公司",filterable:"",clearable:""},on:{change:e.onCompany,focus:e.getCompanyList},model:{value:e.selectValue.comId,callback:function(t){e.$set(e.selectValue,"comId",t)},expression:"selectValue.comId"}},e._l(e.companyList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):e._e(),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{loading:e.selectLoading,placeholder:"信用等级",size:"small",clearable:"",filterable:""},on:{focus:e.getCustRatingList},model:{value:e.selectValue.creditRating,callback:function(t){e.$set(e.selectValue,"creditRating",t)},expression:"selectValue.creditRating"}},e._l(e.creditList,function(e,t){return a("el-option",{key:t,attrs:{label:e.code+"-"+e.name,value:e.code}})}),1),a("el-input",{staticStyle:{width:"250px","margin-right":"10px"},attrs:{size:"small",maxlength:50,placeholder:"请输入",clearable:""},model:{value:e.selectValue.name,callback:function(t){e.$set(e.selectValue,"name",t)},expression:"selectValue.name"}},[a("template",{slot:"prepend"},[e._v("\n                公司名称\n              ")])],2),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["companyQuery"],expression:"['companyQuery']"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getTableData(1)}}},[e._v("\n              查询\n            ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"batchSelectTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"calc(100vh - 313px)",border:""},on:{"selection-change":e.handleSelection}},[a("el-table-column",{attrs:{prop:"name",label:"公司名称","min-width":"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"",label:"公司类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.type?a("span",[e._v("聚货通")]):"1"===t.row.type?a("span",["0"===t.row.subtype?a("span",[e._v("\n                  直客\n                ")]):e._e(),"1"===t.row.subtype?a("span",[e._v("\n                  同行\n                ")]):e._e()]):"2"===t.row.type?a("span",["1"===t.row.subtype?a("span",[e._v("\n                  一级代理\n                ")]):e._e(),"2"===t.row.subtype?a("span",[e._v("\n                  二级代理\n                ")]):e._e()]):"3"===t.row.type?a("span",[e._v("供应商")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"estimatedCost",label:"预估费用",width:"120"}}),a("el-table-column",{attrs:{prop:"debts",label:"欠款金额",width:"120"}}),a("el-table-column",{attrs:{prop:"credits",label:"信用额度",width:"120"}}),a("el-table-column",{attrs:{prop:"",formatter:e.formatCredit,label:"信用等级",width:"120"}}),a("el-table-column",{attrs:{prop:"",label:"关联要素",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["companyViewElements"]),type:"text"},on:{click:function(a){return e.handleFactor(t.row)}}},[e._v("\n                查看要素\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"",label:"发票付款",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["companyViewInvoice"]),type:"text"},on:{click:function(a){return e.handleInvoice(t.row)}}},[e._v("\n                查看发票\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"",label:"付款方式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["companyPaymentMethod"]),type:"text"},on:{click:function(a){return e.handlePaytype(t.row)}}},[e._v("\n                付款方式\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"",label:"设置标识",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:!e.$checkPermission(["companySetLogo"]),type:"text"},on:{click:function(a){return e.handleSetIcon(t.row)}}},[e._v("\n                设置标识\n              ")])]}}])}),a("el-table-column",{attrs:{prop:"notes",label:"备注","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",width:"180",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["companyEdit"],expression:"['companyEdit']"}],attrs:{disabled:"1"!==t.row.signContract,type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("\n                编辑\n              ")]),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["companyApplyAdjustment"],expression:"['companyApplyAdjustment']"}],attrs:{type:"text"},on:{click:function(a){return e.handleApplyCard(t.row)}}},[e._v("\n                申请调额\n              ")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.title1,visible:e.dialogTemplate,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogTemplate=t},close:e.cancel1}},[a("TemplateCredit",{ref:"templateCredit",attrs:{"credit-list":e.creditList,"is-pay":e.isPay},on:{cancel:e.cancel1,getAll:e.getTableData}})],1),a("el-dialog",{attrs:{title:"选择扣货",visible:e.dialogDetentCargo,"close-on-click-modal":!1,width:"1200px"},on:{"update:visible":function(t){e.dialogDetentCargo=t},close:e.cancel2}},[a("DetentCargo",{ref:"detentCargo"})],1),a("el-dialog",{attrs:{title:e.title3,visible:e.dialogFactor,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.dialogFactor=t},close:e.cancel3}},[a("Factor",{ref:"factor",attrs:{"is-check":e.isCheck,"credit-list":e.creditList},on:{cancel:e.cancel3,getAll:e.getTableData}})],1),a("el-dialog",{attrs:{title:"发票付款",visible:e.dialogInvoice,"close-on-click-modal":!1,width:"1200px"},on:{"update:visible":function(t){e.dialogInvoice=t},close:e.cancel4}},[a("Invoice",{ref:"invoice"})],1),a("el-dialog",{attrs:{title:"设置标识",visible:e.dialogSetIcon,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogSetIcon=t},close:e.cancel5}},[a("SetIcon",{ref:"setIcon",on:{cancel:e.cancel5,getAll:e.getTableData}})],1),a("el-dialog",{attrs:{title:"编辑信用",visible:e.dialogEdit,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogEdit=t},close:e.cancel6}},[a("Edit",{ref:"edit",attrs:{"credit-list":e.creditList},on:{cancel:e.cancel6,getAll:e.getTableData}})],1),a("el-dialog",{attrs:{title:"申请调额",visible:e.dialogApplyCard,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogApplyCard=t},close:e.cancel7}},[a("ApplyCard",{ref:"applyCard",on:{cancel:e.cancel7,getAll:e.getTableData}})],1)],1)],1)])])},n=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("c5f6"),a("a8db")),l=a("bd86"),o=(a("7f7f"),a("7514"),a("d225")),s=a("b0b4"),c=a("308d"),u=a("6bb5"),d=a("4e2b"),p=a("9ab4"),m=a("60a3"),f=a("9dba"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.subLoading,expression:"subLoading"}]},[e.isPay?e._e():a("el-form",{ref:"subForm",attrs:{model:e.subForm,rules:e.formRules,"label-width":"90px",size:"small"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:6}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"公司类型",size:"small"},on:{change:e.onType},model:{value:e.subForm.tag,callback:function(t){e.$set(e.subForm,"tag",t)},expression:"subForm.tag"}},e._l(e.casList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"信用等级",prop:"creditRating"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"信用等级",size:"small"},on:{change:e.onCredit},model:{value:e.subForm.creditRating,callback:function(t){e.$set(e.subForm,"creditRating",t)},expression:"subForm.creditRating"}},e._l(e.creditList,function(e,t){return a("el-option",{key:t,attrs:{label:e.code+"-"+e.name,value:e.id}})}),1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"信用额度",prop:"initialAmount"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",min:0,max:99999999,precision:2,disabled:""},model:{value:e.subForm.initialAmount,callback:function(t){e.$set(e.subForm,"initialAmount",t)},expression:"subForm.initialAmount"}})],1)],1)],1)],1),a("el-table",{ref:"serviceSelectTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.subTableData,height:"400px",border:""}},[a("el-table-column",{attrs:{prop:"typeName",label:"服务大类"}}),a("el-table-column",{attrs:{prop:"subtypeName",label:"服务类型"}}),a("el-table-column",{attrs:{label:"结算方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",filterable:""},model:{value:t.row.payMethod,callback:function(a){e.$set(t.row,"payMethod",a)},expression:"scope.row.payMethod"}},e._l(e.typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)]}}])}),a("el-table-column",{attrs:{label:"付款天数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{staticClass:"input-number-valiate",attrs:{size:"small",controls:!1,placeholder:"请输入",min:0,max:999999,step:1,"step-strictly":""},model:{value:t.row.payDays,callback:function(a){e.$set(t.row,"payDays",a)},expression:"scope.row.payDays"}})]}}])}),a("el-table-column",{attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请输入"},model:{value:t.row.notes,callback:function(a){e.$set(t.row,"notes",a)},expression:"scope.row.notes"}})]}}])})],1),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("\n      确 定\n    ")])],1)],1)},h=[],v=a("b32d");function b(e){var t={url:"/auth/credit/page",method:"post",data:e};return Object(v["a"])(t)}function y(e){var t={url:"/auth/credit/update",method:"post",data:e};return Object(v["a"])(t)}function k(e){var t={url:"/auth/credit/payment",method:"get",params:e};return Object(v["a"])(t)}function x(e){var t={url:"/auth/credit/payment/update",method:"post",data:e};return Object(v["a"])(t)}function _(e){var t={url:"/auth/credit/update_tag",method:"post",data:e};return Object(v["a"])(t)}function w(e){var t={url:"/auth/credit/template/update",method:"post",data:e};return Object(v["a"])(t)}function F(e){var t={url:"/auth/credit/update_amount",method:"post",data:e};return Object(v["a"])(t)}function S(e){var t={url:"/auth/credit/audit",method:"post",data:e};return Object(v["a"])(t)}function D(e){var t={url:"/auth/credit/template",method:"get",params:e};return Object(v["a"])(t)}function T(e){var t={url:"",method:"get",params:e};return Object(v["a"])(t)}function O(e){var t={url:"/setting/dict/item/type",method:"get",params:e};return Object(v["a"])(t)}function L(e){var t={url:"/auth/credit/get",method:"get",params:e};return Object(v["a"])(t)}function C(e){var t={url:"finance/account/getInvoiceList1",method:"post",data:e};return Object(v["a"])(t)}function $(e){var t={url:"/auth/credit/getCustRatingList",method:"post",data:e};return Object(v["a"])(t)}function j(){var e={url:"/auth/agent/customer_finance",method:"get"};return Object(v["a"])(e)}function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(a,!0).forEach(function(t){Object(l["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var A=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.subLoading=!1,e.subForm={tag:"1",initialAmount:void 0,creditRating:void 0},e.formRules={initialAmount:[{required:!0,message:"信用额度不能为空",trigger:"blur"}],creditRating:[{required:!0,message:"请选择信用等级",trigger:"change"}]},e.casList=[{name:"一级代理商",id:"1"},{name:"二级代理商",id:"2"},{name:"同行",id:"3"},{name:"直客",id:"4"}],e.currentId="",e.signC="",e.typeList=[],e.subTableData=[],e.selectLoading=!1,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"setData",value:function(e){this.currentId=e.id,this.signC=e.signContract,this.getSubTableData(),this.getPaytypeList()}},{key:"setInfo",value:function(){this.getSubTableData(),this.getPaytypeList()}},{key:"onType",value:function(){this.subTableData=[],this.getSubTableData()}},{key:"onCredit",value:function(){var e=this,t=this.creditList,a=t.find(function(t){return t.id===e.subForm.creditRating});this.subForm.initialAmount=(a||{}).rating}},{key:"getPaytypeList",value:function(){var e=this;this.selectLoading=!0,O({type:"CUST_PAY_METHOD"}).then(function(t){var a=t.data||[];e.typeList=a,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"getSubTableData",value:function(){var e=this;this.subLoading=!0;var t={},a=this.isPay;a?(t.id=this.currentId,k(t).then(function(t){e.subLoading=!1;var a=t.data||[];e.subTableData=a.map(function(e){return e.payDays=e.payDays||void 0,e})}).catch(function(t){return e.subLoading=!1,t})):(t.tag=this.subForm.tag,D(t).then(function(t){e.subLoading=!1;var a=t.data||{},i=a.ctlList,n=(a.tag,Object(r["a"])(a,["ctlList","tag"]));e.subForm=R({},e.subForm,{},n),e.subTableData=(i||[]).map(function(e){return e.payDays=e.payDays||void 0,e})}).catch(function(t){return e.subLoading=!1,t}))}},{key:"confirm",value:function(){var e=this,t=this.isPay;if(t){var a=this.subTableData.some(function(e){return e.payMethod&&e.payDays}),i=this.subTableData.some(function(e){return"1"!==e.payMethod});if(!a)return void this.$message.error("请完整填写付款方式和付款天数");if("1"!==this.signC&&i)return void this.$message.error("未签署合同，结算方式仅限为每票结算");this.subLoading=!0,x(this.subTableData).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.subLoading=!1}).catch(function(t){return e.subLoading=!1,t})}else{var n=this.$refs.subForm;n.validate(function(t){if(!t)return!1;var a=e.subTableData.some(function(e){return e.payMethod&&e.payDays});if(a){e.subLoading=!0;var i=R({},e.subForm,{ctlList:e.subTableData});w(i).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.subLoading=!1}).catch(function(t){return e.subLoading=!1,t})}else e.$message.error("请完整填写付款方式和付款天数")})}}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"reset",value:function(){this.subTableData=[],this.subForm={tag:"1",initialAmount:void 0,creditRating:void 0};var e=this.$refs.subForm;this.$nextTick(function(){e.clearValidate()})}}]),t}(m["e"]);A=p["a"]([Object(m["a"])({name:"",components:{},props:{isPay:{type:Boolean,default:!1},creditList:{type:Array,default:function(){return[]}}}})],A);var P=A,I=P,E=(a("91a6"),a("2877")),N=Object(E["a"])(I,g,h,!1,null,"3fa92f84",null),V=N.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-row",{attrs:{type:"flex",gutter:10}},[a("el-col",{staticStyle:{margin:"10px 0"},attrs:{span:8}},[a("div",{staticClass:"items"},[a("div",{staticClass:"items-head"},[e._v("\n          已选择\n        ")]),e._l(e.selectedList,function(t,i){return a("el-tag",{key:i,attrs:{closable:"",type:"info"},on:{close:function(a){return e.handleRemove(i,t)}}},[e._v("\n          "+e._s(t.name)+"\n        ")])})],2)]),a("el-col",{attrs:{span:16}},[a("el-row",{staticClass:"filter"},[a("el-col",{staticStyle:{"text-align":"right"}},[a("el-input",{staticStyle:{width:"130px"},attrs:{size:"small",placeholder:"请输入名称"},model:{value:e.goodsName,callback:function(t){e.goodsName=t},expression:"goodsName"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getGoodsData(1)}}},[e._v("\n            查询\n          ")])],1)],1),a("el-table",{ref:"theTable",attrs:{data:e.goodsList,border:""},on:{select:e.handleSelect,"select-all":e.handleSelectAll,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"",label:"订单号"}})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{small:"","current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("div",{staticStyle:{"text-align":"right","padding-top":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.save}},[e._v("\n      确 定\n    ")])],1)],1)},q=[],Y=(a("96cf"),a("3b8d")),G=(a("20d6"),function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.dialogLoading=!1,e.goodsName="",e.selectedList=[],e.goodsList=[],e.page=1,e.size=10,e.total=0,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"handleRemove",value:function(e,t){var a=this;this.selectedList.splice(e,1);var i=this.goodsList.findIndex(function(e){return e.id===t.id});-1!==i&&this.$nextTick(function(){a.$refs.theTable.toggleRowSelection(a.goodsList[i])})}},{key:"handleSelect",value:function(e,t){var a=this.selectedList.findIndex(function(e){return e.id===t.id});-1===a?this.selectedList.push({id:t.id,name:t.name}):this.selectedList.splice(a,1)}},{key:"handleSelectAll",value:function(e){var t=this;e.length?this.goodsList.forEach(function(e){t.selectedList.every(function(t){return t.id!==e.id})&&t.selectedList.push({id:e.id,name:e.name})}):this.selectedList=this.selectedList.filter(function(e){var a=t.goodsList.some(function(t){return t.id===e.id});return!a})}},{key:"handleSelectionChange",value:function(e){}},{key:"cancel",value:function(){}},{key:"save",value:function(){}},{key:"getGoodsData",value:function(){var e=Object(Y["a"])(regeneratorRuntime.mark(function e(t){var a,i,n,r,l=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.dialogLoading=!0,t&&(this.page=t),a={page:this.page,size:this.size,name:this.goodsName},e.prev=3,e.next=6,T(a);case 6:i=e.sent,n=i.data||{},r=n.result||[],this.goodsList=r.map(function(e){return{id:e.id,name:e.name}}),this.total=n.total,this.goodsList.forEach(function(e){var t=l.selectedList.some(function(t){return t.id===e.id});t&&l.$nextTick(function(){l.$refs.theTable.toggleRowSelection(e)})}),this.dialogLoading=!1,e.next=19;break;case 15:return e.prev=15,e.t0=e["catch"](3),this.dialogLoading=!1,e.abrupt("return",e.t0);case 19:case"end":return e.stop()}},e,this,[[3,15]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleSizeChange",value:function(){var e=Object(Y["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getGoodsData();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"handleCurrentChange",value:function(){var e=Object(Y["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getGoodsData();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),t}(m["e"]));G=p["a"]([Object(m["a"])({name:"",components:{},props:{}})],G);var B=G,H=B,J=(a("47fe"),Object(E["a"])(H,M,q,!1,null,"a7b1b7ae",null)),Q=J.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{directives:[{name:"show",rawName:"v-show",value:!e.isNext,expression:"!isNext"}],ref:"selectForm",staticStyle:{"padding-right":"20px"},attrs:{model:e.selectForm,rules:e.formRules,"label-width":"110px",size:"small"}},[a("el-form-item",{attrs:{label:"成立时间",prop:"setupDate"}},[e._v("\n      "+e._s(e.selectForm.setupDate)+"\n    ")]),a("el-form-item",{attrs:{label:"开始合作",prop:"cooperate"}},[e._v("\n      "+e._s(e.selectForm.cooperate)+"\n    ")]),a("el-form-item",{attrs:{label:"公司规模",prop:"companySize"}},[e._v("\n      "+e._s(e.selectForm.companySize)+" 人\n    ")]),a("el-form-item",{attrs:{label:"合作金额",prop:"cooperationAmount"}},[e._v("\n      "+e._s(e.selectForm.cooperationAmount)+"\n    ")]),a("el-form-item",{attrs:{label:"注册资金",prop:"registeredCapital"}},[e._v("\n      "+e._s(e.selectForm.registeredCapital)+"\n    ")]),a("el-form-item",{attrs:{label:"付款情况",prop:"payment"}},[e._v("\n      "+e._s(e.selectForm.payment)+"\n    ")]),a("el-form-item",{attrs:{label:"客户属性",prop:"type"}},["0"===e.selectForm.type?a("span",[e._v("聚货通")]):"1"===e.selectForm.type?a("span",["0"===e.selectForm.subtype?a("span",[e._v("\n          直客\n        ")]):e._e(),"1"===e.selectForm.subtype?a("span",[e._v("\n          同行\n        ")]):e._e()]):"2"===e.selectForm.type?a("span",["1"===e.selectForm.subtype?a("span",[e._v("\n          一级代理\n        ")]):e._e(),"2"===e.selectForm.subtype?a("span",[e._v("\n          二级代理\n        ")]):e._e()]):"3"===e.selectForm.type?a("span",[e._v("供应商")]):e._e()]),a("el-form-item",{attrs:{label:"当前欠款",prop:"debts"}},[e._v("\n      "+e._s(e.selectForm.debts)+"\n    ")]),a("el-form-item",{attrs:{label:"销售类型",prop:"saleType"}},["1"===e.selectForm.saleType?a("span",[e._v("平台")]):"2"===e.selectForm.saleType?a("span",[e._v("线下")]):e._e()]),a("el-form-item",{attrs:{label:"最近付款日期",prop:"lastPayment"}},[e._v("\n      "+e._s(e.selectForm.lastPayment)+"\n    ")]),a("el-form-item",{attrs:{label:"平台",prop:"platform"}},[e._v("\n      "+e._s(e.selectForm.platform)+"\n    ")]),a("el-form-item",{attrs:{label:"逾期次数",prop:"overdueTimes"}},[e._v("\n      "+e._s(e.selectForm.overdueTimes)+"\n    ")]),a("el-form-item",{attrs:{label:"主力国家",prop:"mainState"}},[e._v("\n      "+e._s(e.selectForm.mainState)+"\n    ")]),a("el-form-item",{attrs:{label:"逾期金额",prop:"overdueAmount"}},[e._v("\n      "+e._s(e.selectForm.overdueAmount)+"\n    ")]),a("el-form-item",{attrs:{label:"店铺链接",prop:"storeLink"}},[e._v("\n      "+e._s(e.selectForm.storeLink)+"\n    ")]),a("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[e._v("\n      "+e._s(e.selectForm.brand)+"\n    ")]),a("el-form-item",{attrs:{label:"驰名商标",prop:"trademark"}},[e._v("\n      "+e._s(e.selectForm.trademark)+"\n    ")]),e.isCheck?a("div",[a("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"信用额度",prop:"initialAmount"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{controls:!1,placeholder:"请输入",min:0,max:999999,precision:2},model:{value:e.selectForm.initialAmount,callback:function(t){e.$set(e.selectForm,"initialAmount",t)},expression:"selectForm.initialAmount"}})],1),a("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"信用等级",prop:"creditRating"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"信用等级",size:"small"},model:{value:e.selectForm.creditRating,callback:function(t){e.$set(e.selectForm,"creditRating",t)},expression:"selectForm.creditRating"}},e._l(e.creditList,function(e,t){return a("el-option",{key:t,attrs:{label:e.code+"-"+e.name,value:e.code}})}),1)],1),a("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{label:"备注",prop:"notes"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:100,autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入"},model:{value:e.selectForm.notes,callback:function(t){e.$set(e.selectForm,"notes",t)},expression:"selectForm.notes"}})],1),a("div",{staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n          取 消\n        ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.next}},[e._v("\n          下一步，付款方式\n        ")])],1)],1):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isNext,expression:"isNext"},{name:"loading",rawName:"v-loading",value:e.subLoading,expression:"subLoading"}]},[a("el-table",{ref:"serviceSelectTable",staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.subTableData,height:"400px",border:""}},[a("el-table-column",{attrs:{prop:"typeName",label:"服务大类"}}),a("el-table-column",{attrs:{prop:"subtypeName",label:"服务类型"}}),a("el-table-column",{attrs:{label:"结算方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small",filterable:""},model:{value:t.row.payMethod,callback:function(a){e.$set(t.row,"payMethod",a)},expression:"scope.row.payMethod"}},e._l(e.typeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)]}}])}),a("el-table-column",{attrs:{label:"付款天数",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{staticClass:"input-number-valiate",attrs:{size:"small",controls:!1,placeholder:"请输入",min:0,max:999999,step:1,"step-strictly":""},model:{value:t.row.payDays,callback:function(a){e.$set(t.row,"payDays",a)},expression:"scope.row.payDays"}})]}}])}),a("el-table-column",{attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请输入"},model:{value:t.row.notes,callback:function(a){e.$set(t.row,"notes",a)},expression:"scope.row.notes"}})]}}])})],1),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.back}},[e._v("\n        上一步\n      ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("\n        保 存\n      ")])],1)],1)],1)},K=[],W=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.selectForm={subtype:void 0,setupDate:void 0,cooperate:void 0,payment:void 0,debts:void 0,saleType:void 0,platform:void 0,lastPayment:void 0,type:void 0,companySize:void 0,registeredCapital:void 0,overdueTimes:void 0,countryName:void 0,overdueAmount:void 0,storeLink:void 0,brand:void 0,trademark:void 0,cooperationAmount:void 0,initialAmount:void 0,creditRating:void 0,notes:void 0,id:void 0,mainState:""},e.formRules={initialAmount:[{required:!0,message:"信用额度不能为空",trigger:"blur"}],creditRating:[{required:!0,message:"请选择信用等级",trigger:"change"}]},e.isNext=!1,e.subLoading=!1,e.typeList=[],e.subTableData=[],e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"setData",value:function(e){var t=e.id,a=e.setupDate,i=e.cooperate,n=e.payment,r=e.debts,l=e.saleType,o=e.platform,s=e.lastPayment,c=e.type,u=e.companySize,d=e.registeredCapital,p=e.overdueTimes,m=e.countryName,f=e.overdueAmount,g=e.storeLink,h=e.brand,v=e.trademark,b=e.cooperationAmount,y=e.initialAmount,k=e.creditRating,x=e.notes,_=e.subtype,w=e.mainState;this.selectForm={id:t,setupDate:a,cooperate:i,payment:n,debts:r,saleType:l,platform:o,lastPayment:s,type:c,companySize:u,registeredCapital:d,overdueTimes:p,countryName:m,overdueAmount:f,storeLink:g,brand:h,trademark:v,cooperationAmount:b,initialAmount:y,creditRating:k,notes:x,subtype:_,mainState:w}}},{key:"next",value:function(){var e=this,t=this.$refs.selectForm;t.validate(function(t){if(!t)return!1;var a=e.selectForm;a.id,a.initialAmount,a.creditRating,a.notes;e.isNext=!0,e.getPaytypeList(),e.getSubTableData()})}},{key:"getSubTableData",value:function(){var e=this;this.subLoading=!0;var t={id:this.selectForm.id};k(t).then(function(t){e.subLoading=!1;var a=t.data||[];e.subTableData=a.map(function(e){return e.payDays=e.payDays||void 0,e})}).catch(function(t){return e.subLoading=!1,t})}},{key:"getPaytypeList",value:function(){var e=this;O({type:"CUST_PAY_METHOD"}).then(function(t){var a=t.data||[];e.typeList=a}).catch(function(e){return e})}},{key:"back",value:function(){this.isNext=!1}},{key:"confirm",value:function(){var e=this,t=this.subTableData.some(function(e){return e.payMethod&&e.payDays});if(t){this.subLoading=!0;var a=this.selectForm,i=a.id,n=a.initialAmount,r=a.creditRating,l=a.notes,o={id:i,initialAmount:n,creditRating:r,notes:l,list:this.subTableData};S(o).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.subLoading=!1}).catch(function(t){return e.subLoading=!1,t})}else this.$message.error("请完整填写付款方式和付款天数")}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"reset",value:function(){this.selectForm={initialAmount:void 0,creditRating:void 0,notes:void 0,id:void 0},this.isNext=!1,this.subTableData=[];var e=this.$refs.selectForm;this.$nextTick(function(){e.clearValidate()})}}]),t}(m["e"]);W=p["a"]([Object(m["a"])({name:"",components:{},props:{isCheck:{type:Boolean,default:!1},creditList:{type:Array,default:function(){return[]}}}})],W);var X=W,Z=X,ee=(a("676f"),Object(E["a"])(Z,U,K,!1,null,"b5e93960",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-input",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{size:"small",placeholder:"发票编号"},model:{value:e.searchForm.code,callback:function(t){e.$set(e.searchForm,"code",t)},expression:"searchForm.code"}}),a("el-select",{staticStyle:{width:"130px","margin-right":"5px"},attrs:{placeholder:"核销状态",size:"small",clearable:""},model:{value:e.searchForm.ifVerify,callback:function(t){e.$set(e.searchForm,"ifVerify",t)},expression:"searchForm.ifVerify"}},[a("el-option",{attrs:{label:"已核销",value:"1"}}),a("el-option",{attrs:{label:"未核销",value:"0"}})],1),a("el-date-picker",{staticStyle:{width:"240px","margin-right":"5px"},attrs:{type:"daterange","unlink-panels":"",align:"right",size:"small","range-separator":"~","value-format":"yyyy-MM-dd","start-placeholder":"起始日期","end-placeholder":"结束日期"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),a("el-input",{staticStyle:{width:"130px","margin-right":"10px"},attrs:{size:"small",placeholder:"原单号"},model:{value:e.searchForm.orderCode,callback:function(t){e.$set(e.searchForm,"orderCode",t)},expression:"searchForm.orderCode"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v("\n        查询\n      ")])],1)],1),a("el-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.tableData,height:"400px",border:""}},[a("el-table-column",{attrs:{fixed:"left",prop:"orderCode",label:"原单号","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"left",prop:"code",label:"发票编号","min-width":"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s((e.statusList.find(function(e){return e.id===t.row.status})||{}).name)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"ifVerify",label:"核销状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.ifVerify?a("span",[e._v("已核销")]):e._e(),0===t.row.ifVerify?a("span",[e._v("未核销")]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"invDate",label:"发票日期",width:"160"}}),a("el-table-column",{attrs:{prop:"currencyName",label:"货币",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(""+(t.row.currencyName||"")+(t.row.currencyId||"")))])]}}])}),a("el-table-column",{attrs:{prop:"amount","min-width":"100",label:"金额"}}),a("el-table-column",{attrs:{prop:"createTime",width:"160",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"auditTime",label:"审核时间",width:"160"}}),a("el-table-column",{attrs:{prop:"cutoffTime",width:"160",label:"截止付款时间"}}),a("el-table-column",{attrs:{prop:"",width:"100",formatter:e.formatterCutoffTime,label:"逾期天数"}})],1),a("el-pagination",{staticStyle:{"text-align":"right"},attrs:{"current-page":e.page,"page-size":e.size,layout:"total, prev, pager, next",total:e.total},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},ie=[],ne=a("5a0c"),re=a.n(ne);function le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?le(a,!0).forEach(function(t){Object(l["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):le(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var se=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.page=1,e.size=10,e.total=0,e.tableData=[],e.loading=!1,e.currentId="",e.row={},e.time=[],e.searchForm={code:void 0,endDate:void 0,orderCode:void 0,startDate:void 0,ifVerify:void 0},e.statusList=[{name:"未审核",id:"0"},{name:"已通过",id:"1"},{name:"已拒绝",id:"2"}],e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"formatterCutoffTime",value:function(e){var t=e.cutoffTime;if(!t)return"--";if(re()(t).format("YYYY-MM-DD")===re()().format("YYYY-MM-DD"))return"--";var a=re()().diff(t,"day")+1;return a>0&&0===e.ifVerify?a:"--"}},{key:"setData",value:function(e){var t=e.id,a=e.custTag;this.row=e,this.currentId=t,this.time=[];var i=this.custType;this.searchForm={custTag:"3"===i?"34":a,code:void 0,endDate:void 0,orderCode:void 0,startDate:void 0,ifVerify:void 0},this.getTableData()}},{key:"handleSearch",value:function(){this.getTableData(1)}},{key:"getTableData",value:function(e){var t=this;this.loading=!0,e&&(this.page=e);var a=oe({},this.searchForm,{enterpriseId:[this.currentId],request:"0",page:this.page,size:this.size,type:"P"});Array.isArray(this.time)&&this.time.length>0&&(a.startDate=this.time[0],a.endDate=this.time[1]),C(a).then(function(e){var a=e.data||{};t.tableData=a.result||[],t.total=a.total,t.loading=!1}).catch(function(e){return t.loading=!1,[null,e]})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.getTableData()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.getTableData()}},{key:"custType",get:function(){var e=f["a"].info||{},t=e.custType;return t}}]),t}(m["e"]);se=p["a"]([Object(m["a"])({name:"",components:{},props:{}})],se);var ce=se,ue=ce,de=Object(E["a"])(ue,ae,ie,!1,null,"1dfa37be",null),pe=de.exports,me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{ref:"selectForm",staticStyle:{"padding-right":"20px"},attrs:{model:e.selectForm,rules:e.rules,"label-width":"130px",size:"small"}},[a("el-form-item",{attrs:{label:"下单锁舱",prop:"locked"}},[a("el-radio-group",{model:{value:e.selectForm.locked,callback:function(t){e.$set(e.selectForm,"locked",t)},expression:"selectForm.locked"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          禁用\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          启用\n        ")])],1)],1),a("el-form-item",{attrs:{label:"国内运费垫付",prop:"advance"}},[a("el-radio-group",{model:{value:e.selectForm.advance,callback:function(t){e.$set(e.selectForm,"advance",t)},expression:"selectForm.advance"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          不支持\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          支持\n        ")])],1)],1),a("el-form-item",{attrs:{label:"代收货款",prop:"collectionDelivery"}},[a("el-radio-group",{model:{value:e.selectForm.collectionDelivery,callback:function(t){e.$set(e.selectForm,"collectionDelivery",t)},expression:"selectForm.collectionDelivery"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          不支持\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          支持\n        ")])],1)],1),a("el-form-item",{attrs:{label:"生成快递单",prop:"generateExpress"}},[a("el-radio-group",{model:{value:e.selectForm.generateExpress,callback:function(t){e.$set(e.selectForm,"generateExpress",t)},expression:"selectForm.generateExpress"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          不支持\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          支持\n        ")])],1)],1),a("el-form-item",{attrs:{label:"打印快递单",prop:"printExpress"}},[a("el-radio-group",{model:{value:e.selectForm.printExpress,callback:function(t){e.$set(e.selectForm,"printExpress",t)},expression:"selectForm.printExpress"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          不支持\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          支持\n        ")])],1)],1),a("el-form-item",{attrs:{label:"平台录单",prop:"platformRecord"}},[a("el-radio-group",{on:{change:function(t){e.selectForm.recordingRole="2"}},model:{value:e.selectForm.platformRecord,callback:function(t){e.$set(e.selectForm,"platformRecord",t)},expression:"selectForm.platformRecord"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          否\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          是\n        ")])],1)],1),1===e.selectForm.platformRecord?a("el-form-item",{attrs:{label:"录单角色",prop:"recordingRole"}},[a("el-radio-group",{model:{value:e.selectForm.recordingRole,callback:function(t){e.$set(e.selectForm,"recordingRole",t)},expression:"selectForm.recordingRole"}},[a("el-radio",{attrs:{label:"2"}},[e._v("\n          业务员\n        ")]),a("el-radio",{attrs:{label:"1"}},[e._v("\n          客服\n        ")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"自动生成唛头",prop:"maitou"}},[a("el-radio-group",{model:{value:e.selectForm.maitou,callback:function(t){e.$set(e.selectForm,"maitou",t)},expression:"selectForm.maitou"}},[a("el-radio",{attrs:{label:0}},[e._v("\n          否\n        ")]),a("el-radio",{attrs:{label:1}},[e._v("\n          是\n        ")])],1)],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("\n      确 定\n    ")])],1)],1)},fe=[],ge=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.selectForm={locked:0,advance:0,collectionDelivery:0,generateExpress:0,printExpress:0,platformRecord:0,recordingRole:"2",maitou:0},e.rules={locked:[{required:!0,message:"请选择下单锁舱",trigger:"change"}],advance:[{required:!0,message:"请选择国内运费垫付",trigger:"change"}],collectionDelivery:[{required:!0,message:"请选择代收货款",trigger:"change"}],generateExpress:[{required:!0,message:"请选择生成快递单",trigger:"change"}],printExpress:[{required:!0,message:"请选择打印快递单",trigger:"change"}],platformRecord:[{required:!0,message:"请选择平台录单",trigger:"change"}],recordingRole:[{required:!0,message:"请选择录单角色",trigger:"change"}],maitou:[{required:!0,message:"请选择唛头自动生成",trigger:"change"}]},e.loading=!1,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"setData",value:function(e){var t=e.locked,a=e.advance,i=e.collectionDelivery,n=e.generateExpress,r=e.printExpress,l=e.platformRecord,o=e.recordingRole,s=e.maitou,c=e.id;this.selectForm={locked:t,advance:a,collectionDelivery:i,generateExpress:n,printExpress:r,id:c,platformRecord:l||0,recordingRole:o||"2",maitou:s||0}}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"reset",value:function(){var e=this;this.selectForm={locked:0,advance:0,collectionDelivery:0,generateExpress:0,printExpress:0,platformRecord:0,recordingRole:"2",maitou:0},this.$nextTick(function(){var t=e.$refs.selectForm;t.clearValidate()})}},{key:"confirm",value:function(){var e=this,t=this.$refs.selectForm;t.validate(function(t){t&&(e.loading=!0,_(e.selectForm).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.loading=!1}).catch(function(t){return e.loading=!1,t}))})}}]),t}(m["e"]);ge=p["a"]([Object(m["a"])({name:"",components:{},props:{}})],ge);var he=ge,ve=he,be=Object(E["a"])(ve,me,fe,!1,null,"42a68480",null),ye=be.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{ref:"selectForm",staticStyle:{"padding-right":"20px"},attrs:{model:e.selectForm,rules:e.formRules,"label-width":"110px",size:"small"}},[a("el-form-item",{attrs:{label:"信用等级",prop:"creditRating"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",placeholder:"请选择"},on:{change:e.onCredit},model:{value:e.selectForm.creditRating,callback:function(t){e.$set(e.selectForm,"creditRating",t)},expression:"selectForm.creditRating"}},e._l(e.creditList,function(e,t){return a("el-option",{key:t,attrs:{label:e.code+"-"+e.name,value:e.code}})}),1)],1),a("el-form-item",{attrs:{label:"信用额度",prop:"credits"}},[a("el-input-number",{staticClass:"input-number-valiate",attrs:{disabled:!e.selectForm.creditRating,controls:!1,placeholder:"请输入",min:0,max:e.maxNum,precision:2},model:{value:e.selectForm.credits,callback:function(t){e.$set(e.selectForm,"credits",t)},expression:"selectForm.credits"}})],1),a("el-form-item",{attrs:{label:"提货方式",prop:"takeMethod"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",placeholder:"请选择"},model:{value:e.selectForm.takeMethod,callback:function(t){e.$set(e.selectForm,"takeMethod",t)},expression:"selectForm.takeMethod"}},[a("el-option",{attrs:{label:"自主送货",value:"1"}}),a("el-option",{attrs:{label:"上门取货",value:"2"}})],1)],1),a("el-form-item",{attrs:{label:"备注",prop:"notes"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small",maxlength:100},model:{value:e.selectForm.notes,callback:function(t){e.$set(e.selectForm,"notes",t)},expression:"selectForm.notes"}})],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("\n      确 定\n    ")])],1)],1)},xe=[],_e=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.selectForm={creditRating:void 0,id:void 0,credits:void 0,notes:void 0,takeMethod:void 0},e.formRules={credits:[{required:!0,message:"信用额度不能为空",trigger:"blur"}],creditRating:[{required:!0,message:"请选择信用等级",trigger:"change"}],takeMethod:[{required:!0,message:"请选择提货方式",trigger:"change"}]},e.loading=!1,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"setData",value:function(e){var t=e.id,a=e.creditRating,i=e.credits,n=e.notes,r=e.takeMethod;this.selectForm={id:t,creditRating:a,credits:i,notes:n,takeMethod:r}}},{key:"onCredit",value:function(){this.selectForm.credits=void 0}},{key:"confirm",value:function(){var e=this,t=this.$refs.selectForm;t.validate(function(t){if(!t)return!1;e.loading=!0,y(e.selectForm).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.loading=!1}).catch(function(t){return e.loading=!1,t})})}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"reset",value:function(){var e=this;this.selectForm={creditRating:void 0,id:void 0,credits:void 0,notes:void 0,takeMethod:void 0},this.$nextTick(function(){var t=e.$refs.selectForm;t.clearValidate()})}},{key:"maxNum",get:function(){var e=this,t=0,a=this.creditList;return a.map(function(a){a.code===e.selectForm.creditRating&&(t=a.rating)}),t}}]),t}(m["e"]);_e=p["a"]([Object(m["a"])({name:"",components:{},props:{creditList:{type:Array,default:function(){return[]}}}})],_e);var we=_e,Fe=we,Se=(a("8e36"),Object(E["a"])(Fe,ke,xe,!1,null,"77581db5",null)),De=Se.exports,Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-form",{ref:"selectForm",staticStyle:{"padding-right":"20px"},attrs:{model:e.selectForm,rules:e.formRules,"label-width":"110px",size:"small"}},[a("el-form-item",{attrs:{label:"成立时间",prop:"setupDate"}},[e._v("\n      "+e._s(e.selectForm.setupDate)+"\n    ")]),a("el-form-item",{attrs:{label:"公司规模",prop:"companySize"}},[e._v("\n      "+e._s(e.selectForm.companySize)+" 人\n    ")]),a("el-form-item",{attrs:{label:"注册资金",prop:"registeredCapital"}},[e._v("\n      "+e._s(e.selectForm.registeredCapital)+"\n    ")]),a("el-form-item",{attrs:{label:"客户属性",prop:"type"}},["0"===e.selectForm.type?a("span",[e._v("聚货通")]):"1"===e.selectForm.type?a("span",["0"===e.selectForm.subtype?a("span",[e._v("\n          直客\n        ")]):e._e(),"1"===e.selectForm.subtype?a("span",[e._v("\n          同行\n        ")]):e._e()]):"2"===e.selectForm.type?a("span",["1"===e.selectForm.subtype?a("span",[e._v("\n          一级代理\n        ")]):e._e(),"2"===e.selectForm.subtype?a("span",[e._v("\n          二级代理\n        ")]):e._e()]):"3"===e.selectForm.type?a("span",[e._v("供应商")]):e._e()]),a("el-form-item",{attrs:{label:"销售类型",prop:"saleType"}},["1"===e.selectForm.saleType?a("span",[e._v("平台")]):"2"===e.selectForm.saleType?a("span",[e._v("线下")]):e._e()]),a("el-form-item",{attrs:{label:"平台",prop:"platform"}},[e._v("\n      "+e._s(e.selectForm.platform)+"\n    ")]),a("el-form-item",{attrs:{label:"主力国家",prop:"mainState"}},[e._v("\n      "+e._s(e.selectForm.mainState)+"\n    ")]),a("el-form-item",{attrs:{label:"店铺链接",prop:"storeLink"}},[e._v("\n      "+e._s(e.selectForm.storeLink)+"\n    ")]),a("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[e._v("\n      "+e._s(e.selectForm.brand)+"\n    ")]),a("el-form-item",{attrs:{label:"驰名商标",prop:"trademark"}},[e._v("\n      "+e._s(e.selectForm.trademark)+"\n    ")]),a("el-form-item",{attrs:{label:"申请理由",prop:"notes"}},[a("el-input",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{maxlength:100,autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入"},model:{value:e.selectForm.notes,callback:function(t){e.$set(e.selectForm,"notes",t)},expression:"selectForm.notes"}})],1)],1),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("\n      取 消\n    ")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("\n      确 定\n    ")])],1)],1)},Oe=[],Le=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.row={},e.selectForm={subtype:void 0,setupDate:void 0,type:void 0,companySize:void 0,registeredCapital:void 0,saleType:void 0,platform:void 0,custId:void 0,countryName:void 0,storeLink:void 0,brand:void 0,trademark:void 0,notes:void 0,mainState:""},e.formRules={notes:[{required:!0,message:"申请理由不能为空",trigger:"blur"}]},e.loading=!1,e.platList=[],e.countryList=[],e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"getCredit",value:function(){var e=this,t={custId:this.selectForm.custId};this.loading=!0,L(t).then(function(t){e.loading=!1,e.selectForm.notes=(t.data||{}).notes}).catch(function(t){e.loading=!1,e.selectForm.notes=""})}},{key:"setData",value:function(e){this.row=e;var t=e.id,a=e.setupDate,i=e.saleType,n=e.platform,r=e.countryName,l=e.storeLink,o=e.type,s=e.companySize,c=e.registeredCapital,u=e.brand,d=e.subtype,p=e.trademark,m=e.mainState;this.selectForm={custId:t,setupDate:a,saleType:i,platform:n,countryName:r,storeLink:l,type:o,companySize:s,registeredCapital:c,brand:u,notes:"",subtype:d,trademark:p,mainState:m},this.getCredit()}},{key:"confirm",value:function(){var e=this,t=this.$refs.selectForm;t.validate(function(t){if(t){e.loading=!0;var a={custId:e.selectForm.custId,notes:e.selectForm.notes,auditing:e.row.audit};F(a).then(function(t){e.$message({type:"success",message:"保存成功"}),e.cancel(),e.$emit("getAll"),e.loading=!1}).catch(function(t){return e.loading=!1,t})}})}},{key:"cancel",value:function(){this.$emit("cancel")}},{key:"reset",value:function(){var e=this;this.selectForm={setupDate:void 0,type:void 0,companySize:void 0,registeredCapital:void 0,saleType:void 0,platform:void 0,custId:void 0,countryName:void 0,storeLink:void 0,brand:void 0,trademark:void 0,notes:void 0,mainState:""},this.$nextTick(function(){var t=e.$refs.selectForm;t.clearValidate()})}}]),t}(m["e"]);Le=p["a"]([Object(m["a"])({name:"",components:{},props:{}})],Le);var Ce=Le,$e=Ce,je=(a("a2e3"),Object(E["a"])($e,Te,Oe,!1,null,"7e2652fe",null)),ze=je.exports;function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function Ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(a,!0).forEach(function(t){Object(l["a"])(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var Pe=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(c["a"])(this,Object(u["a"])(t).apply(this,arguments)),e.loading=!1,e.dialogTemplate=!1,e.isPay=!1,e.dialogDetentCargo=!1,e.isCheck=!1,e.dialogFactor=!1,e.dialogInvoice=!1,e.dialogSetIcon=!1,e.dialogEdit=!1,e.dialogApplyCard=!1,e.selectLoading=!1,e.creditList=[],e.agentList=[],e.companyList=[],e.tableData=[],e.selectValue={creditRating:void 0,name:void 0,comId:void 0,custTag:void 0},e.companyTypeList=[{id:"1",name:"本公司"},{id:"2",name:"分公司"}],e.title1="",e.title3="",e.page=1,e.size=10,e.total=0,e}return Object(d["a"])(t,e),Object(s["a"])(t,[{key:"formatCredit",value:function(e){var t=this.creditList.find(function(t){return t.code===e.creditRating})||{};return"".concat(t.code||"","-").concat(t.name||"")}},{key:"onComType",value:function(){this.selectValue.comId="",this.companyList=[],this.tableData=[],this.getTableData(1)}},{key:"onCompany",value:function(){this.tableData=[],this.getTableData(1)}},{key:"getCompanyList",value:function(){var e=this;this.selectLoading=!0,j().then(function(t){var a=t.data||[];e.companyList=a,e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"getCustRatingList",value:function(){var e=this;this.selectLoading=!0,$({page:1,size:999}).then(function(t){var a=t.data||{},i=a.result||[];e.creditList=i.map(function(e){return e.id=e.id+"",e}),e.selectLoading=!1}).catch(function(t){return e.selectLoading=!1,t})}},{key:"handleDefaultTemplate",value:function(){var e=this;this.dialogTemplate=!0,this.isPay=!1,this.title1="设置模板",this.$nextTick(function(){var t=e.$refs.templateCredit;t.setInfo()})}},{key:"handleCheck",value:function(e){var t=this;this.isCheck=!0,this.dialogFactor=!0,this.title3="审核",this.$nextTick(function(){var a=t.$refs.factor;a.setData(e)})}},{key:"handleFactor",value:function(e){var t=this;this.dialogFactor=!0,this.isCheck=!1,this.title3="查看要素",this.$nextTick(function(){var a=t.$refs.factor;a.setData(e)})}},{key:"handleInvoice",value:function(e){var t=this;this.dialogInvoice=!0,this.$nextTick(function(){var a=t.$refs.invoice;a.setData(Ae({},e,{custTag:t.selectValue.custTag}))})}},{key:"handlePaytype",value:function(e){var t=this;this.dialogTemplate=!0,this.isPay=!0,this.title1="付款方式",this.$nextTick(function(){var a=t.$refs.templateCredit;a.setData(e)})}},{key:"handleSetIcon",value:function(e){var t=this;this.dialogSetIcon=!0,this.$nextTick(function(){var a=t.$refs.setIcon;a.setData(e)})}},{key:"handleDetentCargo",value:function(e){this.dialogDetentCargo=!0}},{key:"handleEdit",value:function(e){var t=this;this.dialogEdit=!0,this.$nextTick(function(){var a=t.$refs.edit;a.setData(e)})}},{key:"handleApplyCard",value:function(e){var t=this;this.dialogApplyCard=!0,this.$nextTick(function(){var a=t.$refs.applyCard;a.setData(e)})}},{key:"cancel1",value:function(){var e=this;this.dialogTemplate=!1,this.isPay=!1,this.$nextTick(function(){var t=e.$refs.templateCredit;t.reset()})}},{key:"cancel2",value:function(){this.dialogDetentCargo=!1}},{key:"cancel3",value:function(){var e=this;this.dialogFactor=!1,this.isCheck&&this.$nextTick(function(){var t=e.$refs.factor;t.reset()})}},{key:"cancel4",value:function(){this.dialogInvoice=!1}},{key:"cancel5",value:function(){var e=this;this.dialogSetIcon=!1,this.$nextTick(function(){var t=e.$refs.setIcon;t.reset()})}},{key:"cancel6",value:function(){var e=this;this.dialogEdit=!1,this.$nextTick(function(){var t=e.$refs.edit;t.reset()})}},{key:"cancel7",value:function(){var e=this;this.dialogApplyCard=!1,this.$nextTick(function(){var t=e.$refs.applyCard;t.reset()})}},{key:"handleSelection",value:function(e){}},{key:"getTableData",value:function(e){var t=this;this.loading=!0,e&&(this.page=e);var a=this.selectValue,i=a.custTag,n=a.comId,l=Object(r["a"])(a,["custTag","comId"]),o={model:Ae({},l,{custTag:i,customerId:"2"===i&&n?[n]:[]}),page:this.page,size:this.size};b(o).then(function(e){t.loading=!1;var a=e.data||{};t.tableData=a.result||[],t.total=a.total}).catch(function(e){return t.loading=!1,e})}},{key:"handleSizeChange",value:function(e){this.size=Number(e),this.getTableData()}},{key:"handleCurrentChange",value:function(e){this.page=Number(e),this.getTableData()}},{key:"created",value:function(){var e=this.custType,t=this.custSubtype;this.selectValue.custTag="1","2"===e&&"1"===t&&(this.selectValue.custTag="2"),this.getCustRatingList(),this.getTableData()}},{key:"custId",get:function(){var e=f["a"].info||{},t=e.custId;return t}},{key:"custType",get:function(){var e=f["a"].info||{},t=e.custType;return t}},{key:"custSubtype",get:function(){var e=f["a"].info||{},t=e.custSubtype;return t}}]),t}(m["e"]);Pe=p["a"]([Object(m["a"])({name:"",components:{TemplateCredit:V,DetentCargo:Q,Factor:te,Invoice:pe,SetIcon:ye,Edit:De,ApplyCard:ze},props:{}})],Pe);var Ie=Pe,Ee=Ie,Ne=Object(E["a"])(Ee,i,n,!1,null,"143d5994",null);t["default"]=Ne.exports},"3cc3":function(e,t,a){},"47fe":function(e,t,a){"use strict";var i=a("e3b6"),n=a.n(i);n.a},"676f":function(e,t,a){"use strict";var i=a("3cc3"),n=a.n(i);n.a},"68b7":function(e,t,a){},"8e36":function(e,t,a){"use strict";var i=a("68b7"),n=a.n(i);n.a},"91a6":function(e,t,a){"use strict";var i=a("f39b"),n=a.n(i);n.a},a2e3:function(e,t,a){"use strict";var i=a("0e47"),n=a.n(i);n.a},e3b6:function(e,t,a){},f39b:function(e,t,a){}}]);